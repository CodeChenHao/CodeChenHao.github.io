<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Johnny的空间站</title>
  
  <subtitle>探索科技,启迪人生</subtitle>
  <link href="https://chenhaonan.dpdns.org/atom.xml" rel="self"/>
  
  <link href="https://chenhaonan.dpdns.org/"/>
  <updated>2025-11-28T16:26:24.947Z</updated>
  <id>https://chenhaonan.dpdns.org/</id>
  
  <author>
    <name>Mr.Chen</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>SpringBoot整合Redis</title>
    <link href="https://chenhaonan.dpdns.org/posts/35f5/"/>
    <id>https://chenhaonan.dpdns.org/posts/35f5/</id>
    <published>2025-11-23T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.947Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、创建空项目"><a href="#一、创建空项目" class="headerlink" title="一、创建空项目"></a>一、创建空项目</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注: 该步骤,在后续整合其他技术的时候,不再单独操作。</span><br></pre></td></tr></table></figure><p><img src="/../images/SpringBoot%E6%95%B4%E5%90%88Redis/image-20251123221342640.png" alt="image-20251123221342640"></p><p><img src="/../images/SpringBoot%E6%95%B4%E5%90%88Redis/image-20251123221540745.png" alt="image-20251123221540745"></p><h2 id="二、整合Redis"><a href="#二、整合Redis" class="headerlink" title="二、整合Redis"></a>二、整合Redis</h2><h3 id="2-1、创建模块"><a href="#2-1、创建模块" class="headerlink" title="2.1、创建模块"></a>2.1、创建模块</h3><p><img src="/../images/SpringBoot%E6%95%B4%E5%90%88Redis/image-20251123221754175.png" alt="image-20251123221754175"></p><p><img src="/../images/SpringBoot%E6%95%B4%E5%90%88Redis/image-20251123222725390.png" alt="image-20251123222725390"></p><p><img src="/../images/SpringBoot%E6%95%B4%E5%90%88Redis/image-20251124001529016.png" alt="image-20251124001529016"></p><h3 id="2-2-配置Redis"><a href="#2-2-配置Redis" class="headerlink" title="2.2 配置Redis"></a>2.2 配置Redis</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">data:</span></span><br><span class="line">    <span class="attr">redis:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.10</span><span class="number">.10</span> <span class="comment"># redis服务的地址</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">6379</span> <span class="comment"># redis服务的端口</span></span><br><span class="line">      <span class="attr">database:</span> <span class="number">0</span>  <span class="comment"># 连接的数据库</span></span><br></pre></td></tr></table></figure><h3 id="2-3-测试StringRedisTemplate"><a href="#2-3-测试StringRedisTemplate" class="headerlink" title="2.3 测试StringRedisTemplate"></a>2.3 测试StringRedisTemplate</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.johnny.springbootredis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.StringRedisTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpringbootRedisApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册StringRedisTemplate</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试redis--set</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSet</span><span class="params">()</span>&#123;</span><br><span class="line">        stringRedisTemplate.opsForValue().set(<span class="string">&quot;message&quot;</span>,<span class="string">&quot;hello redis&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试redis--get</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGet</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(<span class="string">&quot;message&quot;</span>);</span><br><span class="line">        System.out.println(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试结果</p><p><img src="/../images/SpringBoot%E6%95%B4%E5%90%88Redis/image-20251124003228346.png" alt="image-20251124003228346"></p>]]></content>
    
    
    <summary type="html">SpringBoot整合Redis</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Java" scheme="https://chenhaonan.dpdns.org/tags/Java/"/>
    
    <category term="Spring" scheme="https://chenhaonan.dpdns.org/tags/Spring/"/>
    
    <category term="SpringBoot" scheme="https://chenhaonan.dpdns.org/tags/SpringBoot/"/>
    
    <category term="Redis" scheme="https://chenhaonan.dpdns.org/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>Docker2Compose</title>
    <link href="https://chenhaonan.dpdns.org/posts/1f7a/"/>
    <id>https://chenhaonan.dpdns.org/posts/1f7a/</id>
    <published>2025-11-22T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.885Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、为什么需要Docker2Compose"><a href="#一、为什么需要Docker2Compose" class="headerlink" title="一、为什么需要Docker2Compose"></a>一、为什么需要Docker2Compose</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在Docker的日常使用中,我们常常遇到这样的场景:</span><br><span class="line">通过反复调试docker run命令启动了一个包含复杂参数的容器（比如挂载了多个卷、设置了环境变量、配置了网络端口）,最终需要将其转化为可复用的docker-compose.yml文件。</span><br><span class="line">手动转换不仅耗时，还容易遗漏参数。Docker2Compose正是为解决这一痛点而生——它能将复杂的docker run命令智能转换为完整的Docker Compose配置！</span><br></pre></td></tr></table></figure><h2 id="二、安装Docker2Compose"><a href="#二、安装Docker2Compose" class="headerlink" title="二、安装Docker2Compose"></a>二、安装Docker2Compose</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /opt</span><br><span class="line">mkdir docker-docker2compose</span><br><span class="line">cd docker-docker2compose</span><br><span class="line">vim docker-compose.yml</span><br></pre></td></tr></table></figure><p>docker-compose.yml文件内容</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">d2c:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">crpi-xg6dfmt5h2etc7hg.cn-hangzhou.personal.cr.aliyuncs.com/cherry4nas/d2c:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">d2c</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5000:5000&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/run/docker.sock:/var/run/docker.sock:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-docker2compose/d2c/compose:/app/compose</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-docker2compose/d2c/logs:/app/logs</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-docker2compose/d2c/config:/app/config</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose up</span><br></pre></td></tr></table></figure><h2 id="三、访问并使用Docker2Compose"><a href="#三、访问并使用Docker2Compose" class="headerlink" title="三、访问并使用Docker2Compose"></a>三、访问并使用Docker2Compose</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ip:5000</span><br></pre></td></tr></table></figure><p><img src="/../images/Docker2Compose/image-20251123220000094.png" alt="image-20251123220000094"></p>]]></content>
    
    
    <summary type="html">一键将Docker命令转化为Compose的神器</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Docker" scheme="https://chenhaonan.dpdns.org/tags/Docker/"/>
    
    <category term="工具" scheme="https://chenhaonan.dpdns.org/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>Docker应用部署</title>
    <link href="https://chenhaonan.dpdns.org/posts/5d95/"/>
    <id>https://chenhaonan.dpdns.org/posts/5d95/</id>
    <published>2025-11-10T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.889Z</updated>
    
    <content type="html"><![CDATA[<h3 id="一、部署MySQL"><a href="#一、部署MySQL" class="headerlink" title="一、部署MySQL"></a>一、部署MySQL</h3><h4 id="1-1-通过Docker直接安装"><a href="#1-1-通过Docker直接安装" class="headerlink" title="1.1 通过Docker直接安装"></a>1.1 通过Docker直接安装</h4><h5 id="1-1-1-搜索镜像"><a href="#1-1-1-搜索镜像" class="headerlink" title="1.1.1 搜索镜像"></a>1.1.1 搜索镜像</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search mysql</span><br></pre></td></tr></table></figure><h5 id="1-1-2-拉取镜像"><a href="#1-1-2-拉取镜像" class="headerlink" title="1.1.2 拉取镜像"></a>1.1.2 拉取镜像</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:5.6</span><br></pre></td></tr></table></figure><h5 id="1-1-3-部署应用"><a href="#1-1-3-部署应用" class="headerlink" title="1.1.3 部署应用"></a>1.1.3 部署应用</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在/root目录下创建mysql目录用于存储mysql数据信息</span></span><br><span class="line"><span class="built_in">mkdir</span> ~/mysql</span><br><span class="line"><span class="built_in">cd</span> ~/mysql</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">-d \</span><br><span class="line">-p 3306:3306 \</span><br><span class="line">--name=c_mysql \</span><br><span class="line">-v /opt/docker-mysql/conf.d:/etc/mysql/conf.d \</span><br><span class="line">-v /opt/docker-mysql/logs:/logs \</span><br><span class="line">-v /opt/docker-mysql/data:/var/lib/mysql \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=root \</span><br><span class="line">mysql:5.6</span><br></pre></td></tr></table></figure><ul><li>参数说明：<ul><li><strong>-p 3306:3306</strong>：将容器的 3306 端口映射到宿主机的 3306 端口。</li><li><strong>-v &#x2F;opt&#x2F;docker-mysql&#x2F;conf.d:&#x2F;etc&#x2F;mysql&#x2F;conf.d</strong>：将宿主机的&#x2F;opt&#x2F;docker-mysql&#x2F;conf.d 目录挂载到容器的 &#x2F;etc&#x2F;mysql&#x2F;conf.d。配置目录</li><li><strong>-v &#x2F;opt&#x2F;docker-mysql&#x2F;logs:&#x2F;logs</strong>：将宿主机的&#x2F;opt&#x2F;docker-mysql&#x2F;logs目录挂载到容器的 &#x2F;logs。日志目录</li><li><strong>-v &#x2F;opt&#x2F;docker-mysql&#x2F;data:&#x2F;var&#x2F;lib&#x2F;mysql</strong> ：将宿主机的&#x2F;opt&#x2F;docker-mysql&#x2F;data目录挂载到容器的 &#x2F;var&#x2F;lib&#x2F;mysql 。数据目录</li><li>**-e MYSQL_ROOT_PASSWORD&#x3D;123456：**初始化 root 用户的密码。</li></ul></li></ul><h4 id="1-2-通过Docker-Compose安装"><a href="#1-2-通过Docker-Compose安装" class="headerlink" title="1.2 通过Docker-Compose安装"></a>1.2 通过Docker-Compose安装</h4><h5 id="1-2-1-编写docker-compose-yml"><a href="#1-2-1-编写docker-compose-yml" class="headerlink" title="1.2.1 编写docker-compose.yml"></a>1.2.1 编写docker-compose.yml</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.6</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">c_mysql</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">3306</span><span class="string">:3306</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-mysql/conf.d:/etc/mysql/conf.d</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-mysql/logs:/logs</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-mysql/data:/var/lib/mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">root</span></span><br></pre></td></tr></table></figure><h5 id="1-2-2-通过docker-compose运行"><a href="#1-2-2-通过docker-compose运行" class="headerlink" title="1.2.2 通过docker-compose运行"></a>1.2.2 通过docker-compose运行</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><h3 id="二、部署Tomcat"><a href="#二、部署Tomcat" class="headerlink" title="二、部署Tomcat"></a>二、部署Tomcat</h3><h4 id="2-1-通过Docker直接安装"><a href="#2-1-通过Docker直接安装" class="headerlink" title="2.1 通过Docker直接安装"></a>2.1 通过Docker直接安装</h4><h5 id="2-1-1-搜索镜像"><a href="#2-1-1-搜索镜像" class="headerlink" title="2.1.1 搜索镜像"></a>2.1.1 搜索镜像</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search tomcat</span><br></pre></td></tr></table></figure><h5 id="2-1-2-拉取镜像"><a href="#2-1-2-拉取镜像" class="headerlink" title="2.1.2 拉取镜像"></a>2.1.2 拉取镜像</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull tomcat</span><br></pre></td></tr></table></figure><h5 id="2-1-3-部署应用"><a href="#2-1-3-部署应用" class="headerlink" title="2.1.3 部署应用"></a>2.1.3 部署应用</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">-d \</span><br><span class="line">--name=c_tomcat \</span><br><span class="line">-p 8080:8080 \</span><br><span class="line">-v /opt/docker-tomcat/webapps:/usr/local/tomcat/webapps \</span><br><span class="line">tomcat </span><br></pre></td></tr></table></figure><ul><li>参数说明：<ul><li><p>**-p 8080:8080：**将容器的8080端口映射到主机的8080端口</p><p>**-v &#x2F;opt&#x2F;docker-tomcat&#x2F;webapps:&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps：**将宿主机的&#x2F;opt&#x2F;docker-tomcat&#x2F;webapps目录挂载到容器的&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps</p></li></ul></li></ul><h4 id="2-2-通过Docker-Compose安装"><a href="#2-2-通过Docker-Compose安装" class="headerlink" title="2.2 通过Docker-Compose安装"></a>2.2 通过Docker-Compose安装</h4><h5 id="2-2-1-编写docker-compose-yml"><a href="#2-2-1-编写docker-compose-yml" class="headerlink" title="2.2.1 编写docker-compose.yml"></a>2.2.1 编写docker-compose.yml</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">tomcat</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">c_tomcat</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:8080</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-tomcat/webapps:/usr/local/tomcat/webapps</span></span><br></pre></td></tr></table></figure><h5 id="2-2-2-通过docker-compose运行"><a href="#2-2-2-通过docker-compose运行" class="headerlink" title="2.2.2 通过docker-compose运行"></a>2.2.2 通过docker-compose运行</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><h3 id="三、部署Nginx"><a href="#三、部署Nginx" class="headerlink" title="三、部署Nginx"></a>三、部署Nginx</h3><h4 id="3-1-通过Docker直接安装"><a href="#3-1-通过Docker直接安装" class="headerlink" title="3.1 通过Docker直接安装"></a>3.1 通过Docker直接安装</h4><h5 id="3-1-1-搜索镜像"><a href="#3-1-1-搜索镜像" class="headerlink" title="3.1.1 搜索镜像"></a>3.1.1 搜索镜像</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search nginx</span><br></pre></td></tr></table></figure><h5 id="3-1-2-拉取镜像"><a href="#3-1-2-拉取镜像" class="headerlink" title="3.1.2 拉取镜像"></a>3.1.2 拉取镜像</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull nginx</span><br></pre></td></tr></table></figure><h5 id="3-1-3-部署"><a href="#3-1-3-部署" class="headerlink" title="3.1.3 部署"></a>3.1.3 部署</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">-d \</span><br><span class="line">--name=c_nginx \</span><br><span class="line">-p 80:80 \</span><br><span class="line">-v /opt/docker-nginx/conf.d:/etc/nginx/conf.d \</span><br><span class="line">-v /opt/docker-nginx/logs:/var/log/nginx \</span><br><span class="line">-v /opt/docker-nginx/html:/usr/share/nginx/html \</span><br><span class="line">nginx</span><br></pre></td></tr></table></figure><p>3.1.4 配置应用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/docker-nginx/conf.d</span><br><span class="line">vim nginx.conf</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">user  nginx;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">error_log  /var/log/nginx/error.log warn;</span><br><span class="line">pid        /var/run/nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       /etc/nginx/mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    access_log  /var/log/nginx/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    include /etc/nginx/conf.d/*.conf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-2-通过Docker-Compose安装"><a href="#3-2-通过Docker-Compose安装" class="headerlink" title="3.2 通过Docker-Compose安装"></a>3.2 通过Docker-Compose安装</h4><h5 id="3-2-1-编写docker-compose-yml"><a href="#3-2-1-编写docker-compose-yml" class="headerlink" title="3.2.1 编写docker-compose.yml"></a>3.2.1 编写docker-compose.yml</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">c_nginx</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">80</span><span class="string">:80</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-nginx/conf.d:/etc/nginx/conf.d</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-nginx/logs:/var/log/nginx</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-nginx/html:/usr/share/nginx/html</span></span><br></pre></td></tr></table></figure><h5 id="3-2-2-通过docker-compose运行"><a href="#3-2-2-通过docker-compose运行" class="headerlink" title="3.2.2 通过docker-compose运行"></a>3.2.2 通过docker-compose运行</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><h3 id="四、部署Redis"><a href="#四、部署Redis" class="headerlink" title="四、部署Redis"></a>四、部署Redis</h3><h4 id="4-1-通过Docker直接安装"><a href="#4-1-通过Docker直接安装" class="headerlink" title="4.1 通过Docker直接安装"></a>4.1 通过Docker直接安装</h4><h5 id="4-1-1-搜索镜像"><a href="#4-1-1-搜索镜像" class="headerlink" title="4.1.1 搜索镜像"></a>4.1.1 搜索镜像</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search redis</span><br></pre></td></tr></table></figure><h5 id="4-1-2-拉取镜像"><a href="#4-1-2-拉取镜像" class="headerlink" title="4.1.2 拉取镜像"></a>4.1.2 拉取镜像</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull redis:5.0</span><br></pre></td></tr></table></figure><h5 id="4-1-3-部署应用"><a href="#4-1-3-部署应用" class="headerlink" title="4.1.3 部署应用"></a>4.1.3 部署应用</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">-d \</span><br><span class="line">--name=c_redis \</span><br><span class="line">-p 6379:6379 \</span><br><span class="line">redis:5.0</span><br></pre></td></tr></table></figure><h4 id="4-2-通过Docker-Compose安装"><a href="#4-2-通过Docker-Compose安装" class="headerlink" title="4.2 通过Docker-Compose安装"></a>4.2 通过Docker-Compose安装</h4><h5 id="4-2-1-编写docker-compose-yml"><a href="#4-2-1-编写docker-compose-yml" class="headerlink" title="4.2.1 编写docker-compose.yml"></a>4.2.1 编写docker-compose.yml</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:5.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">c_redis</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6379</span><span class="string">:6379</span></span><br></pre></td></tr></table></figure><h5 id="4-2-2-通过docker-compose运行"><a href="#4-2-2-通过docker-compose运行" class="headerlink" title="4.2.2 通过docker-compose运行"></a>4.2.2 通过docker-compose运行</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><h3 id="五、部署Elastisearch与Kibana"><a href="#五、部署Elastisearch与Kibana" class="headerlink" title="五、部署Elastisearch与Kibana"></a>五、部署Elastisearch与Kibana</h3><h4 id="5-1-通过Docker-Compose安装"><a href="#5-1-通过Docker-Compose安装" class="headerlink" title="5.1 通过Docker-Compose安装"></a>5.1 通过Docker-Compose安装</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为了解决启动elasticsearch报错日志信息</span></span><br><span class="line"><span class="comment"># max virtual memory areas vm.max_map_count 【65530】 is too low, increase to at least 【262144】</span></span><br><span class="line"><span class="comment"># 修改宿主机的配置文件/etc/sysctl.conf</span></span><br><span class="line">vim /etc/sysctl.conf</span><br><span class="line"><span class="comment"># 添加下面类型</span></span><br><span class="line">vm.max_map_count=655360</span><br><span class="line"><span class="comment"># 执行下面的命令</span></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><h5 id="5-1-1-编写docker-compose-yml"><a href="#5-1-1-编写docker-compose-yml" class="headerlink" title="5.1.1 编写docker-compose.yml"></a>5.1.1 编写docker-compose.yml</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">elasticsearch:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">elasticsearch:6.5.4</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">elasticsearch</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9200</span><span class="string">:9200</span></span><br><span class="line">  <span class="attr">kibana:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">kibana:6.5.4</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">kibana</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5601</span><span class="string">:5601</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">elasticsearch_url=http://192.168.3.123:9200</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">elasticsearch</span></span><br></pre></td></tr></table></figure><h5 id="5-1-2-通过docker-compose运行"><a href="#5-1-2-通过docker-compose运行" class="headerlink" title="5.1.2 通过docker-compose运行"></a>5.1.2 通过docker-compose运行</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><h5 id="5-1-3-安装IK分词器"><a href="#5-1-3-安装IK分词器" class="headerlink" title="5.1.3 安装IK分词器"></a>5.1.3 安装IK分词器</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># IK分词器下载地址</span><br><span class="line">https://github.com/infinilabs/analysis-ik/releases/download/v6.5.4/elasticsearch-analysis-ik-6.5.4.zip</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 将下载后zip上传到宿主机,然后通过unzip 命令解压,解压后再通过docker cp命令将解压后的文件夹复制到elasticsearch容器的/usr/share/elasticsearch/plugins这个目录下,然后通过docker restart 命令重启elasticsearch容器</span><br></pre></td></tr></table></figure><p>解压</p><p><img src="/../images/Docker%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2/image-20240916193128462.png" alt="image-20240916193128462"></p><p>将解压后的文件夹复制到elasticsearch容器</p><p><img src="/../images/Docker%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2/image-20240916193216429.png" alt="image-20240916193216429"></p><p>重启elasticsearch容器</p><p><img src="/../images/Docker%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2/image-20240916193229497.png" alt="image-20240916193229497"></p><h5 id="5-1-4-测试"><a href="#5-1-4-测试" class="headerlink" title="5.1.4 测试"></a>5.1.4 测试</h5><p><img src="/../images/Docker%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2/image-20240916193408575.png" alt="image-20240916193408575"></p><h3 id="六、部署RabbitMQ"><a href="#六、部署RabbitMQ" class="headerlink" title="六、部署RabbitMQ"></a>六、部署RabbitMQ</h3><h4 id="6-1-通过Docker-Compose安装"><a href="#6-1-通过Docker-Compose安装" class="headerlink" title="6.1 通过Docker-Compose安装"></a>6.1 通过Docker-Compose安装</h4><h5 id="6-1-1-编写docker-compose-yml"><a href="#6-1-1-编写docker-compose-yml" class="headerlink" title="6.1.1 编写docker-compose.yml"></a>6.1.1 编写docker-compose.yml</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">rabbitmq:management</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">rabbitmq</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5672</span><span class="string">:5672</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">15672</span><span class="string">:15672</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker-rabbitmq/data:/var/lib/rabbitmq</span></span><br></pre></td></tr></table></figure><h5 id="6-1-2-通过docker-compose运行"><a href="#6-1-2-通过docker-compose运行" class="headerlink" title="6.1.2 通过docker-compose运行"></a>6.1.2 通过docker-compose运行</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">通过Docker安装应用程序，包括Mysql、Tomacat、Nginx、Redis、Elasticsearch、Kibana</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Docker" scheme="https://chenhaonan.dpdns.org/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker教程</title>
    <link href="https://chenhaonan.dpdns.org/posts/6139/"/>
    <id>https://chenhaonan.dpdns.org/posts/6139/</id>
    <published>2025-11-09T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.895Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、认识Docker"><a href="#一、认识Docker" class="headerlink" title="一、认识Docker"></a>一、认识Docker</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.Docker是一种容器技术，用于将我们的应用以及应用运行的环境一起打包、发布，从而解决软件跨环境迁移的问题</span><br><span class="line">2.容器是完全使用沙箱机制，容器之间相互隔离</span><br><span class="line">3.容器性能开销极低</span><br><span class="line">4.Docker分为社区版和企业版</span><br><span class="line">5.Docker官网：https://www.docker.com/</span><br><span class="line">6.Docker Hub地址： https://hub.docker.com/</span><br></pre></td></tr></table></figure><h2 id="二、Docker的安装"><a href="#二、Docker的安装" class="headerlink" title="二、Docker的安装"></a>二、Docker的安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、yum 包更新到最新</span> </span><br><span class="line">yum update</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、安装需要的软件包， yum-util 提供yum-config-manager功能，另外两个是devicemapper驱动依赖的</span> </span><br><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、 设置yum源</span></span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4、 安装docker，出现输入的界面都按 y</span> </span><br><span class="line">yum install -y docker-ce</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5、 查看docker版本，验证是否验证成功</span></span><br><span class="line">docker -v</span><br></pre></td></tr></table></figure><h2 id="三、配置Docker镜像加速器"><a href="#三、配置Docker镜像加速器" class="headerlink" title="三、配置Docker镜像加速器"></a>三、配置Docker镜像加速器</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">由于Docker的远程仓库的服务器在国外，在下载镜像的时候速度比较慢，因此安装完Docker后先配置Docker的镜像加速器。镜像加速器的地址有很多，如中科大、阿里云、网易云、腾讯云。这里采用速度较快的阿里云。</span><br><span class="line">步骤：</span><br><span class="line">1.登录阿里云</span><br><span class="line">2.点击&quot;控制台&quot;</span><br><span class="line">3.搜索&quot;容器镜像服务&quot;</span><br><span class="line">4.按&quot;镜像加速器&quot;s中的命令执行操作</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://vthkcplb.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="四、Docker的组成部分"><a href="#四、Docker的组成部分" class="headerlink" title="四、Docker的组成部分"></a>四、Docker的组成部分</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Docker = deamon + image + container + registries</span><br></pre></td></tr></table></figure><p>基本概念</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">image: 镜像，本质上就是一个文件系统，相当于&quot;软件&quot;</span><br><span class="line">registries: 仓库，分为Docker Hub以及Private registry，用于存放镜像，相当于&quot;应用商店&quot;</span><br><span class="line">container: 容器，由image产生，image相当于类，container相当于具体的实例</span><br><span class="line">deamon: Docker的守护进程,表示Docker服务</span><br></pre></td></tr></table></figure><h2 id="五、操作Docker的守护进程——deamon"><a href="#五、操作Docker的守护进程——deamon" class="headerlink" title="五、操作Docker的守护进程——deamon"></a>五、操作Docker的守护进程——deamon</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">开启Docker服务：systemctl start docker</span><br><span class="line">停止Docker服务：systemctl stop docker</span><br><span class="line">重启Docker服务：systemctl restart docker</span><br><span class="line">查看Docker服务的状态：systemctl status docker</span><br><span class="line">设置Docker开机自启：systemctl enable docker</span><br></pre></td></tr></table></figure><h2 id="六、操作镜像——image"><a href="#六、操作镜像——image" class="headerlink" title="六、操作镜像——image"></a>六、操作镜像——image</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.查看本地镜像列表：docker images</span><br><span class="line">2.查看本地镜像的id：docker images -q</span><br><span class="line">3.在docker hub仓库中搜索image: docker search 镜像名</span><br><span class="line"></span><br><span class="line">4.从docker hub仓库中下载image: docker pull 镜像:版本 </span><br><span class="line"></span><br><span class="line">5.删除本地镜像：docker rmi 镜像ID/镜像名:版本</span><br><span class="line"></span><br><span class="line">注：</span><br><span class="line">1.下载镜像时，未指定版本，则下载最新版本</span><br><span class="line">2.删除所有本地镜像：docker rmi `docker images -q`</span><br></pre></td></tr></table></figure><h2 id="七、操作容器——contrainer"><a href="#七、操作容器——contrainer" class="headerlink" title="七、操作容器——contrainer"></a>七、操作容器——contrainer</h2><h3 id="7-1查看容器"><a href="#7-1查看容器" class="headerlink" title="7.1查看容器"></a>7.1查看容器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">查看运行状态中的容器：docker ps</span><br><span class="line">查看所有容器：docker ps -a</span><br><span class="line">查看所有容器的ID：docker ps -aq</span><br></pre></td></tr></table></figure><h3 id="7-2创建并启动容器"><a href="#7-2创建并启动容器" class="headerlink" title="7.2创建并启动容器"></a>7.2创建并启动容器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run 参数</span><br><span class="line"></span><br><span class="line">参数说明：</span><br><span class="line">-i：保持容器运行。通常与 -t 同时使用。加入it这两个参数后，容器创建后自动进入容器中，退出容器后，容器自动关闭。</span><br><span class="line">-t：为容器重新分配一个伪输入终端，通常与 -i 同时使用。</span><br><span class="line">-d：以守护（后台）模式运行容器。创建一个容器在后台运行，需要使用docker exec 进入容器。退出后，容器不会关闭。</span><br><span class="line">-it 创建的容器一般称为交互式容器，-id 创建的容器一般称为守护式容器</span><br><span class="line">--name：为创建的容器命名。</span><br></pre></td></tr></table></figure><h3 id="7-3启动容器"><a href="#7-3启动容器" class="headerlink" title="7.3启动容器"></a>7.3启动容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器ID/容器名字</span><br></pre></td></tr></table></figure><h3 id="7-4停止容器"><a href="#7-4停止容器" class="headerlink" title="7.4停止容器"></a>7.4停止容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop 容器ID/容器名字</span><br></pre></td></tr></table></figure><h3 id="7-5删除容器"><a href="#7-5删除容器" class="headerlink" title="7.5删除容器"></a>7.5删除容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器ID/容器名字</span><br></pre></td></tr></table></figure><h3 id="7-6查看容器的详细信息"><a href="#7-6查看容器的详细信息" class="headerlink" title="7.6查看容器的详细信息"></a>7.6查看容器的详细信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect 容器ID/容器名字</span><br></pre></td></tr></table></figure><h2 id="八、容器的数据卷"><a href="#八、容器的数据卷" class="headerlink" title="八、容器的数据卷"></a>八、容器的数据卷</h2><h3 id="8-1数据卷的概念"><a href="#8-1数据卷的概念" class="headerlink" title="8.1数据卷的概念"></a>8.1数据卷的概念</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">思考：</span><br><span class="line">1.Docker 容器删除后，在容器中产生的数据还在吗？</span><br><span class="line">2.Docker 容器和外部机器可以直接交换文件吗？</span><br><span class="line">3.容器之间怎么进行数据交互？</span><br><span class="line"></span><br><span class="line">解答：</span><br><span class="line">1.Docker 容器删除后，在容器中产生的数据也会随之销毁；</span><br><span class="line">2.Docker 容器和外部机器不可以直接交换文件；</span><br><span class="line">3.容器之间不能直接进行数据交互，需要通过宿主机；</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">为了解决上面的问题，因此引出了数据卷的概念。</span><br><span class="line">数据卷是什么：</span><br><span class="line">1.数据卷是宿主机中的一个目录或文件</span><br><span class="line">2.当容器目录和数据卷目录绑定后，对方的修改会立即同步</span><br><span class="line">3.一个数据卷可以被多个容器同时挂载</span><br><span class="line">4.一个容器也可以被挂载多个数据卷</span><br><span class="line">数据卷的作用：</span><br><span class="line">1.可以实现容器数据持久化</span><br><span class="line">2.可以实现外部机器和容器间接通信</span><br><span class="line">3.可以实现容器之间数据交换</span><br></pre></td></tr></table></figure><h3 id="8-2配置数据卷"><a href="#8-2配置数据卷" class="headerlink" title="8.2配置数据卷"></a>8.2配置数据卷</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">创建启动容器时，使用 –v 参数 设置数据卷</span><br><span class="line">docker run ... –v 宿主机目录(文件):容器内目录(文件) ... </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">注意事项：</span><br><span class="line">        1. 目录必须是绝对路径</span><br><span class="line">        2. 如果目录不存在，会自动创建</span><br><span class="line">        3. 可以挂载多个数据卷</span><br></pre></td></tr></table></figure><h3 id="8-3数据卷容器"><a href="#8-3数据卷容器" class="headerlink" title="8.3数据卷容器"></a>8.3数据卷容器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据卷容器，与普通的容器没有什么差别，只不过该容器配置了数据卷，然后其他的容器就可以通过该容器快速的配置相同的数据卷，这个时候这个容器就被称作数据卷容器。作用：帮助其他容器快速创建数据卷，实现多个容器挂载到同一数据卷</span><br></pre></td></tr></table></figure><h3 id="8-4配置数据卷容器"><a href="#8-4配置数据卷容器" class="headerlink" title="8.4配置数据卷容器"></a>8.4配置数据卷容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.创建启动c3数据卷容器，使用 –v 参数 设置数据卷</span><br><span class="line">docker run –it --name=c3 –v /volume centos:7 /bin/bash </span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2.创建启动 c1 c2 容器，使用 –-volumes-from 参数 设置数据卷</span><br><span class="line">docker run –it --name=c1 --volumes-from c3 centos:7 /bin/bash</span><br><span class="line"></span><br><span class="line">docker run –it --name=c2 --volumes-from c3 centos:7 /bin/bash  </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Docker的相关概念、安装过程、操作命令等</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Docker" scheme="https://chenhaonan.dpdns.org/tags/Docker/"/>
    
    <category term="教程" scheme="https://chenhaonan.dpdns.org/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="虚拟化" scheme="https://chenhaonan.dpdns.org/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>Linux常用脚本</title>
    <link href="https://chenhaonan.dpdns.org/posts/20db/"/>
    <id>https://chenhaonan.dpdns.org/posts/20db/</id>
    <published>2025-10-04T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.904Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、服务器初始化脚本"><a href="#一、服务器初始化脚本" class="headerlink" title="一、服务器初始化脚本"></a>一、服务器初始化脚本</h2><h3 id="1-1-安装常用软件包"><a href="#1-1-安装常用软件包" class="headerlink" title="1.1 安装常用软件包"></a>1.1 安装常用软件包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 安装常用软件包</span></span><br><span class="line">yum update -y</span><br><span class="line">yum install -y vim wget curl git net-tools sysstat ntpdate lrzsz</span><br></pre></td></tr></table></figure><h3 id="1-2-设置时区为中国标准时间"><a href="#1-2-设置时区为中国标准时间" class="headerlink" title="1.2 设置时区为中国标准时间"></a>1.2 设置时区为中国标准时间</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 设置时区为中国标准时间</span></span><br><span class="line">timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure><h2 id="二、应用部署脚本"><a href="#二、应用部署脚本" class="headerlink" title="二、应用部署脚本"></a>二、应用部署脚本</h2><h3 id="2-1-Nginx一键安装"><a href="#2-1-Nginx一键安装" class="headerlink" title="2.1 Nginx一键安装"></a>2.1 Nginx一键安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 安装Nginx</span></span><br><span class="line">yum install -y epel-release</span><br><span class="line">yum install -y nginx</span><br><span class="line">systemctl start nginx</span><br><span class="line">systemctl <span class="built_in">enable</span> nginx</span><br></pre></td></tr></table></figure><h3 id="2-2-MySQL一键安装"><a href="#2-2-MySQL一键安装" class="headerlink" title="2.2 MySQL一键安装"></a>2.2 MySQL一键安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 安装MySQL</span></span><br><span class="line">yum install -y mysql-server</span><br><span class="line">systemctl start mysqld</span><br><span class="line">systemctl <span class="built_in">enable</span> mysqld</span><br><span class="line"><span class="comment"># 获取临时root密码</span></span><br><span class="line">grep <span class="string">&#x27;temporary password&#x27;</span> /var/log/mysqld.log</span><br></pre></td></tr></table></figure><h3 id="2-3-Redis一键安装"><a href="#2-3-Redis一键安装" class="headerlink" title="2.3 Redis一键安装"></a>2.3 Redis一键安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 安装Redis</span></span><br><span class="line">yum install -y redis</span><br><span class="line">systemctl start redis</span><br><span class="line">systemctl <span class="built_in">enable</span> redis</span><br></pre></td></tr></table></figure><h2 id="三、监控与日志配置脚本"><a href="#三、监控与日志配置脚本" class="headerlink" title="三、监控与日志配置脚本"></a>三、监控与日志配置脚本</h2><h3 id="3-1-Zabbix-Agent一键安装"><a href="#3-1-Zabbix-Agent一键安装" class="headerlink" title="3.1 Zabbix Agent一键安装"></a>3.1 Zabbix Agent一键安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 安装Zabbix Agent</span></span><br><span class="line">yum install -y zabbix-agent</span><br><span class="line">sed -i <span class="string">&quot;s/^# Server=.*/Server=zabbix-server-ip/&quot;</span> /etc/zabbix/zabbix_agentd.conf</span><br><span class="line">systemctl start zabbix-agent</span><br><span class="line">systemctl <span class="built_in">enable</span> zabbix-agent</span><br></pre></td></tr></table></figure><h3 id="3-2-Prometheus-Node-Exporter一键安装"><a href="#3-2-Prometheus-Node-Exporter一键安装" class="headerlink" title="3.2 Prometheus Node Exporter一键安装"></a>3.2 Prometheus Node Exporter一键安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 安装Prometheus Node Exporter</span></span><br><span class="line">wget https://github.com/prometheus/node_exporter/releases/download/vXX/node_exporter-XX.linux-amd64.tar.gz</span><br><span class="line">tar xvfz node_exporter-XX.linux-amd64.tar.gz</span><br><span class="line"><span class="built_in">cd</span> node_exporter-XX.linux-amd64</span><br><span class="line">./node_exporter &amp;</span><br></pre></td></tr></table></figure><h2 id="四、容器化部署脚本"><a href="#四、容器化部署脚本" class="headerlink" title="四、容器化部署脚本"></a>四、容器化部署脚本</h2><h3 id="4-1-Docker一键安装"><a href="#4-1-Docker一键安装" class="headerlink" title="4.1 Docker一键安装"></a>4.1 Docker一键安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 安装Docker</span></span><br><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">yum install -y docker-ce docker-ce-cli containerd.io</span><br><span class="line">systemctl start docker</span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br></pre></td></tr></table></figure><h3 id="4-2-Kubernetes-Helm一键安装"><a href="#4-2-Kubernetes-Helm一键安装" class="headerlink" title="4.2 Kubernetes Helm一键安装"></a>4.2 Kubernetes Helm一键安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 安装Helm</span></span><br><span class="line">curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash</span><br></pre></td></tr></table></figure><h2 id="五、备份与恢复脚本"><a href="#五、备份与恢复脚本" class="headerlink" title="五、备份与恢复脚本"></a>五、备份与恢复脚本</h2><h3 id="5-1-MySQL备份脚本"><a href="#5-1-MySQL备份脚本" class="headerlink" title="5.1 MySQL备份脚本"></a>5.1 MySQL备份脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># MySQL备份脚本</span></span><br><span class="line">BACKUP_DIR=/backup/mysql</span><br><span class="line">DATE=$(<span class="built_in">date</span> +%F-%H-%M-%S)</span><br><span class="line">mysqldump -u root -p --all-databases &gt; <span class="variable">$&#123;BACKUP_DIR&#125;</span>/all-databases-<span class="variable">$&#123;DATE&#125;</span>.sql</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">记录Linux中一些常用的脚本,如安装常用软件包、设置时区为中国标准时间、Nginx一键安装、MySQL一键安装、Redis一键安装等</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Linux" scheme="https://chenhaonan.dpdns.org/tags/Linux/"/>
    
    <category term="操作系统" scheme="https://chenhaonan.dpdns.org/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7文件管理</title>
    <link href="https://chenhaonan.dpdns.org/posts/f21b/"/>
    <id>https://chenhaonan.dpdns.org/posts/f21b/</id>
    <published>2025-04-19T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.867Z</updated>
    
    <content type="html"><![CDATA[<p>为什么企业喜欢选择Linux系统搭建服务器？</p><p>Linux系统的优势：多用户多任务的系统，安全性更高 ，开源免费。</p><h2 id="一、文件和目录的基本概念"><a href="#一、文件和目录的基本概念" class="headerlink" title="一、文件和目录的基本概念"></a>一、文件和目录的基本概念</h2><h3 id="1-1Linux的目录结构"><a href="#1-1Linux的目录结构" class="headerlink" title="1.1Linux的目录结构"></a>1.1Linux的目录结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在 Linux 系统中，将所有的目录和文件数据组织为一个树型的目录结构，整个系统中，只存在一个根目录，所有的分区、目录、文件都在同一个根目录下面。</span><br></pre></td></tr></table></figure><p><img src="/../images/CentOS7%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/image-20231112165612213.png" alt="image-20231112165612213"></p><h3 id="1-2命令提示符"><a href="#1-2命令提示符" class="headerlink" title="1.2命令提示符"></a>1.2命令提示符</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost~]#</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root:当前登录的用户名</span><br><span class="line">localhost:本机的主机名</span><br><span class="line">~:用户当前所在目录，~代表家目录</span><br><span class="line">root用户的家目录是:/root</span><br><span class="line">普通用户的家目录是:/home</span><br><span class="line">#:当前登录的用户为管理员用户</span><br><span class="line">$:当前登录的用户为普通用户</span><br></pre></td></tr></table></figure><h3 id="1-3用户之间的切换"><a href="#1-3用户之间的切换" class="headerlink" title="1.3用户之间的切换"></a>1.3用户之间的切换</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">命令格式:</span><br><span class="line">su 用户名</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#注意:</span><br><span class="line">1.由 root用户切换到普通用户不需要输入密码</span><br><span class="line">2.由普通用户切换到其他用户就必须输入密码</span><br></pre></td></tr></table></figure><h3 id="1-4显示当前目录所在的完整路径"><a href="#1-4显示当前目录所在的完整路径" class="headerlink" title="1.4显示当前目录所在的完整路径"></a>1.4显示当前目录所在的完整路径</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pwd</span><br></pre></td></tr></table></figure><h3 id="1-5目录的切换命令"><a href="#1-5目录的切换命令" class="headerlink" title="1.5目录的切换命令"></a>1.5目录的切换命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">命令格式:</span><br><span class="line">cd  目标目录路径</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#比如：</span><br><span class="line">cd /etc     切换到/etc/目录</span><br><span class="line">cd ..       返回到上一级目录</span><br><span class="line">cd          返回到家目录</span><br><span class="line">cd ~        返回到家目录</span><br><span class="line">cd -        返回到上一次所在目录</span><br><span class="line">#注：</span><br><span class="line">根目录：/</span><br><span class="line">家目录:普通用户的家目录在/home下面，root 的家目录是：/root</span><br></pre></td></tr></table></figure><h3 id="1-6绝对路径和相对路径"><a href="#1-6绝对路径和相对路径" class="headerlink" title="1.6绝对路径和相对路径"></a>1.6绝对路径和相对路径</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">相对路径：是当前目录下的某个文件或路径</span><br><span class="line"></span><br><span class="line">绝对路径：是指目录或文件的完整路径</span><br></pre></td></tr></table></figure><h3 id="1-7命令行编辑的几个常用辅助操作"><a href="#1-7命令行编辑的几个常用辅助操作" class="headerlink" title="1.7命令行编辑的几个常用辅助操作"></a>1.7命令行编辑的几个常用辅助操作</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Tab键：自动补齐</span><br><span class="line">分号“；”：在同一行中输入多个命令，中间用；隔开</span><br><span class="line">反斜杠“\”：在一行命令后加上\，表示另起一行继续输入</span><br><span class="line">上下方向键：找出曾经执行过的历史命令</span><br><span class="line">查看历史命令：history</span><br><span class="line">快捷键 Ctrl+U：清空至行首</span><br><span class="line">快捷键 Ctrl+K：清空至行尾</span><br><span class="line">快捷键 Ctrl+L：清屏</span><br><span class="line">快捷键 Ctrl+C：终止命令的执行</span><br></pre></td></tr></table></figure><h3 id="1-8关机命令——shutdown"><a href="#1-8关机命令——shutdown" class="headerlink" title="1.8关机命令——shutdown"></a>1.8关机命令——shutdown</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#shutdown命令，用于安全地将系统关机</span><br><span class="line">shutdown 参数说明:</span><br><span class="line">[-t] 在改变到其它 runlevel之前﹐告诉 init多久以后关机。</span><br><span class="line">[-r] 重启计算器。</span><br><span class="line">[-k] 并不真正关机﹐只是送警告信号给每位登录者〔login〕。</span><br><span class="line">[-h] 关机后关闭电源〔halt〕。</span><br><span class="line">[-n] 不用 init﹐而是自己来关机。不鼓励使用这个选项﹐而且该选项所产生的后</span><br><span class="line">果往往不总是你所预期得到的。</span><br><span class="line">[-c] cancel current process 取消目前正在执行的关机程序。所以这个选项当然</span><br><span class="line">没有时间参数﹐但是可以输入一个用来解释的讯息﹐而这信息将会送到每位使用者。</span><br><span class="line">[-f] 在重启计算器〔reboot〕时忽略 fsck。</span><br><span class="line">[-F] 在重启计算器〔reboot〕时强迫 fsck。</span><br><span class="line">[-time] 设定关机〔shutdown〕前的时间。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#例子：</span><br><span class="line">／sbin／shutdown －h now－－－－－立即关机；</span><br><span class="line">／sbin／shutdown －h 20：49－－－－20：49分关机</span><br><span class="line">／sbin／shutdown －h ＋10－－－－－10分钟后关机</span><br><span class="line">／sbin／shutdown －r now －－－－－立即重启</span><br><span class="line">／sbin／shutdown －r ＋10 ‘The system will reboot&#x27;－－－－10分钟后系统，重启并给每个登录用户发通知</span><br><span class="line">／sbin／shutdown －k now ‘The system will reboot&#x27;－－－－仅给每个登录用户发通知并不真关机</span><br><span class="line">reboot －－－－重启</span><br><span class="line">init 6 －－－－重启</span><br></pre></td></tr></table></figure><h2 id="二、常用-shell-命令介绍"><a href="#二、常用-shell-命令介绍" class="headerlink" title="二、常用 shell 命令介绍"></a>二、常用 shell 命令介绍</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell 命令格式：命令名 [选项] [参数]</span><br></pre></td></tr></table></figure><h3 id="2-1文件管理命令"><a href="#2-1文件管理命令" class="headerlink" title="2.1文件管理命令"></a>2.1文件管理命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#命令ls，用于显示目录内容</span><br><span class="line">选项说明：</span><br><span class="line">-a 显示所有文件，包括隐藏文件（以.号开头的文件）。</span><br><span class="line">-l 以长格式（内容更详细）显示文件或目录的详细信息。</span><br><span class="line">-h 以 K、M、G等单位显示文件大小（默认为字节），提高可读性</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#ls显示结果以不同的颜色来区分文件类别。</span><br><span class="line">蓝色代表目录（文件夹）</span><br><span class="line">灰色代表普通文件</span><br><span class="line">绿色代表可执行文件</span><br><span class="line">红色代表压缩文件</span><br><span class="line">浅绿色代表链接文件（快捷方式）</span><br></pre></td></tr></table></figure><h3 id="2-2通配符的使用"><a href="#2-2通配符的使用" class="headerlink" title="2.2通配符的使用"></a>2.2通配符的使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">“？”可以匹配文件名中的一个任意字符。</span><br><span class="line"></span><br><span class="line">“*”可以匹配文件名中的任意多个字符。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#例子</span><br><span class="line">显示/etc目录下文件名以 ns开头，扩展名是 conf的文件的详细信息</span><br><span class="line">ls –l /etc/ns*.conf</span><br><span class="line"></span><br><span class="line">显示/etc目录下文件名以 v 开头，文件名一共是 4 个字符的文件的详细信息</span><br><span class="line">ls –l /etc/v???</span><br></pre></td></tr></table></figure><h3 id="2-3创建目录（就是新建文件夹）-要考虑权限问题"><a href="#2-3创建目录（就是新建文件夹）-要考虑权限问题" class="headerlink" title="2.3创建目录（就是新建文件夹）:要考虑权限问题"></a>2.3创建目录（就是新建文件夹）:要考虑权限问题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#命令mkdir，用于创建文件夹</span><br><span class="line">选项说明：</span><br><span class="line">-p 用于递归创建文件夹</span><br><span class="line">-m 后面接表示权限的数字，用于指定文件夹的权限</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#例子</span><br><span class="line">例 1：在目录mnt中创建名为 test的子目录</span><br><span class="line">[root@localhost /]:#mkdir /mnt/test</span><br><span class="line">例 2：在根目录中创建名为 public的子目录</span><br><span class="line">[root@localhost /]:#mkdir /public</span><br><span class="line">例 3：在当前目录中同时创建 3 个子目录</span><br><span class="line">[root@localhost /]:#mkdir mp3 mp4 mp5</span><br><span class="line">例 4：当前目录为/，此时在/mnt目录下同时创建 2个子目录 y1 y2</span><br><span class="line">[root@localhost /]:#mkdir /mnt/&#123;y1，y2&#125;</span><br><span class="line">例 5：创建连续目录</span><br><span class="line">[root@localhost /]:#mkdir - p /media/cdrom</span><br><span class="line">例 6：创建目录，同时设置权限</span><br><span class="line">[root@localhost /]:#mkdir - m 775 test</span><br></pre></td></tr></table></figure><h3 id="2-4删除目录或文件"><a href="#2-4删除目录或文件" class="headerlink" title="2.4删除目录或文件"></a>2.4删除目录或文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#命令rmdir,用于删除空目录</span><br><span class="line">选项说明：</span><br><span class="line">-p 用于递归删除空文件夹</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">例 1：删除当前目录下的空目录 mytest</span><br><span class="line">[root@localhost /]:#rmdir mytest</span><br><span class="line">例 2：删除连续目录</span><br><span class="line">[root@localhost /]:#rmdir - p /media/cdrom/aa</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#命令rm,用于删除文件或目录</span><br><span class="line">选项说明：</span><br><span class="line">-r 用于删除文件夹</span><br><span class="line">-f 表示强制删除，不出现提示信息</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">例 1：删除当前目录下文件 1.txt</span><br><span class="line">[root@localhost /]:#rm 1.txt 有提示,确认删除请输入 y</span><br><span class="line">[root@localhost /]:#rm -f 1.txt 无提示,直接删除</span><br><span class="line">例 2：删除当前目录下的 student目录</span><br><span class="line">[root@localhost /]:#rm -rf /student</span><br></pre></td></tr></table></figure><h3 id="2-5复制文件或目录"><a href="#2-5复制文件或目录" class="headerlink" title="2.5复制文件或目录"></a>2.5复制文件或目录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#命令cp,用于复制文件或目录</span><br><span class="line">选项说明：</span><br><span class="line">-R 用于复制递归复制目录，和目录下的子目录</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#例子:</span><br><span class="line">复制文件</span><br><span class="line">[root@localhost ~]# cp /bin/touch /root/test/toch1</span><br><span class="line">[root@localhost ~]# cp /etc/inittab /etc/inittab.bat 将文件进行备份</span><br><span class="line">复制目录</span><br><span class="line">[root@localhost ~]# cp –R /tmp /root/mnt</span><br></pre></td></tr></table></figure><h3 id="2-6移动（剪切–粘贴）文件或目录"><a href="#2-6移动（剪切–粘贴）文件或目录" class="headerlink" title="2.6移动（剪切–粘贴）文件或目录"></a>2.6移动（剪切–粘贴）文件或目录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#命令mv,用于移动文件或目录，或者用于为文件或目录重命名</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#例子</span><br><span class="line">[root@localhost ~]# mv /root/test/test1.txt /root/test/test2.txt    重命名</span><br><span class="line">[root@localhost ~]# mv /root/test/test2.txt /tmp/     移动</span><br></pre></td></tr></table></figure><h3 id="2-7新建文件"><a href="#2-7新建文件" class="headerlink" title="2.7新建文件"></a>2.7新建文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#命令touch,用于创建文件，并可设置文件的创建时间</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#例子</span><br><span class="line">在/目录下新建一个 1.txt 文件</span><br><span class="line">[root@localhost /]# touch /1.txt </span><br></pre></td></tr></table></figure><h2 id="三、查看文件内容"><a href="#三、查看文件内容" class="headerlink" title="三、查看文件内容"></a>三、查看文件内容</h2><h3 id="3-1cat–显示文件的内容"><a href="#3-1cat–显示文件的内容" class="headerlink" title="3.1cat–显示文件的内容"></a>3.1cat–显示文件的内容</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat –n 显示行号</span><br><span class="line">cat在显示文本文件的内容时不进行停顿，因此不适合查看长文件。</span><br></pre></td></tr></table></figure><h3 id="3-2more-less–分页显示文件内容"><a href="#3-2more-less–分页显示文件内容" class="headerlink" title="3.2more&#x2F;less–分页显示文件内容"></a>3.2more&#x2F;less–分页显示文件内容</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">采用全屏的方式分页显示文件内容，当内容满屏时便会暂停，按空格键</span><br><span class="line">继续显示下一画面，或按 q 键跳离，适于阅读长文件。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#more与less的区别：</span><br><span class="line">当文件内容显示到文件尾时，more命令会自动退出阅读环境，而 less</span><br><span class="line">命令不自动退出，需在提示符“：”后按 q键退出。</span><br><span class="line">PgUp/PgDn:用于less命令翻页</span><br></pre></td></tr></table></figure><h3 id="3-3head-和-tail–查看文件开头或末尾的部分内容"><a href="#3-3head-和-tail–查看文件开头或末尾的部分内容" class="headerlink" title="3.3head 和 tail–查看文件开头或末尾的部分内容"></a>3.3head 和 tail–查看文件开头或末尾的部分内容</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">默认情况下，head显示前 10行内容，tail显示后 10行内容。</span><br><span class="line">举例：查看/etc/inittab文件的前 3 行内容</span><br><span class="line">查看/etc/inittab文件的后 5行内容</span><br></pre></td></tr></table></figure><h3 id="3-4wc-命令——文件内容统计"><a href="#3-4wc-命令——文件内容统计" class="headerlink" title="3.4wc 命令——文件内容统计"></a>3.4wc 命令——文件内容统计</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#命令wc，用于统计指定文件中的行数、单词数、字节数。</span><br><span class="line">语法：wc(选项)(参数)</span><br><span class="line">常用选项：</span><br><span class="line">-l 统计行数</span><br><span class="line">-w 统计单词数</span><br><span class="line">-c 统计字节数</span><br></pre></td></tr></table></figure><h2 id="四、查找命令"><a href="#四、查找命令" class="headerlink" title="四、查找命令"></a>四、查找命令</h2><h3 id="4-1find-命令-搜索文件与目录"><a href="#4-1find-命令-搜索文件与目录" class="headerlink" title="4.1find 命令:搜索文件与目录"></a>4.1find 命令:搜索文件与目录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">作用：是在某个指定的路径下找我们需要的文件或目录，目标是文件或目录。</span><br><span class="line">类似于在 Windows系统中执行的“搜索”操作。</span><br><span class="line"></span><br><span class="line">语法：find [查找范围] [查找条件表达式]</span><br><span class="line"></span><br><span class="line">常用选项：</span><br><span class="line">-name 按名称查找，允许使用通配符。</span><br><span class="line">-type 按文件类型查找文件类型包括：普通文件（f）、目录（d）、块设备</span><br><span class="line">文件（b）、字符设备文件（c）</span><br><span class="line">-user 按文件所有者查找，根据文件是否属于某个目标用户进行查找。</span><br><span class="line">-size 按文件大小查找，使用“+”、“-”号设置超过或小于指定的大小</span><br><span class="line">作为查找条件。常用的容量单位包括 k（注意是小写）、M、G</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#例子</span><br><span class="line">find /etc -size +1024k -name &quot;init*&quot;</span><br><span class="line">find /etc -name 1.txt</span><br></pre></td></tr></table></figure><h3 id="4-2grep-命令-查找文件内容"><a href="#4-2grep-命令-查找文件内容" class="headerlink" title="4.2grep 命令:查找文件内容"></a>4.2grep 命令:查找文件内容</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">作用：是在某个文件中找我们所需要的某部分内容，目标是字符串。则类似于在</span><br><span class="line">WORD中执行的“查找”操作。</span><br><span class="line"></span><br><span class="line">语法：grep [选项] 查找条件 目标文件</span><br><span class="line"></span><br><span class="line">常用选项：</span><br><span class="line">-c ：计算找到 &#x27;搜寻字符串&#x27; 的次数</span><br><span class="line">-i ：忽略大小写的不同，所以大小写视为相同</span><br><span class="line">-n ：顺便输出行号</span><br><span class="line">-v ：反向选择，亦即显示出没有 &#x27;搜寻字符串&#x27; 内容的那一行！</span><br><span class="line">--color=auto ：可以将找到的关键词部分加上颜色的显示！</span><br><span class="line"></span><br><span class="line">注意：grep 不支持通配符，而是使用正则表达式：</span><br><span class="line">^ 表示以什么字符开头</span><br><span class="line">$ 表示以什么字符结尾</span><br><span class="line">如：“^word”表示以“word”开头</span><br><span class="line">“word$”表示以“word”结尾</span><br><span class="line">“^$”表示空行</span><br></pre></td></tr></table></figure><h2 id="五、其他辅助命令"><a href="#五、其他辅助命令" class="headerlink" title="五、其他辅助命令"></a>五、其他辅助命令</h2><h3 id="5-1查看历史命令：history"><a href="#5-1查看历史命令：history" class="headerlink" title="5.1查看历史命令：history"></a>5.1查看历史命令：history</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">作用：linux 的 history命令的作用是，记录执行过的命令。</span><br><span class="line">用法：history [n] n为数字，列出最近的 n条命令</span><br><span class="line"></span><br><span class="line">使用! 执行历史命令。</span><br><span class="line">! number 执行第几条命令</span><br><span class="line">! command 从最近的命令查到以 command开头的命令执行</span><br><span class="line">!! 执行上一条</span><br></pre></td></tr></table></figure><h3 id="5-2help命令：只能查看内部命令的帮助信息"><a href="#5-2help命令：只能查看内部命令的帮助信息" class="headerlink" title="5.2help命令：只能查看内部命令的帮助信息"></a>5.2help命令：只能查看内部命令的帮助信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">举例：查看 pwd命令的帮助信息</span><br><span class="line">pwd --help</span><br><span class="line">如果使用 help命令查看外部命令的帮助信息时则会报错</span><br><span class="line"></span><br><span class="line">使用--help选项查以查看外部命令的帮助信息</span><br></pre></td></tr></table></figure><h3 id="5-3man命令：查看命令的帮助手册"><a href="#5-3man命令：查看命令的帮助手册" class="headerlink" title="5.3man命令：查看命令的帮助手册"></a>5.3man命令：查看命令的帮助手册</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用“↑ ”、“↓ ”方向键滚动文本</span><br><span class="line">使用 Page Up 和 Page Down键翻页</span><br><span class="line">按 Q 或 q 键退出阅读环境、按“/”键后查找内容</span><br></pre></td></tr></table></figure><h3 id="5-4输入输出重定向"><a href="#5-4输入输出重定向" class="headerlink" title="5.4输入输出重定向"></a>5.4输入输出重定向</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#什么是重定向：</span><br><span class="line">Linux系统中标准的输入设备为键盘，标准输出设备为屏幕，但在某些情况下，我们希望能从键盘以外的其他输入设备读取数据，或者将数据送到屏幕外的其他输出设备，这种情况称为重定向。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">输入重定向：&lt;</span><br><span class="line">输出重定向：&gt;或&gt;&gt;</span><br><span class="line">输出重定向是将命令的输出结果重定向到一个文件中，而不是显示在屏幕上。</span><br><span class="line">“&gt;”后面指定的文件如果不存在，将先建立该文件，再保存命令结果到文件中。</span><br><span class="line">“&gt;”后面指定的文件如果存在，将先清空文件的内容，再保存命令结果到文件中。</span><br><span class="line">“&gt;&gt;”可以将命令结果重定向并q追加到指定文件的末尾保存，而不覆盖文件中原有的内容。</span><br><span class="line">为区分标准输出重定向和标准错误重定向，在标准错误重定向前添加2</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">举例：将 1.txt的内容输出重定向到 a.txt</span><br><span class="line">Cat 1.txt &gt; a.txt</span><br><span class="line">将 1.txt的内容追加到 a.txt</span><br><span class="line"></span><br><span class="line">将错误信息输出到文件</span><br><span class="line">ls /etc/hhh 2&gt; erro</span><br><span class="line">cat &gt; newfile</span><br><span class="line">ls &gt; newfile</span><br><span class="line">cat &gt; newfile &lt; 1.txt</span><br></pre></td></tr></table></figure><h3 id="5-5管道符“-”"><a href="#5-5管道符“-”" class="headerlink" title="5.5管道符“|”"></a>5.5管道符“|”</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">通过管道符“|”，可以把多个简单的命令连接起来实现更加复杂的功能。</span><br><span class="line">管道符用于将“|”左边命令的执行结果作为“|”右边命令的输入。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#例子</span><br><span class="line">[root@localhost ~]# ls -lh /etc | more</span><br><span class="line">分页显示/etc目录下所有文件和子目录的详细信息。</span><br><span class="line">[root@localhost ~]# ls -lh /etc | grep net</span><br><span class="line">显示/etc目录下包含有“net”关键字的所有文件和子目录的详细信息。</span><br><span class="line">[root@localhost ~]# ls -l /etc/*.conf | wc –l</span><br><span class="line">统计/etc目录下所有以“.conf”结尾的文件的个数。</span><br><span class="line">[root@localhost~]#grep-v “^#” /etc/httpd/conf/httpd.conf| gerp –v “^$”</span><br><span class="line">查看/etc/httpd/conf/httpd.conf文件中除了以“#”开头的行和空行以外的内容。</span><br></pre></td></tr></table></figure><h3 id="5-6clear命令–清屏"><a href="#5-6clear命令–清屏" class="headerlink" title="5.6clear命令–清屏"></a>5.6clear命令–清屏</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+l</span><br></pre></td></tr></table></figure><h2 id="六、文件权限"><a href="#六、文件权限" class="headerlink" title="六、文件权限"></a>六、文件权限</h2><h3 id="6-1文件属性说明"><a href="#6-1文件属性说明" class="headerlink" title="6.1文件属性说明"></a>6.1文件属性说明</h3><p><img src="/../images/CentOS7%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/image-20231112170044580.png" alt="image-20231112170044580"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">第 1 组：文件类型，其中第一个字符代表文件的类别。</span><br><span class="line">- 普通文件 d 目录 l 符号链接</span><br><span class="line">c 字符设备 b 块设备</span><br><span class="line">文件的权限</span><br><span class="line">r：可读 w：可写 x：可执行 -：没有权限</span><br><span class="line">第 2 组：文件件的连接数</span><br><span class="line">第 3 组：文件所有者</span><br><span class="line">第 4 组：文件属组</span><br><span class="line">第 5 组：文件大小，默认单位为字节</span><br><span class="line">第 6 组：文件创建时间</span><br><span class="line">第 7 组：文件名称</span><br></pre></td></tr></table></figure><h3 id="6-2修改文件的权限：chmod"><a href="#6-2修改文件的权限：chmod" class="headerlink" title="6.2修改文件的权限：chmod"></a>6.2修改文件的权限：chmod</h3><h4 id="6-2-1字母方式修改权限"><a href="#6-2-1字母方式修改权限" class="headerlink" title="6.2.1字母方式修改权限"></a>6.2.1字母方式修改权限</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">文件所有者权限（u)</span><br><span class="line">所属组权限（g)</span><br><span class="line">其他用户权限(o)</span><br><span class="line">所有用户（a)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">举例：/mnt 的权限是 drwxr-x---</span><br><span class="line">chmod u-w /mnt 权限变为：dr-xr-x---</span><br><span class="line">chmod o+rx /mnt 权限变为：dr-xr-xr-x</span><br><span class="line">chmod g+w /mnt 权限变为：dr-xrwxr-x</span><br><span class="line">chmod a+w /mnt 权限变为：drwxrwxrwx</span><br></pre></td></tr></table></figure><h4 id="6-2-2数字方式修改权限"><a href="#6-2-2数字方式修改权限" class="headerlink" title="6.2.2数字方式修改权限"></a>6.2.2数字方式修改权限</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r=4 w=2 x=1 -=0</span><br></pre></td></tr></table></figure><h3 id="6-3修改文件的所有者与所属组：chown"><a href="#6-3修改文件的所有者与所属组：chown" class="headerlink" title="6.3修改文件的所有者与所属组：chown"></a>6.3修改文件的所有者与所属组：chown</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">举例：chown teacher:teacher /test1 同时修改所有者与所属组</span><br><span class="line">chown root /test1 修改所有者</span><br><span class="line">chown :student /test1 修改所属组</span><br></pre></td></tr></table></figure><h3 id="6-4特殊权限"><a href="#6-4特殊权限" class="headerlink" title="6.4特殊权限"></a>6.4特殊权限</h3><h4 id="6-4-1ACL"><a href="#6-4-1ACL" class="headerlink" title="6.4.1ACL"></a>6.4.1ACL</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ACL:访问控制【针对其他用户当中的部份或个别用户设置特殊权限】</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">setfacl -m u:stu1:rwx A</span><br><span class="line">创建一个 ACL规则，使 stu1 用户对 A 目录具有 rwx 权限</span><br><span class="line">getfacl A 查看 ACL规则</span><br><span class="line">setfacl -x u:stu3 A</span><br><span class="line">删除 stu3 对 A 目录的 ACL权限，只删除了一条规则</span><br><span class="line">setfacl -b A</span><br><span class="line">删除 A目录的所有 ACL规则</span><br></pre></td></tr></table></figure><h4 id="6-4-2SBIT"><a href="#6-4-2SBIT" class="headerlink" title="6.4.2SBIT"></a>6.4.2SBIT</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">粘滞位权限（强制位权限）【针对其他用户，只能删除自己的文件，不能删除其他的用户的文件】</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod o+t A</span><br></pre></td></tr></table></figure><h4 id="6-4-3SUID"><a href="#6-4-3SUID" class="headerlink" title="6.4.3SUID"></a>6.4.3SUID</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">以文件所有者的身份执行文件，只针对可执行文件。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod u+s A</span><br></pre></td></tr></table></figure><h4 id="6-4-4SGID"><a href="#6-4-4SGID" class="headerlink" title="6.4.4SGID"></a>6.4.4SGID</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">针对其他用户设置，以所属组的身份去执行。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod g+s A</span><br></pre></td></tr></table></figure><h2 id="七、链接文件"><a href="#七、链接文件" class="headerlink" title="七、链接文件"></a>七、链接文件</h2><h3 id="7-1软连接"><a href="#7-1软连接" class="headerlink" title="7.1软连接"></a>7.1软连接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">概念：软连接，是链接文件本身，可以理解为快捷方式，软链接对象指向源文件的地址，源文件再指向具体的物理地址，因此可以在不同的分区中创建软链接。当删除软连接对象时，不影响源文件的使用，当删除源文件时，链接对象失去作用。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">创建软连接：</span><br><span class="line">ln -s 源文件 链接文件</span><br><span class="line">如：ln -s /root/test.txt testlink</span><br></pre></td></tr></table></figure><h3 id="7-2硬链接"><a href="#7-2硬链接" class="headerlink" title="7.2硬链接"></a>7.2硬链接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">概念：硬链接，使用inode链接，可以理解为硬链接对象和源文件指向同一块物理地址，因此只能在同一个分区使用。删除一处文件，不影响另外一处文件的使用。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">创建硬链接：</span><br><span class="line">ln 源文件 链接文件</span><br><span class="line">如：ln /root/test.txt testlink</span><br></pre></td></tr></table></figure><h2 id="八、命令别名"><a href="#八、命令别名" class="headerlink" title="八、命令别名"></a>八、命令别名</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">为什么会有命令别名？</span><br><span class="line">因为有时一些常用的命令比较长，导致使用不方便，这个时候就可以使用命令别名，简化使用。</span><br><span class="line">如：ll命令其实就是&#x27;ls -l --color=auto&#x27;的别名，执行ll，就相当于执行ls -l --color=auto</span><br></pre></td></tr></table></figure><h3 id="8-1定义命令别名"><a href="#8-1定义命令别名" class="headerlink" title="8.1定义命令别名"></a>8.1定义命令别名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alias 别名=&#x27;命令&#x27;</span><br><span class="line">如：</span><br><span class="line">alias li=&#x27;cat /etc/passwd&#x27;</span><br></pre></td></tr></table></figure><h3 id="8-2删除命令别名"><a href="#8-2删除命令别名" class="headerlink" title="8.2删除命令别名"></a>8.2删除命令别名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">unalias 别名</span><br><span class="line">如：</span><br><span class="line">unalias li</span><br></pre></td></tr></table></figure><h3 id="8-3查看系统中存在的命令别名"><a href="#8-3查看系统中存在的命令别名" class="headerlink" title="8.3查看系统中存在的命令别名"></a>8.3查看系统中存在的命令别名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alias</span><br></pre></td></tr></table></figure><h2 id="九、sudo提权"><a href="#九、sudo提权" class="headerlink" title="九、sudo提权"></a>九、sudo提权</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo提权，指sudo根据指定的安全策略，让一个用户以其他用户的身份执行某个命令</span><br></pre></td></tr></table></figure><h3 id="9-1sudo的配置文件"><a href="#9-1sudo的配置文件" class="headerlink" title="9.1sudo的配置文件"></a>9.1sudo的配置文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/sudoers</span><br></pre></td></tr></table></figure><h3 id="9-2sudo配置"><a href="#9-2sudo配置" class="headerlink" title="9.2sudo配置"></a>9.2sudo配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">格式：</span><br><span class="line">用户  主机=(身份)  NOPASSWD:能执行的命令列表</span><br><span class="line">含义： 某个用户可以以那些身份在那些主机上通过sudo提权的方式执行某些命令，NOPASSWD表示不需要输入其他身份的密码</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Cmd Alias NETADMINCMD=/usr/bin/passwd,/usr/sbin/useradd</span><br><span class="line"></span><br><span class="line">root ALL=(ALL) ALL</span><br><span class="line">user1 ALL=(ALL) /usr/bin/passwd,/usr/sbin/useradd</span><br><span class="line">user2 ALL=(ALL) NOPASSWD:/usr/bin/passwd,/usr/sbin/useradd</span><br><span class="line">user3 ALL=(ALL) NETADMINCMD</span><br></pre></td></tr></table></figure><h3 id="9-3如何提权"><a href="#9-3如何提权" class="headerlink" title="9.3如何提权"></a>9.3如何提权</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo 命令</span><br></pre></td></tr></table></figure><h2 id="十、VI-VIM"><a href="#十、VI-VIM" class="headerlink" title="十、VI&#x2F;VIM"></a>十、VI&#x2F;VIM</h2><p><a href="https://www.runoob.com/linux/linux-vim.html">参考菜鸟教程中的教程</a></p>]]></content>
    
    
    <summary type="html">Centos7系统中文件管理相关的内容</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Linux" scheme="https://chenhaonan.dpdns.org/tags/Linux/"/>
    
    <category term="CentOS7" scheme="https://chenhaonan.dpdns.org/tags/CentOS7/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7配置静态IP</title>
    <link href="https://chenhaonan.dpdns.org/posts/30db/"/>
    <id>https://chenhaonan.dpdns.org/posts/30db/</id>
    <published>2025-04-19T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.882Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、为什么需要配置静态IP"><a href="#一、为什么需要配置静态IP" class="headerlink" title="一、为什么需要配置静态IP"></a>一、为什么需要配置静态IP</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">由于虚拟机IP经常改变，使用远程连接工具连接不成功，需要先查询最新IP，然后再使用远程连接工具进行连接，这样就有点麻烦。如果修改DHCP的最长租用时间，即使修改到最大值，到期后，还是会改变IP。所以，还是直接配置静态IP，这样就不会出现IP改变的情况。</span><br></pre></td></tr></table></figure><h2 id="二、如何配置静态IP"><a href="#二、如何配置静态IP" class="headerlink" title="二、如何配置静态IP"></a>二、如何配置静态IP</h2><h3 id="2-1-查看VMware网络配置信息"><a href="#2-1-查看VMware网络配置信息" class="headerlink" title="2.1 查看VMware网络配置信息"></a>2.1 查看VMware网络配置信息</h3><p><img src="/../images/CentOS7%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP/image-20251012211633090.png" alt="image-20251012211633090"></p><p><img src="/../images/CentOS7%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP/image-20251012211659669.png" alt="image-20251012211659669"></p><p><img src="/../images/CentOS7%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP/image-20251012211802697.png" alt="image-20251012211802697"></p><p><img src="/../images/CentOS7%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP/image-20251012211831825.png" alt="image-20251012211831825"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">从上面的截图中可以得到如下信息:</span><br><span class="line"></span><br><span class="line">IP地址范围：192.168.10.10 - 192.168.10.254</span><br><span class="line">子网掩码：255.255.255.0</span><br><span class="line">网关：192.168.10.2</span><br></pre></td></tr></table></figure><h3 id="2-2-修改配置文件"><a href="#2-2-修改配置文件" class="headerlink" title="2.2 修改配置文件"></a>2.2 修改配置文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">配置文件所在目录为/etc/sysconfig/network-scripts，一般以ifcfg-开头，如ifcfg-ens33、ifcfg-eth0等。</span><br></pre></td></tr></table></figure><p>查看配置文件内容（&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=dhcp</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens33</span><br><span class="line">UUID=f50ffcfa-6f5f-420b-a931-a02389b998ab</span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=yes</span><br></pre></td></tr></table></figure><p>修改以下参数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">BOOTPROTO=static</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=192.168.10.10</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.10.2</span><br><span class="line">DNS1=192.168.10.2</span><br><span class="line">DNS2=8.8.8.8</span><br><span class="line">DNS3=8.8.4.4</span><br></pre></td></tr></table></figure><p>查看完整内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens33</span><br><span class="line">UUID=f50ffcfa-6f5f-420b-a931-a02389b998ab</span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=192.168.10.10</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.10.2</span><br><span class="line">DNS1=192.168.10.2</span><br><span class="line">DNS2=8.8.8.8</span><br><span class="line">DNS3=8.8.4.4</span><br></pre></td></tr></table></figure><h3 id="2-3-重启网络"><a href="#2-3-重启网络" class="headerlink" title="2.3 重启网络"></a>2.3 重启网络</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure><h3 id="2-4-查看IP"><a href="#2-4-查看IP" class="headerlink" title="2.4 查看IP"></a>2.4 查看IP</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip addr</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">在VMware中安装的Centos7配置静态IP</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Linux" scheme="https://chenhaonan.dpdns.org/tags/Linux/"/>
    
    <category term="CentOS7" scheme="https://chenhaonan.dpdns.org/tags/CentOS7/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7模板机搭建</title>
    <link href="https://chenhaonan.dpdns.org/posts/422e/"/>
    <id>https://chenhaonan.dpdns.org/posts/422e/</id>
    <published>2025-04-18T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.874Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、更新Yum源"><a href="#一、更新Yum源" class="headerlink" title="一、更新Yum源"></a>一、更新Yum源</h2><h3 id="1-1-备份"><a href="#1-1-备份" class="headerlink" title="1.1 备份"></a>1.1 备份</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/yum.repos.d/</span><br><span class="line">mkdir back</span><br><span class="line">mv *.repo back/</span><br></pre></td></tr></table></figure><h3 id="1-2-下载并上传新的repo文件"><a href="#1-2-下载并上传新的repo文件" class="headerlink" title="1.2 下载并上传新的repo文件"></a>1.2 下载并上传新的repo文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">下载地址：https://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line">下载地址：https://mirrors.aliyun.com/repo/epel-7.repo</span><br></pre></td></tr></table></figure><h3 id="1-3-运行-yum-makecache-生成缓存"><a href="#1-3-运行-yum-makecache-生成缓存" class="headerlink" title="1.3 运行 yum makecache 生成缓存"></a>1.3 运行 yum makecache 生成缓存</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache</span><br></pre></td></tr></table></figure><h3 id="1-4-更新软件"><a href="#1-4-更新软件" class="headerlink" title="1.4 更新软件"></a>1.4 更新软件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum update -y</span><br></pre></td></tr></table></figure><h2 id="二、安装wget"><a href="#二、安装wget" class="headerlink" title="二、安装wget"></a>二、安装wget</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install wget -y</span><br></pre></td></tr></table></figure><h2 id="三、安装net-tools"><a href="#三、安装net-tools" class="headerlink" title="三、安装net-tools"></a>三、安装net-tools</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y net-tools</span><br></pre></td></tr></table></figure><h2 id="四、安装vim"><a href="#四、安装vim" class="headerlink" title="四、安装vim"></a>四、安装vim</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y vim</span><br></pre></td></tr></table></figure><h2 id="五、关闭防火墙"><a href="#五、关闭防火墙" class="headerlink" title="五、关闭防火墙"></a>五、关闭防火墙</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl disable firewalld</span><br></pre></td></tr></table></figure><h2 id="六、关闭SeLinux"><a href="#六、关闭SeLinux" class="headerlink" title="六、关闭SeLinux"></a>六、关闭SeLinux</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/selinux/config</span><br></pre></td></tr></table></figure><h2 id="七、安装Docker"><a href="#七、安装Docker" class="headerlink" title="七、安装Docker"></a>七、安装Docker</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、yum 包更新到最新</span> </span><br><span class="line">yum update</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、安装需要的软件包， yum-util 提供yum-config-manager功能，另外两个是devicemapper驱动依赖的</span> </span><br><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、设置yum源</span></span><br><span class="line">yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4、安装docker，出现输入的界面都按 y</span> </span><br><span class="line">yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5、查看docker版本，验证是否验证成功</span></span><br><span class="line">docker -v</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">6、设置开机自启</span></span><br><span class="line">systemctl enable docker</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">7、配置镜像</span></span><br><span class="line">mkdir -p /etc/docker</span><br><span class="line">cd /etc/docker</span><br><span class="line">vim daemon.json</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">8、更新配置</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> &quot;registry-mirrors&quot;: [</span><br><span class="line">&quot;https://docker.1ms.run&quot;,</span><br><span class="line">&quot;https://docker.xuanyuan.me&quot;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="八、备注"><a href="#八、备注" class="headerlink" title="八、备注"></a>八、备注</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">目前已按照上述流程创建了一个模板虚拟机,为了方便后续下载使用,因此已存放在阿里云盘中</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">CentOS7模板机搭建</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Linux" scheme="https://chenhaonan.dpdns.org/tags/Linux/"/>
    
    <category term="CentOS7" scheme="https://chenhaonan.dpdns.org/tags/CentOS7/"/>
    
  </entry>
  
  <entry>
    <title>Linux教程</title>
    <link href="https://chenhaonan.dpdns.org/posts/69d9/"/>
    <id>https://chenhaonan.dpdns.org/posts/69d9/</id>
    <published>2025-04-17T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.917Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、Linux简介"><a href="#一、Linux简介" class="headerlink" title="一、Linux简介"></a>一、Linux简介</h2><h3 id="1-1-Linux是什么"><a href="#1-1-Linux是什么" class="headerlink" title="1.1 Linux是什么"></a>1.1 Linux是什么</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Linux,全称GNU/Linux,由林纳斯·本纳第克特·托瓦兹 编写的操作系统内核，是一套免费使用和自由传播的类Unix操作系统。支持多用户、多任务、多线程和多CPU</span><br></pre></td></tr></table></figure><h3 id="1-2-Linux的特点"><a href="#1-2-Linux的特点" class="headerlink" title="1.2 Linux的特点"></a>1.2 Linux的特点</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.一切皆文件</span><br><span class="line">2.开源免费</span><br><span class="line">3.多用户多任务</span><br><span class="line">4.支持多平台</span><br><span class="line">5.兼容POSIX.0标准</span><br><span class="line">6.稳定</span><br></pre></td></tr></table></figure><h3 id="1-3-Linux应用场景"><a href="#1-3-Linux应用场景" class="headerlink" title="1.3 Linux应用场景"></a>1.3 Linux应用场景</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">相比windows系统,更加稳定，因此主要用于服务端</span><br></pre></td></tr></table></figure><h3 id="1-4-常见的Linux版本"><a href="#1-4-常见的Linux版本" class="headerlink" title="1.4  常见的Linux版本"></a>1.4  常见的Linux版本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Redhat</span><br><span class="line">CentOS</span><br><span class="line">Fedara</span><br><span class="line">Ubuntu</span><br><span class="line">Debian</span><br><span class="line">SUSE</span><br><span class="line">Kali</span><br></pre></td></tr></table></figure><h2 id="二、常用命令"><a href="#二、常用命令" class="headerlink" title="二、常用命令"></a>二、常用命令</h2><h3 id="2-1-帮助类命令"><a href="#2-1-帮助类命令" class="headerlink" title="2.1 帮助类命令"></a>2.1 帮助类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man [命令]</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help [命令] </span><br></pre></td></tr></table></figure><h3 id="2-2-关机重启类命令"><a href="#2-2-关机重启类命令" class="headerlink" title="2.2 关机重启类命令"></a>2.2 关机重启类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">将内存中的数据同步到硬盘</span><br><span class="line">sync</span><br><span class="line">关机</span><br><span class="line">poweroff</span><br><span class="line">shutdown -h now</span><br><span class="line">init 0</span><br><span class="line">重启</span><br><span class="line">reboot</span><br><span class="line">shutdown -r now</span><br><span class="line">init 6</span><br></pre></td></tr></table></figure><h3 id="2-3-文件目录类命令"><a href="#2-3-文件目录类命令" class="headerlink" title="2.3 文件目录类命令"></a>2.3 文件目录类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">查看当前所在目录</span><br><span class="line">    pwd</span><br><span class="line">查看目录内容</span><br><span class="line">    ls</span><br><span class="line">切换目录</span><br><span class="line">    cd</span><br><span class="line">创建目录</span><br><span class="line">    mkdir</span><br><span class="line">删除空目录</span><br><span class="line">    rmdir</span><br><span class="line">创建文件</span><br><span class="line">touch</span><br><span class="line">复制</span><br><span class="line">cp</span><br><span class="line">移动/重命名</span><br><span class="line">mv</span><br><span class="line">删除文件/目录</span><br><span class="line">rm</span><br><span class="line">查看文件内容</span><br><span class="line">cat  </span><br><span class="line">more</span><br><span class="line">less</span><br><span class="line">head</span><br><span class="line">tail</span><br><span class="line">打印信息</span><br><span class="line">echo</span><br><span class="line">覆盖</span><br><span class="line">&gt;</span><br><span class="line">追加</span><br><span class="line">&gt;&gt;</span><br><span class="line">创建超链接</span><br><span class="line">ln</span><br><span class="line">历史命令</span><br><span class="line">history</span><br></pre></td></tr></table></figure><h3 id="2-4-服务管理类命令"><a href="#2-4-服务管理类命令" class="headerlink" title="2.4 服务管理类命令"></a>2.4 服务管理类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">CentOS6</span><br><span class="line">开启服务</span><br><span class="line">service 服务名 start</span><br><span class="line">    停止服务</span><br><span class="line">service 服务名 stop</span><br><span class="line">重启服务</span><br><span class="line">service 服务名 restart</span><br><span class="line">查看服务状态</span><br><span class="line">service 服务名 status</span><br><span class="line">开启开机自启</span><br><span class="line">chkconfig 服务名 on</span><br><span class="line">关闭开机自启</span><br><span class="line">chkconfig 服务名 off</span><br><span class="line">查看服务开机自启状态</span><br><span class="line">chkconfig 服务名 --list</span><br><span class="line">查看所有服务自启配置</span><br><span class="line">chkconfig</span><br><span class="line">CentOS7</span><br><span class="line">开启服务</span><br><span class="line">systemctl start 服务名</span><br><span class="line">    停止服务</span><br><span class="line">systemctl stop 服务名</span><br><span class="line">重启服务</span><br><span class="line">systemctl restart 服务名</span><br><span class="line">查看服务状态</span><br><span class="line">systemctl status 服务名</span><br><span class="line">开启开机自启</span><br><span class="line">systemctl enable 服务名</span><br><span class="line">关闭开机自启</span><br><span class="line">systemctl disable 服务名</span><br><span class="line">    查看服务开机自启状态</span><br><span class="line">systemctl is-enabled 服务名</span><br><span class="line">查看所有服务自启配置</span><br><span class="line">systemctl list-unit-files</span><br><span class="line">查看正在运行的服务</span><br><span class="line">systemctl --type service</span><br></pre></td></tr></table></figure><h3 id="2-5-时间日期类命令"><a href="#2-5-时间日期类命令" class="headerlink" title="2.5 时间日期类命令"></a>2.5 时间日期类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">date</span><br><span class="line">date +%Y</span><br><span class="line">date +%m</span><br><span class="line">date +%d</span><br><span class="line">date +%H</span><br><span class="line">date +%M</span><br><span class="line">date +%S</span><br><span class="line"></span><br><span class="line">date &quot;+%Y-%m-%d %H:%M:%S&quot;</span><br><span class="line"></span><br><span class="line">cal</span><br></pre></td></tr></table></figure><h3 id="2-6-用户管理类命令"><a href="#2-6-用户管理类命令" class="headerlink" title="2.6 用户管理类命令"></a>2.6 用户管理类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">添加用户</span><br><span class="line">useradd 用户名 =&gt; 创建用户,默认以当前用户名作为用户组</span><br><span class="line">useradd -g 组名 用户名 =&gt; 创建用户时指定用户组</span><br><span class="line">删除用户</span><br><span class="line">userdel 用户名=&gt; 删除用户但保留用户的主目录</span><br><span class="line">userdel -r 用户名=&gt; 删除用户和用户的主目录</span><br><span class="line">设置密码</span><br><span class="line">passwd 用户名</span><br><span class="line">查看用户是否存在</span><br><span class="line">id 用户名</span><br><span class="line">切换用户</span><br><span class="line">su 用户名  =&gt; 切换用户,只能获得用户的执行权限,不能获得环境变量</span><br><span class="line">su - 用户名=&gt; 切换用户并获得该用户的环境变量以及执行权限</span><br><span class="line">查看当前登录用户信息</span><br><span class="line">whoami=&gt; 显示自身用户名称</span><br><span class="line">who am i=&gt; 显示登录用户的用户名</span><br><span class="line">使普通用户具有root权限</span><br><span class="line">sudo 命令</span><br></pre></td></tr></table></figure><h3 id="2-7-用户组管理类命令"><a href="#2-7-用户组管理类命令" class="headerlink" title="2.7  用户组管理类命令"></a>2.7  用户组管理类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">添加用户组</span><br><span class="line">groupadd 组名</span><br><span class="line">删除用户组</span><br><span class="line">groupdel 组名</span><br><span class="line">查看创建了那些用户组</span><br><span class="line">cat /etc/group</span><br><span class="line">修改用户的用户组 </span><br><span class="line">usermod -g 用户组 用户名</span><br></pre></td></tr></table></figure><h3 id="2-8-文件权限类命令"><a href="#2-8-文件权限类命令" class="headerlink" title="2.8 文件权限类命令"></a>2.8 文件权限类命令</h3><p><img src="/../images/Linux%E6%95%99%E7%A8%8B/image-20251018111956943.png" alt="image-20251018111956943"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">第 1 组：文件类型，其中第一个字符代表文件的类别。</span><br><span class="line">- 普通文件 d 目录 l 符号链接</span><br><span class="line">c 字符设备 b 块设备</span><br><span class="line">文件的权限</span><br><span class="line">r：可读 w：可写 x：可执行 -：没有权限</span><br><span class="line">第 2 组：文件件的连接数</span><br><span class="line">第 3 组：文件所有者</span><br><span class="line">第 4 组：文件属组</span><br><span class="line">第 5 组：文件大小，默认单位为字节</span><br><span class="line">第 6 组：文件创建时间</span><br><span class="line">第 7 组：文件名称</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">查看权限</span><br><span class="line">ll</span><br><span class="line">修改权限</span><br><span class="line">按字母方式修改</span><br><span class="line">chmod [&#123;ugoa&#125;&#123;+-=&#125; &#123;rwx&#125;] 文件或目录</span><br><span class="line">    按数字方式修改</span><br><span class="line">    chmod 777 文件或目录</span><br><span class="line">修改所有者</span><br><span class="line">chown 最终的用户 文件或目录  =&gt; 不递归修改所有者</span><br><span class="line">chown -R 用户 文件或目录 =&gt; 递归修改所有者</span><br><span class="line">修改所有组</span><br><span class="line">chgrp 最终的组 文件或目录</span><br></pre></td></tr></table></figure><h3 id="2-9-搜索查找类命令"><a href="#2-9-搜索查找类命令" class="headerlink" title="2.9 搜索查找类命令"></a>2.9 搜索查找类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">find [搜索范围] [选项]</span><br><span class="line">-name  按照文件名查找文件</span><br><span class="line">-user  按照所属用户名查找文件</span><br><span class="line">-size  按照文件大小查找文件</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">管道符</span><br><span class="line">|    =&gt;表示将前一个命令的处理结果输出传递给后面的命令处理</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">过滤</span><br><span class="line">grep 选项 查找内容 源文件</span><br></pre></td></tr></table></figure><h3 id="2-10-压缩解压类型命令"><a href="#2-10-压缩解压类型命令" class="headerlink" title="2.10 压缩解压类型命令"></a>2.10 压缩解压类型命令</h3><blockquote><p>gzip&#x2F;gunzip</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gzip 文件   =&gt; 压缩文件，只能将文件压缩为*.gz。只能压缩文件，不能压缩目录，且不保留原来的文件</span><br><span class="line">gunzip 文件.gz =&gt;解压缩文件</span><br></pre></td></tr></table></figure><blockquote><p>zip&#x2F;unzip</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zip [选项] xxx.zip 将要压缩的内容    =&gt; 压缩文件和目录</span><br><span class="line">unzip [选项] xxx.zip     =&gt; 解压缩,可添加-d 选择指定解压目录</span><br></pre></td></tr></table></figure><blockquote><p>tar</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zcvf xxx.tar 将要打包压缩的内容  =&gt; 压缩文件和目录</span><br><span class="line">tar -zxvf xxx.tar  =&gt; 解压缩,可添加-C 选择指定解压目录</span><br></pre></td></tr></table></figure><h3 id="2-11-磁盘分区类命令"><a href="#2-11-磁盘分区类命令" class="headerlink" title="2.11 磁盘分区类命令"></a>2.11 磁盘分区类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">查看磁盘空间使用情况</span><br><span class="line">df -h    =&gt; 以人性化的方式查看磁盘空间的使用情况</span><br><span class="line">查看磁盘分区详情</span><br><span class="line">fdisk -l  =&gt; 显示所有磁盘的分区列表</span><br><span class="line">挂载磁盘</span><br><span class="line">mount</span><br><span class="line">卸载磁盘</span><br><span class="line">unmount</span><br></pre></td></tr></table></figure><h3 id="2-12-进程线程类命令"><a href="#2-12-进程线程类命令" class="headerlink" title="2.12 进程线程类命令"></a>2.12 进程线程类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">查看当前系统进程状态</span><br><span class="line">ps -aux | grep xxx  =&gt; 查看系统中所有进程</span><br><span class="line">ps -ef | grep xxx   =&gt; 可以查看父子进程之间的关系</span><br><span class="line">终止进程</span><br><span class="line">kill -9 进程号</span><br></pre></td></tr></table></figure><h3 id="2-13-系统定时任务类命令"><a href="#2-13-系统定时任务类命令" class="headerlink" title="2.13 系统定时任务类命令"></a>2.13 系统定时任务类命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">编辑定时任务</span><br><span class="line">crontab -e</span><br><span class="line">查询定时任务</span><br><span class="line">crontab -l</span><br><span class="line">删除当前用户所有的定时任务</span><br><span class="line">crontab -f</span><br></pre></td></tr></table></figure><h2 id="三、Vim编辑器"><a href="#三、Vim编辑器" class="headerlink" title="三、Vim编辑器"></a>三、Vim编辑器</h2><h3 id="3-1-Vim一般模式"><a href="#3-1-Vim一般模式" class="headerlink" title="3.1 Vim一般模式"></a>3.1 Vim一般模式</h3><blockquote><p>删除和复制操作</p></blockquote><table><thead><tr><th>按键</th><th>效果</th></tr></thead><tbody><tr><td>dd</td><td>删除光标当前行</td></tr><tr><td>dnd</td><td>删除n行</td></tr><tr><td>u</td><td>撤销上一步</td></tr><tr><td>x&#x2F;X</td><td>删除一个字母Delete&#x2F;删除一个字母Backspace</td></tr><tr><td>yy</td><td>复制光标当前行</td></tr><tr><td>p</td><td>粘贴</td></tr><tr><td>dw</td><td>删除一个词</td></tr><tr><td>yw</td><td>复制一个词</td></tr></tbody></table><blockquote><p>光标移动</p></blockquote><table><thead><tr><th>按键</th><th>效果</th></tr></thead><tbody><tr><td>gg</td><td>移动到页头</td></tr><tr><td>G</td><td>移动到页尾</td></tr><tr><td>数字+G</td><td>移动到目标行</td></tr><tr><td>^</td><td>移动到行头</td></tr><tr><td>$</td><td>移动到行尾</td></tr><tr><td>ZZ</td><td>如果没有修改，直接退出,如果修改，保存后退出</td></tr></tbody></table><h3 id="3-2-Vim编辑模式"><a href="#3-2-Vim编辑模式" class="headerlink" title="3.2 Vim编辑模式"></a>3.2 Vim编辑模式</h3><table><thead><tr><th>按键</th><th>效果</th></tr></thead><tbody><tr><td>i</td><td>当前光标前</td></tr><tr><td>a</td><td>当前光标后</td></tr><tr><td>o</td><td>当前光标行的下一行</td></tr><tr><td>esc</td><td>退出编辑模式</td></tr></tbody></table><h3 id="3-3-Vim命令模式"><a href="#3-3-Vim命令模式" class="headerlink" title="3.3 Vim命令模式"></a>3.3 Vim命令模式</h3><table><thead><tr><th>按键</th><th>效果</th></tr></thead><tbody><tr><td>:w</td><td>保存</td></tr><tr><td>:q</td><td>退出</td></tr><tr><td>:wq</td><td>保存并退出</td></tr><tr><td>:!</td><td>强制执行</td></tr><tr><td>:%s&#x2F;old字符&#x2F;new字符</td><td>批量替换</td></tr><tr><td>&#x2F;要查找的词</td><td>n查找下一个;N查找上一个</td></tr><tr><td>:set nu</td><td>展示行号</td></tr><tr><td>:set nonu</td><td>隐藏行号</td></tr><tr><td>:noh</td><td>取消高亮</td></tr></tbody></table><h2 id="四、包管理"><a href="#四、包管理" class="headerlink" title="四、包管理"></a>四、包管理</h2><h3 id="4-1-RPM"><a href="#4-1-RPM" class="headerlink" title="4.1 RPM"></a>4.1 RPM</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">查看已安装的软件</span><br><span class="line">rpm -qa | grep 软件名</span><br><span class="line">卸载软件</span><br><span class="line">rpm -e 软件名</span><br><span class="line">rpm -e --nodeps 软件名</span><br><span class="line">安装软件</span><br><span class="line">rpm -ivh 软件包名</span><br><span class="line">查看安装位置</span><br><span class="line">rpm -ql 服务名</span><br></pre></td></tr></table></figure><h3 id="4-2-YUM"><a href="#4-2-YUM" class="headerlink" title="4.2 YUM"></a>4.2 YUM</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">查看软件的全称</span><br><span class="line">yum list | grep 软件名</span><br><span class="line">卸载软件</span><br><span class="line">yum remove 软件名</span><br><span class="line">安装软件</span><br><span class="line">yum install 软件名</span><br><span class="line">yum install -y 软件名 </span><br><span class="line">更新软件</span><br><span class="line">yum update</span><br><span class="line">清理yum缓存</span><br><span class="line">yum clean</span><br><span class="line">构建yum缓存</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">包括Linux简介、常用命令、Vim编辑器、包管理</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Linux" scheme="https://chenhaonan.dpdns.org/tags/Linux/"/>
    
    <category term="教程" scheme="https://chenhaonan.dpdns.org/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="操作系统" scheme="https://chenhaonan.dpdns.org/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>VMware下载教程</title>
    <link href="https://chenhaonan.dpdns.org/posts/9da6/"/>
    <id>https://chenhaonan.dpdns.org/posts/9da6/</id>
    <published>2025-04-17T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.938Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、下载地址"><a href="#一、下载地址" class="headerlink" title="一、下载地址"></a>一、下载地址</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">由于VMware被博通收购，因此下载VMware需要在博通的网站上进行下载。</span><br><span class="line">下载地址：https://support.broadcom.com/</span><br></pre></td></tr></table></figure><h2 id="二、下载流程"><a href="#二、下载流程" class="headerlink" title="二、下载流程"></a>二、下载流程</h2><h3 id="2-1-注册并登录博通账号"><a href="#2-1-注册并登录博通账号" class="headerlink" title="2.1 注册并登录博通账号"></a>2.1 注册并登录博通账号</h3><p>注册账号</p><p><img src="/../images/VMware%E4%B8%8B%E8%BD%BD%E6%95%99%E7%A8%8B/image-20251016220241618-1764174390843-31.png" alt="image-20251016220241618"></p><p>登录</p><p><img src="/../images/VMware%E4%B8%8B%E8%BD%BD%E6%95%99%E7%A8%8B/image-20251016220638463-1764174436293-34.png" alt="image-20251016220638463"></p><p><img src="/../images/VMware%E4%B8%8B%E8%BD%BD%E6%95%99%E7%A8%8B/image-20251016220801556-1764174462508-37.png" alt="image-20251016220801556"></p><h3 id="2-2-找到需要下载的VMware"><a href="#2-2-找到需要下载的VMware" class="headerlink" title="2.2 找到需要下载的VMware"></a>2.2 找到需要下载的VMware</h3><p><img src="/../images/VMware%E4%B8%8B%E8%BD%BD%E6%95%99%E7%A8%8B/image-20251016221058921-1764174490403-40.png" alt="image-20251016221058921"></p><p><img src="/../images/VMware%E4%B8%8B%E8%BD%BD%E6%95%99%E7%A8%8B/image-20251016221329866-1764174519883-43.png" alt="image-20251016221329866"></p><p><img src="/../images/VMware%E4%B8%8B%E8%BD%BD%E6%95%99%E7%A8%8B/image-20251016221626328-1764174540849-46.png" alt="image-20251016221626328"></p><h3 id="2-3-下载VMware"><a href="#2-3-下载VMware" class="headerlink" title="2.3 下载VMware"></a>2.3 下载VMware</h3><p><img src="/../images/VMware%E4%B8%8B%E8%BD%BD%E6%95%99%E7%A8%8B/image-20251016221715352-1764174564007-49.png" alt="image-20251016221715352"></p><p><img src="/../images/VMware%E4%B8%8B%E8%BD%BD%E6%95%99%E7%A8%8B/4a1f99c01c2480a38c1d1bb660cb159d-1764174584570-52.png" alt="4a1f99c01c2480a38c1d1bb660cb159d"></p><h2 id="三、备注"><a href="#三、备注" class="headerlink" title="三、备注"></a>三、备注</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">目前已按照上述流程下载了一个17.6.4版本的VMware,为了方便后续下载使用，因此已存放在阿里云盘中。</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">VMware下载教程</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="工具" scheme="https://chenhaonan.dpdns.org/tags/%E5%B7%A5%E5%85%B7/"/>
    
    <category term="教程" scheme="https://chenhaonan.dpdns.org/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="虚拟化" scheme="https://chenhaonan.dpdns.org/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
    <category term="Vmware" scheme="https://chenhaonan.dpdns.org/tags/Vmware/"/>
    
  </entry>
  
  <entry>
    <title>MyBatis教程</title>
    <link href="https://chenhaonan.dpdns.org/posts/7cd4/"/>
    <id>https://chenhaonan.dpdns.org/posts/7cd4/</id>
    <published>2024-10-13T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.930Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、Mybatis简介"><a href="#一、Mybatis简介" class="headerlink" title="一、Mybatis简介"></a>一、Mybatis简介</h1><h2 id="1-1-MyBatis历史"><a href="#1-1-MyBatis历史" class="headerlink" title="1.1 MyBatis历史"></a>1.1 MyBatis历史</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyBatis最初是Apache的一个开源项目iBatis, 2010年6月这个项目由Apache Software Foundation迁移到了Google Code。随着开发团队转投Google Code旗下，iBatis3.x正式更名为MyBatis。代码于2013年11月迁移到Github。</span><br><span class="line">iBatis一词来源于“internet”和“abatis”的组合，是一个基于Java的持久层框架。iBatis提供的持久层框架包括SQL Maps和Data Access Objects(DAO)</span><br></pre></td></tr></table></figure><h2 id="1-2-MyBatis特性"><a href="#1-2-MyBatis特性" class="headerlink" title="1.2 MyBatis特性"></a>1.2 MyBatis特性</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架</span><br><span class="line">2. MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集</span><br><span class="line">3. MyBatis可以使用简单的XML或注解用于配置和原始映射，将接口和Java的POJO（Plain Old Java Objects，普通的Java对象）映射成数据库中的记录</span><br><span class="line">4. MyBatis 是一个 半自动的ORM（Object Relation Mapping）框架</span><br></pre></td></tr></table></figure><h2 id="1-3-MyBatis下载"><a href="#1-3-MyBatis下载" class="headerlink" title="1.3 MyBatis下载"></a>1.3 MyBatis下载</h2><p><a href="https://github.com/mybatis/mybatis-3">MyBatis下载地址</a></p><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/MyBatis%E4%B8%8B%E8%BD%BD.png" alt="MyBatis下载"></p><h2 id="1-4-和其它持久化层技术对比"><a href="#1-4-和其它持久化层技术对比" class="headerlink" title="1.4 和其它持久化层技术对比"></a>1.4 和其它持久化层技术对比</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">JDBC  </span><br><span class="line">  1. SQL 夹杂在Java代码中耦合度高，导致硬编码内伤  </span><br><span class="line">  2. 维护不易且实际开发需求中 SQL 有变化，频繁修改的情况多见  </span><br><span class="line">  3. 代码冗长，开发效率低</span><br><span class="line">Hibernate 和 JPA</span><br><span class="line">  1. 操作简便，开发效率高  </span><br><span class="line">  2. 程序中的长难复杂 SQL 需要绕过框架  </span><br><span class="line">  3. 内部自动生产的 SQL，不容易做特殊优化  </span><br><span class="line">  4. 基于全映射的全自动框架，大量字段的 POJO 进行部分映射时比较困难。  </span><br><span class="line">  5. 反射操作太多，导致数据库性能下降</span><br><span class="line">MyBatis</span><br><span class="line">  1. 轻量级，性能出色  </span><br><span class="line">  2. SQL 和 Java 编码分开，功能边界清晰。Java代码专注业务、SQL语句专注数据  </span><br><span class="line">  3. 开发效率稍逊于HIbernate，但是完全能够接受</span><br></pre></td></tr></table></figure><h1 id="二、搭建MyBatis"><a href="#二、搭建MyBatis" class="headerlink" title="二、搭建MyBatis"></a>二、搭建MyBatis</h1><h2 id="2-1-开发环境"><a href="#2-1-开发环境" class="headerlink" title="2.1 开发环境"></a>2.1 开发环境</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IDE：idea 2019.2  </span><br><span class="line">构建工具：maven 3.5.4  </span><br><span class="line">MySQL版本：MySQL 5.7  </span><br><span class="line">MyBatis版本：MyBatis 3.5.7</span><br></pre></td></tr></table></figure><h2 id="2-2-创建maven工程"><a href="#2-2-创建maven工程" class="headerlink" title="2.2 创建maven工程"></a>2.2 创建maven工程</h2><ul><li>打包方式：jar</li><li>引入依赖</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Mybatis核心 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- junit测试 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- MySQL驱动 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-3-创建MyBatis的核心配置文件"><a href="#2-3-创建MyBatis的核心配置文件" class="headerlink" title="2.3 创建MyBatis的核心配置文件"></a>2.3 创建MyBatis的核心配置文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">习惯上命名为mybatis-config.xml，这个文件名仅仅只是建议，并非强制要求。将来整合Spring之后，这个配置文件可以省略，所以大家操作时可以直接复制、粘贴。</span><br><span class="line"></span><br><span class="line">核心配置文件主要用于配置连接数据库的环境以及MyBatis的全局配置信息</span><br><span class="line">核心配置文件存放的位置是src/main/resources目录下</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span>  </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span>  </span></span><br><span class="line"><span class="meta"><span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span>  </span></span><br><span class="line"><span class="meta"><span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </span><br><span class="line"><span class="comment">&lt;!--设置连接数据库的环境--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/MyBatis&quot;</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">environment</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span>  </span><br><span class="line"><span class="comment">&lt;!--引入映射文件--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mappers/UserMapper.xml&quot;</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-4-创建mapper接口"><a href="#2-4-创建mapper接口" class="headerlink" title="2.4 创建mapper接口"></a>2.4 创建mapper接口</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MyBatis中的mapper接口相当于以前的dao。但是区别在于，mapper仅仅是接口，我们不需要提供实现类</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mybatis.mapper;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;  </span><br><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment">* 添加用户信息  </span></span><br><span class="line"><span class="comment">*/</span>  </span><br><span class="line"><span class="type">int</span> <span class="title function_">insertUser</span><span class="params">()</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-5-创建MyBatis的映射文件"><a href="#2-5-创建MyBatis的映射文件" class="headerlink" title="2.5 创建MyBatis的映射文件"></a>2.5 创建MyBatis的映射文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">相关概念：ORM（Object Relationship Mapping）对象关系映射。  </span><br><span class="line"></span><br><span class="line">对象：Java的实体类对象  </span><br><span class="line">关系：关系型数据库  </span><br><span class="line">映射：二者之间的对应关系</span><br></pre></td></tr></table></figure><table><thead><tr><th>Java概念</th><th>数据库概念</th></tr></thead><tbody><tr><td>类</td><td>表</td></tr><tr><td>属性</td><td>字段&#x2F;列</td></tr><tr><td>对象</td><td>记录&#x2F;行</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">映射文件的命名规则</span><br><span class="line">  表所对应的实体类的类名+Mapper.xml</span><br><span class="line">  例如：表t_user，映射的实体类为User，所对应的映射文件为UserMapper.xml </span><br><span class="line">  因此一个映射文件对应一个实体类，对应一张表的操作</span><br><span class="line">  MyBatis映射文件用于编写SQL，访问以及操作表中的数据</span><br><span class="line">  MyBatis映射文件存放的位置是src/main/resources/mappers目录下</span><br><span class="line">MyBatis中可以面向接口操作数据，要保证两个一致</span><br><span class="line">  mapper接口的全类名和映射文件的命名空间（namespace）保持一致</span><br><span class="line">  mapper接口中方法的方法名和映射文件中编写SQL的标签的id属性保持一致</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span>  </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span>  </span></span><br><span class="line"><span class="meta"><span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>  </span></span><br><span class="line"><span class="meta"><span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.atguigu.mybatis.mapper.UserMapper&quot;</span>&gt;</span>  </span><br><span class="line"><span class="comment">&lt;!--int insertUser();--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span>&gt;</span>  </span><br><span class="line">insert into t_user values(null,&#x27;张三&#x27;,&#x27;123&#x27;,23,&#x27;女&#x27;)  </span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-6-通过junit测试功能"><a href="#2-6-通过junit测试功能" class="headerlink" title="2.6 通过junit测试功能"></a>2.6 通过junit测试功能</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SqlSession：代表Java程序和数据库之间的会话。(HttpSession是Java程序和浏览器之间的会话)</span><br><span class="line">SqlSessionFactory：是“生产”SqlSession的“工厂”</span><br><span class="line"></span><br><span class="line">工厂模式：如果创建某一个对象，使用的过程基本固定，那么我们就可以把创建这个对象的相关代码封装到一个“工厂类”中，以后都使用这个工厂类来“生产”我们需要的对象</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserMapperTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testInsertUser</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//读取MyBatis的核心配置文件</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//获取SqlSessionFactoryBuilder对象</span></span><br><span class="line">        <span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line">        <span class="comment">//通过核心配置文件所对应的字节输入流创建工厂类SqlSessionFactory，生产SqlSession对象</span></span><br><span class="line">        <span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(is);</span><br><span class="line">        <span class="comment">//获取sqlSession，此时通过SqlSession对象所操作的sql都必须手动提交或回滚事务</span></span><br><span class="line">        <span class="comment">//SqlSession sqlSession = sqlSessionFactory.openSession();</span></span><br><span class="line">    <span class="comment">//创建SqlSession对象，此时通过SqlSession对象所操作的sql都会自动提交  </span></span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//通过代理模式创建UserMapper接口的代理实现类对象</span></span><br><span class="line">        <span class="type">UserMapper</span> <span class="variable">userMapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        <span class="comment">//调用UserMapper接口中的方法，就可以根据UserMapper的全类名匹配元素文件，通过调用的方法名匹配映射文件中的SQL标签，并执行标签中的SQL语句</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> userMapper.insertUser();</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        <span class="comment">//sqlSession.commit();</span></span><br><span class="line">        System.out.println(<span class="string">&quot;result:&quot;</span> + result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">此时需要手动提交事务，如果要自动提交事务，则在获取sqlSession对象时，使用`SqlSession sqlSession = sqlSessionFactory.openSession(true);`，传入一个Boolean类型的参数，值为true，这样就可以自动提交</span><br></pre></td></tr></table></figure><h2 id="2-7-加入log4j日志功能"><a href="#2-7-加入log4j日志功能" class="headerlink" title="2.7 加入log4j日志功能"></a>2.7 加入log4j日志功能</h2><h3 id="2-7-1-加入依赖"><a href="#2-7-1-加入依赖" class="headerlink" title="2.7.1 加入依赖"></a>2.7.1 加入依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- log4j日志 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-7-2-加入log4j的配置文件"><a href="#2-7-2-加入log4j的配置文件" class="headerlink" title="2.7.2 加入log4j的配置文件"></a>2.7.2 加入log4j的配置文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">log4j的配置文件名为log4j.xml，存放的位置是src/main/resources目录下</span><br><span class="line">日志的级别：FATAL(致命)&gt;ERROR(错误)&gt;WARN(警告)&gt;INFO(信息)&gt;DEBUG(调试) 从左到右打印的内容越来越详细</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">log4j</span>:configuration <span class="keyword">SYSTEM</span> <span class="string">&quot;log4j.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">log4j:configuration</span> <span class="attr">xmlns:log4j</span>=<span class="string">&quot;http://jakarta.apache.org/log4j/&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.log4j.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;Encoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.log4j.PatternLayout&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;ConversionPattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%-5p %d&#123;MM-dd HH:mm:ss,SSS&#125; %m (%F:%L) \n&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;java.sql&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;debug&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.ibatis&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;info&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;debug&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">log4j:configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="三、核心配置文件详解"><a href="#三、核心配置文件详解" class="headerlink" title="三、核心配置文件详解"></a>三、核心配置文件详解</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">核心配置文件中的标签必须按照固定的顺序(有的标签可以不写，但顺序一定不能乱)：</span><br><span class="line">properties、settings、typeAliases、typeHandlers、objectFactory、objectWrapperFactory、reflectorFactory、plugins、environments、databaseIdProvider、mappers</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//MyBatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://MyBatis.org/dtd/MyBatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--引入properties文件，此时就可以$&#123;属性名&#125;的方式访问属性值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbc.properties&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--将表中字段的下划线自动转换为驼峰--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--开启延迟加载--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadingEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        typeAlias：设置某个具体的类型的别名</span></span><br><span class="line"><span class="comment">        属性：</span></span><br><span class="line"><span class="comment">        type：需要设置别名的类型的全类名</span></span><br><span class="line"><span class="comment">        alias：设置此类型的别名，且别名不区分大小写。若不设置此属性，该类型拥有默认的别名，即类名</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;typeAlias type=&quot;com.atguigu.mybatis.bean.User&quot;&gt;&lt;/typeAlias&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;typeAlias type=&quot;com.atguigu.mybatis.bean.User&quot; alias=&quot;user&quot;&gt;</span></span><br><span class="line"><span class="comment">        &lt;/typeAlias&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--以包为单位，设置改包下所有的类型都拥有默认的别名，即类名且不区分大小写--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.atguigu.mybatis.bean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    environments：设置多个连接数据库的环境</span></span><br><span class="line"><span class="comment">    属性：</span></span><br><span class="line"><span class="comment">    default：设置默认使用的环境的id</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql_test&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        environment：设置具体的连接数据库的环境信息</span></span><br><span class="line"><span class="comment">        属性：</span></span><br><span class="line"><span class="comment">        id：设置环境的唯一标识，可通过environments标签中的default设置某一个环境的id，表示默认使用的环境</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql_test&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            transactionManager：设置事务管理方式</span></span><br><span class="line"><span class="comment">            属性：</span></span><br><span class="line"><span class="comment">            type：设置事务管理方式，type=&quot;JDBC|MANAGED&quot;</span></span><br><span class="line"><span class="comment">            type=&quot;JDBC&quot;：设置当前环境的事务管理都必须手动处理</span></span><br><span class="line"><span class="comment">            type=&quot;MANAGED&quot;：设置事务被管理，例如spring中的AOP</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            dataSource：设置数据源</span></span><br><span class="line"><span class="comment">            属性：</span></span><br><span class="line"><span class="comment">            type：设置数据源的类型，type=&quot;POOLED|UNPOOLED|JNDI&quot;</span></span><br><span class="line"><span class="comment">            type=&quot;POOLED&quot;：使用数据库连接池，即会将创建的连接进行缓存，下次使用可以从缓存中直接获取，不需要重新创建</span></span><br><span class="line"><span class="comment">            type=&quot;UNPOOLED&quot;：不使用数据库连接池，即每次使用连接都需要重新创建</span></span><br><span class="line"><span class="comment">            type=&quot;JNDI&quot;：调用上下文中的数据源</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置驱动类的全类名--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置连接数据库的连接地址--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置连接数据库的用户名--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置连接数据库的密码--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--引入映射文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;mapper resource=&quot;UserMapper.xml&quot;/&gt; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        以包为单位，将包下所有的映射文件引入核心配置文件</span></span><br><span class="line"><span class="comment">        注意：</span></span><br><span class="line"><span class="comment">1. 此方式必须保证mapper接口和mapper映射文件必须在相同的包下</span></span><br><span class="line"><span class="comment">2. mapper接口要和mapper映射文件的名字一致</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.atguigu.mybatis.mapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/mapper%E6%8E%A5%E5%8F%A3%E5%92%8Cmapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6%E5%9C%A8%E5%90%8C%E4%B8%80%E5%8C%85%E4%B8%8B.png" alt="mapper接口和mapper映射文件在同一包下"></p><h1 id="四、默认的类型别名"><a href="#四、默认的类型别名" class="headerlink" title="四、默认的类型别名"></a>四、默认的类型别名</h1><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E9%BB%98%E8%AE%A4%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D1.png" alt="默认的类型别名1"><br><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E9%BB%98%E8%AE%A4%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D2.png" alt="默认的类型别名2"></p><h1 id="五、MyBatis的增删改查"><a href="#五、MyBatis的增删改查" class="headerlink" title="五、MyBatis的增删改查"></a>五、MyBatis的增删改查</h1><h2 id="5-1-添加"><a href="#5-1-添加" class="headerlink" title="5.1 添加"></a>5.1 添加</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int insertUser();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span>&gt;</span></span><br><span class="line">insert into t_user values(null,&#x27;admin&#x27;,&#x27;123456&#x27;,23,&#x27;男&#x27;,&#x27;12345@qq.com&#x27;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5-2-删除"><a href="#5-2-删除" class="headerlink" title="5.2 删除"></a>5.2 删除</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int deleteUser();--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span>&gt;</span></span><br><span class="line">     delete from t_user where id = 6</span><br><span class="line"> <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5-3-修改"><a href="#5-3-修改" class="headerlink" title="5.3 修改"></a>5.3 修改</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int updateUser();--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span>&gt;</span></span><br><span class="line">     update t_user set username = &#x27;张三&#x27; where id = 5</span><br><span class="line"> <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5-4-查询"><a href="#5-4-查询" class="headerlink" title="5.4 查询"></a>5.4 查询</h2><h3 id="5-4-1-查询一个实体类对象"><a href="#5-4-1-查询一个实体类对象" class="headerlink" title="5.4.1 查询一个实体类对象"></a>5.4.1 查询一个实体类对象</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--User getUserById();--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.atguigu.mybatis.bean.User&quot;</span>&gt;</span>  </span><br><span class="line">select * from t_user where id = 2  </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="5-4-2-查询集合"><a href="#5-4-2-查询集合" class="headerlink" title="5.4.2 查询集合"></a>5.4.2 查询集合</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;User&gt; getUserList();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.atguigu.mybatis.bean.User&quot;</span>&gt;</span></span><br><span class="line">select * from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">注意：</span><br><span class="line">1. 查询的标签select必须设置属性resultType或resultMap，用于设置实体类和数据库表的映射关系  </span><br><span class="line">   resultType：自动映射，用于属性名和表中字段名一致的情况  </span><br><span class="line">   resultMap：自定义映射，用于一对多或多对一或字段名和属性名不一致的情况  </span><br><span class="line">2. 当查询的数据为多条时，不能使用实体类作为返回值，只能使用集合，否则会抛出异常TooManyResultsException；但是若查询的数据只有一条，可以使用实体类或集合作为返回值</span><br></pre></td></tr></table></figure><h1 id="六、MyBatis获取参数值的两种方式（重点）"><a href="#六、MyBatis获取参数值的两种方式（重点）" class="headerlink" title="六、MyBatis获取参数值的两种方式（重点）"></a>六、MyBatis获取参数值的两种方式（重点）</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MyBatis获取参数值的两种方式：$&#123;&#125;和#&#123;&#125;  </span><br><span class="line"></span><br><span class="line">$&#123;&#125;的本质就是字符串拼接，#&#123;&#125;的本质就是占位符赋值  </span><br><span class="line">$&#123;&#125;使用字符串拼接的方式拼接sql，若为字符串类型或日期类型的字段进行赋值时，需要手动加单引号；但是#&#123;&#125;使用占位符赋值的方式拼接sql，此时为字符串类型或日期类型的字段进行赋值时，可以自动添加单引号</span><br></pre></td></tr></table></figure><h2 id="6-1-单个字面量类型的参数"><a href="#6-1-单个字面量类型的参数" class="headerlink" title="6.1 单个字面量类型的参数"></a>6.1 单个字面量类型的参数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">若mapper接口中的方法参数为单个的字面量类型，此时可以使用\$&#123;&#125;和#&#123;&#125;以任意的名称（最好见名识意）获取参数的值，注意$&#123;&#125;需要手动加单引号</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--User getUserByUsername(String username);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByUsername&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">select * from t_user where username = #&#123;username&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--User getUserByUsername(String username);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByUsername&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span>  </span><br><span class="line">select * from t_user where username = &#x27;$&#123;username&#125;&#x27;  </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-2-多个字面量类型的参数"><a href="#6-2-多个字面量类型的参数" class="headerlink" title="6.2 多个字面量类型的参数"></a>6.2 多个字面量类型的参数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">若mapper接口中的方法参数为多个时，此时MyBatis会自动将这些参数放在一个map集合中</span><br><span class="line">  1. 以arg0,arg1...为键，以参数为值；</span><br><span class="line">  2. 以param1,param2...为键，以参数为值；</span><br><span class="line">因此只需要通过\$&#123;&#125;和#&#123;&#125;访问map集合的键就可以获取相对应的值，注意$&#123;&#125;需要手动加单引号。</span><br><span class="line">使用arg或者param都行，要注意的是，arg是从arg0开始的，param是从param1开始的</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--User checkLogin(String username,String password);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;checkLogin&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span>  </span><br><span class="line">select * from t_user where username = #&#123;arg0&#125; and password = #&#123;arg1&#125;  </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--User checkLogin(String username,String password);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;checkLogin&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">select * from t_user where username = &#x27;$&#123;param1&#125;&#x27; and password = &#x27;$&#123;param2&#125;&#x27;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-3-map集合类型的参数"><a href="#6-3-map集合类型的参数" class="headerlink" title="6.3 map集合类型的参数"></a>6.3 map集合类型的参数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">若mapper接口中的方法需要的参数为多个时，此时可以手动创建map集合，将这些数据放在map中只需要通过\$&#123;&#125;和#&#123;&#125;访问map集合的键就可以获取相对应的值，注意$&#123;&#125;需要手动加单引号</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--User checkLoginByMap(Map&lt;String,Object&gt; map);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;checkLoginByMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">select * from t_user where username = #&#123;username&#125; and password = #&#123;password&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkLoginByMap</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">ParameterMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(ParameterMapper.class);</span><br><span class="line">Map&lt;String,Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">map.put(<span class="string">&quot;usermane&quot;</span>,<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> mapper.checkLoginByMap(map);</span><br><span class="line">System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-4-实体类类型的参数"><a href="#6-4-实体类类型的参数" class="headerlink" title="6.4 实体类类型的参数"></a>6.4 实体类类型的参数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">若mapper接口中的方法参数为实体类对象时此时可以使用\$&#123;&#125;和#&#123;&#125;，通过访问实体类对象中的属性名获取属性值，注意$&#123;&#125;需要手动加单引号</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int insertUser(User user);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span>&gt;</span></span><br><span class="line">insert into t_user values(null,#&#123;username&#125;,#&#123;password&#125;,#&#123;age&#125;,#&#123;sex&#125;,#&#123;email&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertUser</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">ParameterMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(ParameterMapper.class);</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="literal">null</span>,<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;123456&quot;</span>,<span class="number">12</span>,<span class="string">&quot;男&quot;</span>,<span class="string">&quot;123@321.com&quot;</span>);</span><br><span class="line">mapper.insertUser(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-5-使用-Param标识参数"><a href="#6-5-使用-Param标识参数" class="headerlink" title="6.5 使用@Param标识参数"></a>6.5 使用@Param标识参数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">可以通过@Param注解标识mapper接口中的方法参数，此时，会将这些参数放在map集合中 </span><br><span class="line">  1. 以@Param注解的value属性值为键，以参数为值；</span><br><span class="line">  2. 以param1,param2...为键，以参数为值；</span><br><span class="line">只需要通过\$&#123;&#125;和#&#123;&#125;访问map集合的键就可以获取相对应的值，注意$&#123;&#125;需要手动加单引号</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--User CheckLoginByParam(@Param(&quot;username&quot;) String username, @Param(&quot;password&quot;) String password);--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;CheckLoginByParam&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        select * from t_user where username = #&#123;username&#125; and password = #&#123;password&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkLoginByParam</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">ParameterMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(ParameterMapper.class);</span><br><span class="line">mapper.CheckLoginByParam(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">建议分成两种情况进行处理</span><br><span class="line"></span><br><span class="line">1. 实体类类型的参数</span><br><span class="line">2. 使用@Param标识参数</span><br></pre></td></tr></table></figure><h1 id="七、MyBatis的各种查询功能"><a href="#七、MyBatis的各种查询功能" class="headerlink" title="七、MyBatis的各种查询功能"></a>七、MyBatis的各种查询功能</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">如果查询出的数据只有一条,可以通过</span><br><span class="line">   1. 实体类对象接收</span><br><span class="line">   2. List集合接收</span><br><span class="line">   3. Map集合接收，结果&#123;password=123456, sex=男, id=1, age=23, username=admin&#125;</span><br><span class="line">如果查询出的数据有多条，一定不能用实体类对象接收，会抛异常TooManyResultsException，可以通过</span><br><span class="line">   1. 实体类类型的LIst集合接收</span><br><span class="line">   2. Map类型的LIst集合接收</span><br><span class="line">   3. 在mapper接口的方法上添加@MapKey注解</span><br></pre></td></tr></table></figure><h2 id="7-1-查询一个实体类对象"><a href="#7-1-查询一个实体类对象" class="headerlink" title="7.1 查询一个实体类对象"></a>7.1 查询一个实体类对象</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据用户id查询用户信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">User <span class="title function_">getUserById</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="type">int</span> id)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--User getUserById(@Param(&quot;id&quot;) int id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">select * from t_user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-2-查询一个List集合"><a href="#7-2-查询一个List集合" class="headerlink" title="7.2 查询一个List集合"></a>7.2 查询一个List集合</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询所有用户信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">getUserList</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;User&gt; getUserList();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">select * from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-3-查询单个数据"><a href="#7-3-查询单个数据" class="headerlink" title="7.3 查询单个数据"></a>7.3 查询单个数据</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * 查询用户的总记录数  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>  </span></span><br><span class="line"><span class="comment"> * 在MyBatis中，对于Java中常用的类型都设置了类型别名  </span></span><br><span class="line"><span class="comment"> * 例如：java.lang.Integer--&gt;int|integer  </span></span><br><span class="line"><span class="comment"> * 例如：int--&gt;_int|_integer  </span></span><br><span class="line"><span class="comment"> * 例如：Map--&gt;map,List--&gt;list  </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="type">int</span> <span class="title function_">getCount</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int getCount();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getCount&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;_integer&quot;</span>&gt;</span></span><br><span class="line">select count(id) from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-4-查询一条数据为map集合"><a href="#7-4-查询一条数据为map集合" class="headerlink" title="7.4 查询一条数据为map集合"></a>7.4 查询一条数据为map集合</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * 根据用户id查询用户信息为map集合  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>  </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line">Map&lt;String, Object&gt; <span class="title function_">getUserToMap</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="type">int</span> id)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Map&lt;String, Object&gt; getUserToMap(@Param(&quot;id&quot;) int id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserToMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">select * from t_user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--结果：&#123;password=123456, sex=男, id=1, age=23, username=admin&#125;--&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-5-查询多条数据为map集合"><a href="#7-5-查询多条数据为map集合" class="headerlink" title="7.5 查询多条数据为map集合"></a>7.5 查询多条数据为map集合</h2><h3 id="7-5-1-方法一"><a href="#7-5-1-方法一" class="headerlink" title="7.5.1 方法一"></a>7.5.1 方法一</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * 查询所有用户信息为map集合  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>  </span></span><br><span class="line"><span class="comment"> * 将表中的数据以map集合的方式查询，一条数据对应一个map；若有多条数据，就会产生多个map集合，此时可以将这些map放在一个list集合中获取  </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; <span class="title function_">getAllUserToMap</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Map&lt;String, Object&gt; getAllUserToMap();--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUserToMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span>  </span><br><span class="line">select * from t_user  </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">结果：</span></span><br><span class="line"><span class="comment">[&#123;password=123456, sex=男, id=1, age=23, username=admin&#125;,</span></span><br><span class="line"><span class="comment">&#123;password=123456, sex=男, id=2, age=23, username=张三&#125;,</span></span><br><span class="line"><span class="comment">&#123;password=123456, sex=男, id=3, age=23, username=张三&#125;]</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><h3 id="7-5-2-方法二"><a href="#7-5-2-方法二" class="headerlink" title="7.5.2 方法二"></a>7.5.2 方法二</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询所有用户信息为map集合</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> * 将表中的数据以map集合的方式查询，一条数据对应一个map；若有多条数据，就会产生多个map集合，并且最终要以一个map的方式返回数据，此时需要通过<span class="doctag">@MapKey</span>注解设置map集合的键，值是每条数据所对应的map集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@MapKey(&quot;id&quot;)</span></span><br><span class="line">Map&lt;String, Object&gt; <span class="title function_">getAllUserToMap</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Map&lt;String, Object&gt; getAllUserToMap();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUserToMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">select * from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">结果：</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">1=&#123;password=123456, sex=男, id=1, age=23, username=admin&#125;,</span></span><br><span class="line"><span class="comment">2=&#123;password=123456, sex=男, id=2, age=23, username=张三&#125;,</span></span><br><span class="line"><span class="comment">3=&#123;password=123456, sex=男, id=3, age=23, username=张三&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><h1 id="八、特殊SQL的执行"><a href="#八、特殊SQL的执行" class="headerlink" title="八、特殊SQL的执行"></a>八、特殊SQL的执行</h1><h2 id="8-1-模糊查询"><a href="#8-1-模糊查询" class="headerlink" title="8.1 模糊查询"></a>8.1 模糊查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据用户名进行模糊查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> username </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> java.util.List&lt;com.atguigu.mybatis.pojo.User&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/2/26 21:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">getUserByLike</span><span class="params">(<span class="meta">@Param(&quot;username&quot;)</span> String username)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;User&gt; getUserByLike(@Param(&quot;username&quot;) String username);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByLike&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--select * from t_user where username like &#x27;%$&#123;mohu&#125;%&#x27;--&gt;</span>  </span><br><span class="line"><span class="comment">&lt;!--select * from t_user where username like concat(&#x27;%&#x27;,#&#123;mohu&#125;,&#x27;%&#x27;)--&gt;</span>  </span><br><span class="line">select * from t_user where username like &quot;%&quot;#&#123;mohu&#125;&quot;%&quot;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">其中`select * from t_user where username like &quot;%&quot;#&#123;mohu&#125;&quot;%&quot;`是最常用的</span><br></pre></td></tr></table></figure><h2 id="8-2-批量删除"><a href="#8-2-批量删除" class="headerlink" title="8.2 批量删除"></a>8.2 批量删除</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">只能使用\$&#123;&#125;，如果使用#&#123;&#125;，则解析后的sql语句为`delete from t_user where id in (&#x27;1,2,3&#x27;)`，这样是将`1,2,3`看做是一个整体，只有id为`1,2,3`的数据会被删除。正确的语句应该是`delete from t_user where id in (1,2,3)`，或者`delete from t_user where id in (&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;)`</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id批量删除</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ids </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/2/26 22:06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">deleteMore</span><span class="params">(<span class="meta">@Param(&quot;ids&quot;)</span> String ids)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteMore&quot;</span>&gt;</span></span><br><span class="line">delete from t_user where id in ($&#123;ids&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//测试类</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteMore</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">SQLMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(SQLMapper.class);</span><br><span class="line"><span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> mapper.deleteMore(<span class="string">&quot;1,2,3,8&quot;</span>);</span><br><span class="line">System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-3-动态设置表名"><a href="#8-3-动态设置表名" class="headerlink" title="8.3 动态设置表名"></a>8.3 动态设置表名</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">只能使用$&#123;&#125;，因为表名不能加单引号</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询指定表中的数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> tableName </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> java.util.List&lt;com.atguigu.mybatis.pojo.User&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/2/27 14:41</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">getUserByTable</span><span class="params">(<span class="meta">@Param(&quot;tableName&quot;)</span> String tableName)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;User&gt; getUserByTable(@Param(&quot;tableName&quot;) String tableName);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByTable&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">select * from $&#123;tableName&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="8-4-添加功能获取自增的主键"><a href="#8-4-添加功能获取自增的主键" class="headerlink" title="8.4 添加功能获取自增的主键"></a>8.4 添加功能获取自增的主键</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">使用场景</span><br><span class="line">  t_clazz(clazz_id,clazz_name)  </span><br><span class="line">  t_student(student_id,student_name,clazz_id)</span><br><span class="line">  </span><br><span class="line">  1. 添加班级信息  </span><br><span class="line">  2. 获取新添加的班级的id  </span><br><span class="line">  3. 为班级分配学生，即将某学的班级id修改为新添加的班级的id</span><br><span class="line">  </span><br><span class="line">在mapper.xml中设置两个属性</span><br><span class="line">useGeneratedKeys：设置使用自增的主键  </span><br><span class="line">keyProperty：因为增删改有统一的返回值是受影响的行数，因此只能将获取的自增的主键放在传输的参数user对象的某个属性中</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加用户信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> user </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/2/27 15:04</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">insertUser</span><span class="params">(User user)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--void insertUser(User user);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">insert into t_user values (null,#&#123;username&#125;,#&#123;password&#125;,#&#123;age&#125;,#&#123;sex&#125;,#&#123;email&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//测试类</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertUser</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">SQLMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(SQLMapper.class);</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="literal">null</span>, <span class="string">&quot;ton&quot;</span>, <span class="string">&quot;123&quot;</span>, <span class="number">23</span>, <span class="string">&quot;男&quot;</span>, <span class="string">&quot;123@321.com&quot;</span>);</span><br><span class="line">mapper.insertUser(user);</span><br><span class="line">System.out.println(user);</span><br><span class="line"><span class="comment">//输出：user&#123;id=10, username=&#x27;ton&#x27;, password=&#x27;123&#x27;, age=23, sex=&#x27;男&#x27;, email=&#x27;123@321.com&#x27;&#125;，自增主键存放到了user的id属性中</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="九、自定义映射resultMap"><a href="#九、自定义映射resultMap" class="headerlink" title="九、自定义映射resultMap"></a>九、自定义映射resultMap</h1><h2 id="9-1-resultMap处理字段和属性的映射关系"><a href="#9-1-resultMap处理字段和属性的映射关系" class="headerlink" title="9.1 resultMap处理字段和属性的映射关系"></a>9.1 resultMap处理字段和属性的映射关系</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">resultMap：设置自定义映射  </span><br><span class="line"></span><br><span class="line">属性：  </span><br><span class="line">  id：表示自定义映射的唯一标识，不能重复</span><br><span class="line">  type：查询的数据要映射的实体类的类型  </span><br><span class="line">子标签：  </span><br><span class="line">  id：设置主键的映射关系  </span><br><span class="line">  result：设置普通字段的映射关系  </span><br><span class="line">  子标签属性：  </span><br><span class="line">    property：设置映射关系中实体类中的属性名  </span><br><span class="line">    column：设置映射关系中表中的字段名</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">若字段名和实体类中的属性名不一致，则可以通过resultMap设置自定义映射，即使字段名和属性名一致的属性也要映射，也就是全部属性都要列出来</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getAllEmp();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllEmp&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empResultMap&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">若字段名和实体类中的属性名不一致，但是字段名符合数据库的规则（使用_），实体类中的属性名符合Java的规则（使用驼峰）。此时也可通过以下两种方式处理字段名和实体类中的属性的映射关系：</span><br><span class="line">1. 可以通过为字段起别名的方式，保证和实体类中的属性名保持一致 </span><br><span class="line">2. 可以在MyBatis的核心配置文件中的`setting`标签中，设置一个全局配置信息mapUnderscoreToCamelCase，可以在查询表中数据时，自动将_类型的字段名转换为驼峰，例如：字段名user_name，设置了mapUnderscoreToCamelCase，此时字段名就会转换为userName。[核心配置文件详解](#核心配置文件详解)</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getAllEmp();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllEmp&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">    select eid,emp_name empName,age,sex,email from t_emp</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="9-2-多对一映射处理"><a href="#9-2-多对一映射处理" class="headerlink" title="9.2 多对一映射处理"></a>9.2 多对一映射处理</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Emp</span> &#123;  </span><br><span class="line"><span class="keyword">private</span> Integer eid;  </span><br><span class="line"><span class="keyword">private</span> String empName;  </span><br><span class="line"><span class="keyword">private</span> Integer age;  </span><br><span class="line"><span class="keyword">private</span> String sex;  </span><br><span class="line"><span class="keyword">private</span> String email;  </span><br><span class="line"><span class="keyword">private</span> Dept dept;</span><br><span class="line"><span class="comment">//...构造器、get、set方法等</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-2-1-级联方式处理映射关系"><a href="#9-2-1-级联方式处理映射关系" class="headerlink" title="9.2.1 级联方式处理映射关系"></a>9.2.1 级联方式处理映射关系</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empAndDeptResultMapOne&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;dept.did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;dept.deptName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Emp getEmpAndDept(@Param(&quot;eid&quot;)Integer eid);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpAndDept&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empAndDeptResultMapOne&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp left join t_dept on t_emp.eid = t_dept.did where t_emp.eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="9-2-2-使用association处理映射关系"><a href="#9-2-2-使用association处理映射关系" class="headerlink" title="9.2.2 使用association处理映射关系"></a>9.2.2 使用association处理映射关系</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">association：处理多对一的映射关系</span><br><span class="line">property：需要处理多对的映射关系的属性名</span><br><span class="line">javaType：该属性的类型</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empAndDeptResultMapTwo&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;deptName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Emp getEmpAndDept(@Param(&quot;eid&quot;)Integer eid);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpAndDept&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empAndDeptResultMapTwo&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp left join t_dept on t_emp.eid = t_dept.did where t_emp.eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="9-2-3-分步查询"><a href="#9-2-3-分步查询" class="headerlink" title="9.2.3 分步查询"></a>9.2.3 分步查询</h3><h4 id="9-2-3-1-查询员工信息"><a href="#9-2-3-1-查询员工信息" class="headerlink" title="9.2.3.1 查询员工信息"></a>9.2.3.1 查询员工信息</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select：设置分布查询的sql的唯一标识（namespace.SQLId或mapper接口的全类名.方法名）</span><br><span class="line">column：设置分步查询的条件</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过分步查询，员工及所对应的部门信息</span></span><br><span class="line"><span class="comment"> * 分步查询第一步：查询员工信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> com.atguigu.mybatis.pojo.Emp</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/2/27 20:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Emp <span class="title function_">getEmpAndDeptByStepOne</span><span class="params">(<span class="meta">@Param(&quot;eid&quot;)</span> Integer eid)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empAndDeptByStepResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">select</span>=<span class="string">&quot;com.atguigu.mybatis.mapper.DeptMapper.getEmpAndDeptByStepTwo&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Emp getEmpAndDeptByStepOne(@Param(&quot;eid&quot;) Integer eid);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpAndDeptByStepOne&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empAndDeptByStepResultMap&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp where eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="9-2-3-2-查询部门信息"><a href="#9-2-3-2-查询部门信息" class="headerlink" title="9.2.3.2 查询部门信息"></a>9.2.3.2 查询部门信息</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过分步查询，员工及所对应的部门信息</span></span><br><span class="line"><span class="comment"> * 分步查询第二步：通过did查询员工对应的部门信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> com.atguigu.mybatis.pojo.Emp</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/2/27 20:23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Dept <span class="title function_">getEmpAndDeptByStepTwo</span><span class="params">(<span class="meta">@Param(&quot;did&quot;)</span> Integer did)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--此处的resultMap仅是处理字段和属性的映射关系--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;EmpAndDeptByStepTwoResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;deptName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Dept getEmpAndDeptByStepTwo(@Param(&quot;did&quot;) Integer did);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpAndDeptByStepTwo&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;EmpAndDeptByStepTwoResultMap&quot;</span>&gt;</span></span><br><span class="line">select * from t_dept where did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="9-3-一对多映射处理"><a href="#9-3-一对多映射处理" class="headerlink" title="9.3 一对多映射处理"></a>9.3 一对多映射处理</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dept</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer did;</span><br><span class="line">    <span class="keyword">private</span> String deptName;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Emp&gt; emps;</span><br><span class="line"><span class="comment">//...构造器、get、set方法等</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-3-1-collection"><a href="#9-3-1-collection" class="headerlink" title="9.3.1 collection"></a>9.3.1 collection</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">collection：用来处理一对多的映射关系</span><br><span class="line">ofType：表示该属性对饮的集合中存储的数据的类型</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;DeptAndEmpResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;deptName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;emps&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Dept getDeptAndEmp(@Param(&quot;did&quot;) Integer did);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDeptAndEmp&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;DeptAndEmpResultMap&quot;</span>&gt;</span></span><br><span class="line">select * from t_dept left join t_emp on t_dept.did = t_emp.did where t_dept.did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="9-3-2-分步查询"><a href="#9-3-2-分步查询" class="headerlink" title="9.3.2 分步查询"></a>9.3.2 分步查询</h3><h4 id="9-3-2-1-查询部门信息"><a href="#9-3-2-1-查询部门信息" class="headerlink" title="9.3.2.1 查询部门信息"></a>9.3.2.1 查询部门信息</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过分步查询，查询部门及对应的所有员工信息</span></span><br><span class="line"><span class="comment"> * 分步查询第一步：查询部门信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> did </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> com.atguigu.mybatis.pojo.Dept</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/2/27 22:04</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Dept <span class="title function_">getDeptAndEmpByStepOne</span><span class="params">(<span class="meta">@Param(&quot;did&quot;)</span> Integer did)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;DeptAndEmpByStepOneResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;deptName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;emps&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">select</span>=<span class="string">&quot;com.atguigu.mybatis.mapper.EmpMapper.getDeptAndEmpByStepTwo&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Dept getDeptAndEmpByStepOne(@Param(&quot;did&quot;) Integer did);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDeptAndEmpByStepOne&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;DeptAndEmpByStepOneResultMap&quot;</span>&gt;</span></span><br><span class="line">select * from t_dept where did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="9-3-2-2-根据部门id查询部门中的所有员工"><a href="#9-3-2-2-根据部门id查询部门中的所有员工" class="headerlink" title="9.3.2.2 根据部门id查询部门中的所有员工"></a>9.3.2.2 根据部门id查询部门中的所有员工</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过分步查询，查询部门及对应的所有员工信息</span></span><br><span class="line"><span class="comment"> * 分步查询第二步：根据部门id查询部门中的所有员工</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> did</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> java.util.List&lt;com.atguigu.mybatis.pojo.Emp&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/2/27 22:10</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;Emp&gt; <span class="title function_">getDeptAndEmpByStepTwo</span><span class="params">(<span class="meta">@Param(&quot;did&quot;)</span> Integer did)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getDeptAndEmpByStepTwo(@Param(&quot;did&quot;) Integer did);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDeptAndEmpByStepTwo&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp where did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="9-4-延迟加载"><a href="#9-4-延迟加载" class="headerlink" title="9.4 延迟加载"></a>9.4 延迟加载</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">分步查询的优点：可以实现延迟加载，但是必须在核心配置文件中设置全局配置信息：</span><br><span class="line"> lazyLoadingEnabled：延迟加载的全局开关。当开启时，所有关联对象都会延迟加载  </span><br><span class="line">  aggressiveLazyLoading：当开启时，任何方法的调用都会加载该对象的所有属性。 否则，每个属性会按需加载  </span><br><span class="line">此时就可以实现按需加载，获取的数据是什么，就只会执行相应的sql。此时可通过association和collection中的fetchType属性设置当前的分步查询是否使用延迟加载，fetchType=&quot;lazy(延迟加载)|eager(立即加载)&quot;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--开启延迟加载--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadingEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getEmpAndDeptByStepOne</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">EmpMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(EmpMapper.class);</span><br><span class="line"><span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> mapper.getEmpAndDeptByStepOne(<span class="number">1</span>);</span><br><span class="line">System.out.println(emp.getEmpName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">关闭延迟加载，两条SQL语句都运行了</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%E6%B5%8B%E8%AF%951.png" alt="延迟加载测试1"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">开启延迟加载，只运行获取emp的SQL语句</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%E6%B5%8B%E8%AF%952.png" alt="延迟加载测试2"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getEmpAndDeptByStepOne</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">EmpMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(EmpMapper.class);</span><br><span class="line"><span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> mapper.getEmpAndDeptByStepOne(<span class="number">1</span>);</span><br><span class="line">System.out.println(emp.getEmpName());</span><br><span class="line">System.out.println(<span class="string">&quot;----------------&quot;</span>);</span><br><span class="line">System.out.println(emp.getDept());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">开启后，需要用到查询dept的时候才会调用相应的SQL语句</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%E6%B5%8B%E8%AF%953.png" alt="延迟加载测试3"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fetchType：当开启了全局的延迟加载之后，可以通过该属性手动控制延迟加载的效果，fetchType=&quot;lazy(延迟加载)|eager(立即加载)&quot;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empAndDeptByStepResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;empName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;emp_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">select</span>=<span class="string">&quot;com.atguigu.mybatis.mapper.DeptMapper.getEmpAndDeptByStepTwo&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">fetchType</span>=<span class="string">&quot;lazy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="十、动态SQL"><a href="#十、动态SQL" class="headerlink" title="十、动态SQL"></a>十、动态SQL</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mybatis框架的动态SQL技术是一种根据特定条件动态拼装SQL语句的功能，它存在的意义是为了解决拼接SQL语句字符串时的痛点问题</span><br></pre></td></tr></table></figure><h2 id="10-1-if"><a href="#10-1-if" class="headerlink" title="10.1 if"></a>10.1 if</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if标签可通过test属性（即传递过来的数据）的表达式进行判断，若表达式的结果为true，则标签中的内容会执行；反之标签中的内容不会执行</span><br><span class="line">在where后面添加一个恒成立条件`1=1`</span><br><span class="line">    这个恒成立条件并不会影响查询的结果</span><br><span class="line"> 这个`1=1`可以用来拼接`and`语句，例如：当empName为null时</span><br><span class="line">   如果不加上恒成立条件，则SQL语句为`select * from t_emp where and age = ? and sex = ? and email = ?`，此时`where`会与`and`连用，SQL语句会报错</span><br><span class="line">    如果加上一个恒成立条件，则SQL语句为`select * from t_emp where 1= 1 and age = ? and sex = ? and email = ?`，此时不报错</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByCondition&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp where 1=1</span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;empName != null and empName !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">and emp_name = #&#123;empName&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != null and age !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">and age = #&#123;age&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != null and sex !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">and sex = #&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;email != null and email !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">and email = #&#123;email&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="10-2-where"><a href="#10-2-where" class="headerlink" title="10.2 where"></a>10.2 where</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">where和if一般结合使用：</span><br><span class="line">若where标签中的if条件都不满足，则where标签没有任何功能，即不会添加where关键字  </span><br><span class="line">若where标签中的if条件满足，则where标签会自动添加where关键字，并将条件最前方多余的and/or去掉  </span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByCondition&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp</span><br><span class="line"><span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;empName != null and empName !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">emp_name = #&#123;empName&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != null and age !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">and age = #&#123;age&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != null and sex !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">and sex = #&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;email != null and email !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">and email = #&#123;email&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：where标签不能去掉条件后多余的and/or</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--这种用法是错误的，只能去掉条件前面的and/or，条件后面的不行--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;empName != null and empName !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">emp_name = #&#123;empName&#125; and</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != null and age !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">age = #&#123;age&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="10-3-trim"><a href="#10-3-trim" class="headerlink" title="10.3 trim"></a>10.3 trim</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">trim用于去掉或添加标签中的内容  </span><br><span class="line">常用属性</span><br><span class="line"> prefix：在trim标签中的内容的前面添加某些内容  </span><br><span class="line">  suffix：在trim标签中的内容的后面添加某些内容 </span><br><span class="line">prefixOverrides：在trim标签中的内容的前面去掉某些内容  </span><br><span class="line">suffixOverrides：在trim标签中的内容的后面去掉某些内容</span><br><span class="line">若trim中的标签都不满足条件，则trim标签没有任何效果，也就是只剩下`select * from t_emp`</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByCondition&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp</span><br><span class="line"><span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;where&quot;</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;and|or&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;empName != null and empName !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">emp_name = #&#123;empName&#125; and</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != null and age !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">age = #&#123;age&#125; and</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != null and sex !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">sex = #&#123;sex&#125; or</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;email != null and email !=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">email = #&#123;email&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//测试类</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getEmpByCondition</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">DynamicSQLMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(DynamicSQLMapper.class);</span><br><span class="line">List&lt;Emp&gt; emps= mapper.getEmpByCondition(<span class="keyword">new</span> <span class="title class_">Emp</span>(<span class="literal">null</span>, <span class="string">&quot;张三&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>));</span><br><span class="line">System.out.println(emps);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/trim%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png" alt="trim测试结果"></p><h2 id="10-4-choose、when、otherwise"><a href="#10-4-choose、when、otherwise" class="headerlink" title="10.4 choose、when、otherwise"></a>10.4 choose、when、otherwise</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">choose、when、otherwise相当于if...else if..else</span><br><span class="line">when至少要有一个，otherwise至多只有一个</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByChoose&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp</span><br><span class="line"><span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;empName != null and empName != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">emp_name = #&#123;empName&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;age != null and age != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">age = #&#123;age&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;sex != null and sex != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">sex = #&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;email != null and email != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">email = #&#123;email&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">did = 1</span><br><span class="line"><span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getEmpByChoose</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">DynamicSQLMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(DynamicSQLMapper.class);</span><br><span class="line">List&lt;Emp&gt; emps = mapper.getEmpByChoose(<span class="keyword">new</span> <span class="title class_">Emp</span>(<span class="literal">null</span>, <span class="string">&quot;张三&quot;</span>, <span class="number">23</span>, <span class="string">&quot;男&quot;</span>, <span class="string">&quot;123@qq.com&quot;</span>, <span class="literal">null</span>));</span><br><span class="line">System.out.println(emps);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/choose%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png" alt="choose测试结果"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">相当于if a else if b else if c else d，只会执行其中一个</span><br></pre></td></tr></table></figure><h2 id="10-5-foreach"><a href="#10-5-foreach" class="headerlink" title="10.5 foreach"></a>10.5 foreach</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">属性：  </span><br><span class="line">collection：设置要循环的数组或集合  </span><br><span class="line">item：表示集合或数组中的每一个数据  </span><br><span class="line">separator：设置循环体之间的分隔符，分隔符前后默认有一个空格，如` , `</span><br><span class="line">open：设置foreach标签中的内容的开始符  </span><br><span class="line">close：设置foreach标签中的内容的结束符</span><br></pre></td></tr></table></figure><h3 id="10-5-1-批量删除"><a href="#10-5-1-批量删除" class="headerlink" title="10.5.1 批量删除"></a>10.5.1 批量删除</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int deleteMoreByArray(Integer[] eids);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteMoreByArray&quot;</span>&gt;</span></span><br><span class="line">delete from t_emp where eid in</span><br><span class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;eids&quot;</span> <span class="attr">item</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">#&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteMoreByArray</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">DynamicSQLMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(DynamicSQLMapper.class);</span><br><span class="line"><span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> mapper.deleteMoreByArray(<span class="keyword">new</span> <span class="title class_">Integer</span>[]&#123;<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;);</span><br><span class="line">System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/foreach%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C1.png" alt="foreach测试结果1"></p><h3 id="10-5-2-批量添加"><a href="#10-5-2-批量添加" class="headerlink" title="10.5.2 批量添加"></a>10.5.2 批量添加</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int insertMoreByList(@Param(&quot;emps&quot;) List&lt;Emp&gt; emps);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertMoreByList&quot;</span>&gt;</span></span><br><span class="line">insert into t_emp values</span><br><span class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;emps&quot;</span> <span class="attr">item</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">(null,#&#123;emp.empName&#125;,#&#123;emp.age&#125;,#&#123;emp.sex&#125;,#&#123;emp.email&#125;,null)</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertMoreByList</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtils.getSqlSession();</span><br><span class="line"><span class="type">DynamicSQLMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(DynamicSQLMapper.class);</span><br><span class="line"><span class="type">Emp</span> <span class="variable">emp1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>(<span class="literal">null</span>,<span class="string">&quot;a&quot;</span>,<span class="number">1</span>,<span class="string">&quot;男&quot;</span>,<span class="string">&quot;123@321.com&quot;</span>,<span class="literal">null</span>);</span><br><span class="line"><span class="type">Emp</span> <span class="variable">emp2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>(<span class="literal">null</span>,<span class="string">&quot;b&quot;</span>,<span class="number">1</span>,<span class="string">&quot;男&quot;</span>,<span class="string">&quot;123@321.com&quot;</span>,<span class="literal">null</span>);</span><br><span class="line"><span class="type">Emp</span> <span class="variable">emp3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>(<span class="literal">null</span>,<span class="string">&quot;c&quot;</span>,<span class="number">1</span>,<span class="string">&quot;男&quot;</span>,<span class="string">&quot;123@321.com&quot;</span>,<span class="literal">null</span>);</span><br><span class="line">List&lt;Emp&gt; emps = Arrays.asList(emp1, emp2, emp3);</span><br><span class="line"><span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> mapper.insertMoreByList(emps);</span><br><span class="line">System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/foreach%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C2.png" alt="foreach测试结果2"></p><h2 id="10-6-SQL片段"><a href="#10-6-SQL片段" class="headerlink" title="10.6 SQL片段"></a>10.6 SQL片段</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql片段，可以记录一段公共sql片段，在使用的地方通过include标签进行引入</span><br><span class="line">声明sql片段：&lt;sql&gt;标签</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;empColumns&quot;</span>&gt;</span>eid,emp_name,age,sex,email<span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">引用sql片段：&lt;include&gt;标签</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByCondition&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;empColumns&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span> from t_emp</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="十一、MyBatis的缓存"><a href="#十一、MyBatis的缓存" class="headerlink" title="十一、MyBatis的缓存"></a>十一、MyBatis的缓存</h1><h2 id="11-1-MyBatis的一级缓存"><a href="#11-1-MyBatis的一级缓存" class="headerlink" title="11.1 MyBatis的一级缓存"></a>11.1 MyBatis的一级缓存</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">一级缓存是SqlSession级别的，通过同一个SqlSession查询的数据会被缓存，下次查询相同的数据，就会从缓存中直接获取，不会从数据库重新访问  </span><br><span class="line"></span><br><span class="line">使一级缓存失效的四种情况：  </span><br><span class="line">  1. 不同的SqlSession对应不同的一级缓存  </span><br><span class="line">  2. 同一个SqlSession但是查询条件不同</span><br><span class="line">  3. 同一个SqlSession两次查询期间执行了任何一次增删改操作</span><br><span class="line">  4. 同一个SqlSession两次查询期间手动清空了缓存</span><br></pre></td></tr></table></figure><h2 id="11-2-MyBatis的二级缓存"><a href="#11-2-MyBatis的二级缓存" class="headerlink" title="11.2 MyBatis的二级缓存"></a>11.2 MyBatis的二级缓存</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">二级缓存是SqlSessionFactory级别，通过同一个SqlSessionFactory创建的SqlSession查询的结果会被缓存；此后若再次执行相同的查询语句，结果就会从缓存中获取 </span><br><span class="line"></span><br><span class="line">二级缓存开启的条件</span><br><span class="line">  1. 在核心配置文件中，设置全局配置属性cacheEnabled=&quot;true&quot;，默认为true，不需要设置</span><br><span class="line">  2. 在映射文件中设置标签&lt;cache /&gt;</span><br><span class="line">  3. 二级缓存必须在SqlSession关闭或提交之后有效</span><br><span class="line">  4. 查询的数据所转换的实体类类型必须实现序列化的接口</span><br><span class="line">  </span><br><span class="line">使二级缓存失效的情况：两次查询之间执行了任意的增删改，会使一级和二级缓存同时失效</span><br></pre></td></tr></table></figure><h2 id="11-3-二级缓存的相关配置"><a href="#11-3-二级缓存的相关配置" class="headerlink" title="11.3 二级缓存的相关配置"></a>11.3 二级缓存的相关配置</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">在mapper配置文件中添加的cache标签可以设置一些属性</span><br><span class="line">eviction属性：缓存回收策略  </span><br><span class="line">  LRU（Least Recently Used） – 最近最少使用的：移除最长时间不被使用的对象。  </span><br><span class="line">  FIFO（First in First out） – 先进先出：按对象进入缓存的顺序来移除它们。  </span><br><span class="line">  SOFT – 软引用：移除基于垃圾回收器状态和软引用规则的对象。  </span><br><span class="line">  WEAK – 弱引用：更积极地移除基于垃圾收集器状态和弱引用规则的对象。</span><br><span class="line">  默认的是 LRU</span><br><span class="line">flushInterval属性：刷新间隔，单位毫秒</span><br><span class="line">  默认情况是不设置，也就是没有刷新间隔，缓存仅仅调用语句（增删改）时刷新</span><br><span class="line">size属性：引用数目，正整数</span><br><span class="line">  代表缓存最多可以存储多少个对象，太大容易导致内存溢出</span><br><span class="line">readOnly属性：只读，true/false</span><br><span class="line">  true：只读缓存；会给所有调用者返回缓存对象的相同实例。因此这些对象不能被修改。这提供了很重要的性能优势。  </span><br><span class="line">  false：读写缓存；会返回缓存对象的拷贝（通过序列化）。这会慢一些，但是安全，因此默认是false</span><br></pre></td></tr></table></figure><h2 id="11-4-MyBatis缓存查询的顺序"><a href="#11-4-MyBatis缓存查询的顺序" class="headerlink" title="11.4 MyBatis缓存查询的顺序"></a>11.4 MyBatis缓存查询的顺序</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">先查询二级缓存，因为二级缓存中可能会有其他程序已经查出来的数据，可以拿来直接使用  </span><br><span class="line">如果二级缓存没有命中，再查询一级缓存  </span><br><span class="line">如果一级缓存也没有命中，则查询数据库  </span><br><span class="line">SqlSession关闭之后，一级缓存中的数据会写入二级缓存</span><br></pre></td></tr></table></figure><h2 id="11-5-整合第三方缓存EHCache（了解）"><a href="#11-5-整合第三方缓存EHCache（了解）" class="headerlink" title="11.5 整合第三方缓存EHCache（了解）"></a>11.5 整合第三方缓存EHCache（了解）</h2><h3 id="11-5-1-添加依赖"><a href="#11-5-1-添加依赖" class="headerlink" title="11.5.1 添加依赖"></a>11.5.1 添加依赖</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Mybatis EHCache整合包 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.mybatis.caches&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;mybatis-ehcache&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;1.2.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!-- slf4j日志门面的一个具体实现 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;logback-classic&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;1.2.3&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h3 id="11-5-2-各个jar包的功能"><a href="#11-5-2-各个jar包的功能" class="headerlink" title="11.5.2 各个jar包的功能"></a>11.5.2 各个jar包的功能</h3><table><thead><tr><th>jar包名称</th><th>作用</th></tr></thead><tbody><tr><td>mybatis-ehcache</td><td>Mybatis和EHCache的整合包</td></tr><tr><td>ehcache</td><td>EHCache核心包</td></tr><tr><td>slf4j-api</td><td>SLF4J日志门面包</td></tr><tr><td>logback-classic</td><td>支持SLF4J门面接口的一个具体实现</td></tr></tbody></table><h3 id="11-5-3-创建EHCache的配置文件ehcache-xml"><a href="#11-5-3-创建EHCache的配置文件ehcache-xml" class="headerlink" title="11.5.3 创建EHCache的配置文件ehcache.xml"></a>11.5.3 创建EHCache的配置文件ehcache.xml</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">名字必须叫ehcache.xml</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ehcache</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:noNamespaceSchemaLocation</span>=<span class="string">&quot;../config/ehcache.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 磁盘保存路径 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">diskStore</span> <span class="attr">path</span>=<span class="string">&quot;D:\atguigu\ehcache&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">defaultCache</span></span></span><br><span class="line"><span class="tag">            <span class="attr">maxElementsInMemory</span>=<span class="string">&quot;1000&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">maxElementsOnDisk</span>=<span class="string">&quot;10000000&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">eternal</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">overflowToDisk</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">timeToIdleSeconds</span>=<span class="string">&quot;120&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">timeToLiveSeconds</span>=<span class="string">&quot;120&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">diskExpiryThreadIntervalSeconds</span>=<span class="string">&quot;120&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">memoryStoreEvictionPolicy</span>=<span class="string">&quot;LRU&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">defaultCache</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ehcache</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="11-5-4-设置二级缓存的类型"><a href="#11-5-4-设置二级缓存的类型" class="headerlink" title="11.5.4 设置二级缓存的类型"></a>11.5.4 设置二级缓存的类型</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在xxxMapper.xml文件中设置二级缓存类型</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h3 id="11-5-5-加入logback日志"><a href="#11-5-5-加入logback日志" class="headerlink" title="11.5.5 加入logback日志"></a>11.5.5 加入logback日志</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">存在SLF4J时，作为简易日志的log4j将失效，此时我们需要借助SLF4J的具体实现logback来打印日志。创建logback的配置文件logback.xml，名字固定，不可改变</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">debug</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定日志输出的位置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 日志输出的格式 --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 按照顺序分别是：时间、日志级别、线程名称、打印日志的类、日志主体内容、换行 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>[%d&#123;HH:mm:ss.SSS&#125;] [%-5level] [%thread] [%logger] [%msg]%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 设置全局日志级别。日志级别按顺序分别是：DEBUG、INFO、WARN、ERROR --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定任何一个日志级别都只打印当前级别和后面级别的日志。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 指定打印日志的appender，这里通过“STDOUT”引用了前面配置的appender --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 根据特殊需求指定局部日志级别 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;com.atguigu.crowd.mapper&quot;</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="11-5-6-EHCache配置文件说明"><a href="#11-5-6-EHCache配置文件说明" class="headerlink" title="11.5.6 EHCache配置文件说明"></a>11.5.6 EHCache配置文件说明</h3><table><thead><tr><th>属性名</th><th>是否必须</th><th>作用</th></tr></thead><tbody><tr><td>maxElementsInMemory</td><td>是</td><td>在内存中缓存的element的最大数目</td></tr><tr><td>maxElementsOnDisk</td><td>是</td><td>在磁盘上缓存的element的最大数目，若是0表示无穷大</td></tr><tr><td>eternal</td><td>是</td><td>设定缓存的elements是否永远不过期。 如果为true，则缓存的数据始终有效， 如果为false那么还要根据timeToIdleSeconds、timeToLiveSeconds判断</td></tr><tr><td>overflowToDisk</td><td>是</td><td>设定当内存缓存溢出的时候是否将过期的element缓存到磁盘上</td></tr><tr><td>timeToIdleSeconds</td><td>否</td><td>当缓存在EhCache中的数据前后两次访问的时间超过timeToIdleSeconds的属性取值时， 这些数据便会删除，默认值是0,也就是可闲置时间无穷大</td></tr><tr><td>timeToLiveSeconds</td><td>否</td><td>缓存element的有效生命期，默认是0.,也就是element存活时间无穷大</td></tr><tr><td>diskSpoolBufferSizeMB</td><td>否</td><td>DiskStore(磁盘缓存)的缓存区大小。默认是30MB。每个Cache都应该有自己的一个缓冲区</td></tr><tr><td>diskPersistent</td><td>否</td><td>在VM重启的时候是否启用磁盘保存EhCache中的数据，默认是false</td></tr><tr><td>diskExpiryThreadIntervalSeconds</td><td>否</td><td>磁盘缓存的清理线程运行间隔，默认是120秒。每个120s， 相应的线程会进行一次EhCache中数据的清理工作</td></tr><tr><td>memoryStoreEvictionPolicy</td><td>否</td><td>当内存缓存达到最大，有新的element加入的时候， 移除缓存中element的策略。 默认是LRU（最近最少使用），可选的有LFU（最不常使用）和FIFO（先进先出</td></tr></tbody></table><h1 id="十二、MyBatis的逆向工程"><a href="#十二、MyBatis的逆向工程" class="headerlink" title="十二、MyBatis的逆向工程"></a>十二、MyBatis的逆向工程</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">正向工程：先创建Java实体类，由框架负责根据实体类生成数据库表。Hibernate是支持正向工程的</span><br><span class="line">逆向工程：先创建数据库表，由框架负责根据数据库表，反向生成如下资源：  </span><br><span class="line">    Java实体类  </span><br><span class="line">    Mapper接口  </span><br><span class="line">  Mapper映射文件</span><br></pre></td></tr></table></figure><h2 id="12-1-创建逆向工程的步骤"><a href="#12-1-创建逆向工程的步骤" class="headerlink" title="12.1 创建逆向工程的步骤"></a>12.1 创建逆向工程的步骤</h2><h3 id="12-1-1-添加依赖和插件"><a href="#12-1-1-添加依赖和插件" class="headerlink" title="12.1.1 添加依赖和插件"></a>12.1.1 添加依赖和插件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- MyBatis核心依赖包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- junit测试 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- MySQL驱动 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- log4j日志 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 控制Maven在构建过程中相关配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 构建过程中用到的插件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 具体插件，逆向工程的操作是以构建过程中插件形式出现的 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 插件的依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 逆向工程的核心依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 数据库连接池 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- MySQL驱动 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="12-1-2-创建MyBatis的核心配置文件"><a href="#12-1-2-创建MyBatis的核心配置文件" class="headerlink" title="12.1.2 创建MyBatis的核心配置文件"></a>12.1.2 创建MyBatis的核心配置文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="12-1-3-创建逆向工程的配置文件"><a href="#12-1-3-创建逆向工程的配置文件" class="headerlink" title="12.1.3 创建逆向工程的配置文件"></a>12.1.3 创建逆向工程的配置文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">文件名必须是：generatorConfig.xml</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    targetRuntime: 执行生成的逆向工程的版本</span></span><br><span class="line"><span class="comment">    MyBatis3Simple: 生成基本的CRUD（清新简洁版）</span></span><br><span class="line"><span class="comment">    MyBatis3: 生成带条件的CRUD（奢华尊享版）</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">&quot;DB2Tables&quot;</span> <span class="attr">targetRuntime</span>=<span class="string">&quot;MyBatis3Simple&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 数据库的连接信息 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">&quot;root&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">&quot;123456&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- javaBean的生成策略--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.atguigu.mybatis.pojo&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;.\src\main\java&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;trimStrings&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL映射文件的生成策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.atguigu.mybatis.mapper&quot;</span></span></span><br><span class="line"><span class="tag">                         <span class="attr">targetProject</span>=<span class="string">&quot;.\src\main\resources&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Mapper接口的生成策略 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">&quot;XMLMAPPER&quot;</span></span></span><br><span class="line"><span class="tag">                             <span class="attr">targetPackage</span>=<span class="string">&quot;com.atguigu.mybatis.mapper&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;.\src\main\java&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 逆向分析的表 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tableName设置为*号，可以对应所有表，此时不写domainObjectName --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- domainObjectName属性指定生成出来的实体类的类名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;t_emp&quot;</span> <span class="attr">domainObjectName</span>=<span class="string">&quot;Emp&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;t_dept&quot;</span> <span class="attr">domainObjectName</span>=<span class="string">&quot;Dept&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="12-1-4-执行MBG插件的generate目标"><a href="#12-1-4-执行MBG插件的generate目标" class="headerlink" title="12.1.4 执行MBG插件的generate目标"></a>12.1.4 执行MBG插件的generate目标</h3><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E6%89%A7%E8%A1%8CMBG%E6%8F%92%E4%BB%B6%E7%9A%84generate%E7%9B%AE%E6%A0%87.png" alt="执行MBG插件的generate目标"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如果出现报错：Exception getting JDBC Driver，可能是pom.xml中，数据库驱动配置错误.两者的驱动版本应该相同</span><br><span class="line">  dependency中的驱动</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/dependency%E4%B8%AD%E7%9A%84%E9%A9%B1%E5%8A%A8.png" alt="dependency中的驱动"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mybatis-generator-maven-plugin插件中的驱动</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E6%8F%92%E4%BB%B6%E4%B8%AD%E7%9A%84%E9%A9%B1%E5%8A%A8.png" alt="插件中的驱动"></p><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E9%80%86%E5%90%91%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C.png" alt="逆向执行结果"></p><h2 id="12-2-QBC"><a href="#12-2-QBC" class="headerlink" title="12.2 QBC"></a>12.2 QBC</h2><h3 id="12-2-1-查询"><a href="#12-2-1-查询" class="headerlink" title="12.2.1 查询"></a>12.2.1 查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">selectByExample：按条件查询，需要传入一个example对象或者null；如果传入一个null，则表示没有条件，也就是查询所有数据</span><br><span class="line">example.createCriteria().xxx：创建条件对象，通过andXXX方法为SQL添加查询添加，每个条件之间是and关系</span><br><span class="line">example.or().xxx：将之前添加的条件通过or拼接其他条件</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/example%E7%9A%84%E6%96%B9%E6%B3%95.png" alt="example的方法"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMBG</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"><span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line"><span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line"><span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(is);</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession(<span class="literal">true</span>);</span><br><span class="line"><span class="type">EmpMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(EmpMapper.class);</span><br><span class="line"><span class="type">EmpExample</span> <span class="variable">example</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EmpExample</span>();</span><br><span class="line"><span class="comment">//名字为张三，且年龄大于等于20</span></span><br><span class="line">example.createCriteria().andEmpNameEqualTo(<span class="string">&quot;张三&quot;</span>).andAgeGreaterThanOrEqualTo(<span class="number">20</span>);</span><br><span class="line"><span class="comment">//或者did不为空</span></span><br><span class="line">example.or().andDidIsNotNull();</span><br><span class="line">List&lt;Emp&gt; emps = mapper.selectByExample(example);</span><br><span class="line">emps.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/example%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png" alt="example测试结果"></p><h3 id="12-2-2-增改"><a href="#12-2-2-增改" class="headerlink" title="12.2.2 增改"></a>12.2.2 增改</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">updateByPrimaryKey：通过主键进行数据修改，如果某一个值为null，也会将对应的字段改为null</span><br><span class="line">mapper.updateByPrimaryKey(new Emp(1,&quot;admin&quot;,22,null,&quot;456@qq.com&quot;,3));</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E5%A2%9E%E5%88%A0%E6%94%B9%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C1.png" alt="增删改测试结果1"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">updateByPrimaryKeySelective()：通过主键进行选择性数据修改，如果某个值为null，则不修改这个字段</span><br><span class="line">mapper.updateByPrimaryKeySelective(new Emp(2,&quot;admin2&quot;,22,null,&quot;456@qq.com&quot;,3));</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E5%A2%9E%E5%88%A0%E6%94%B9%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C2.png" alt="增删改测试结果2"></p><h1 id="十三、分页插件"><a href="#十三、分页插件" class="headerlink" title="十三、分页插件"></a>十三、分页插件</h1><h2 id="13-1-分页插件使用步骤"><a href="#13-1-分页插件使用步骤" class="headerlink" title="13.1 分页插件使用步骤"></a>13.1 分页插件使用步骤</h2><h3 id="13-1-1-添加依赖"><a href="#13-1-1-添加依赖" class="headerlink" title="13.1.1 添加依赖"></a>13.1.1 添加依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.github.pagehelper/pagehelper --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="13-1-2-配置分页插件"><a href="#13-1-2-配置分页插件" class="headerlink" title="13.1.2 配置分页插件"></a>13.1.2 配置分页插件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在MyBatis的核心配置文件（mybatis-config.xml）中配置插件</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E9%85%8D%E7%BD%AE%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6.png" alt="配置分页插件"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--设置分页插件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="13-2-分页插件的使用"><a href="#13-2-分页插件的使用" class="headerlink" title="13.2 分页插件的使用"></a>13.2 分页插件的使用</h2><h3 id="13-2-1-开启分页功能"><a href="#13-2-1-开启分页功能" class="headerlink" title="13.2.1 开启分页功能"></a>13.2.1 开启分页功能</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在查询功能之前使用`PageHelper.startPage(int pageNum, int pageSize)`开启分页功能</span><br><span class="line">pageNum：当前页的页码  </span><br><span class="line">pageSize：每页显示的条数</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPageHelper</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"><span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line"><span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line"><span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(is);</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession(<span class="literal">true</span>);</span><br><span class="line"><span class="type">EmpMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(EmpMapper.class);</span><br><span class="line"><span class="comment">//访问第一页，每页四条数据</span></span><br><span class="line">PageHelper.startPage(<span class="number">1</span>,<span class="number">4</span>);</span><br><span class="line">List&lt;Emp&gt; emps = mapper.selectByExample(<span class="literal">null</span>);</span><br><span class="line">emps.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/MyBatis%E6%95%99%E7%A8%8B/%E5%88%86%E9%A1%B5%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png" alt="分页测试结果"></p><h3 id="13-2-2-分页相关数据"><a href="#13-2-2-分页相关数据" class="headerlink" title="13.2.2 分页相关数据"></a>13.2.2 分页相关数据</h3><h4 id="方法一：直接输出"><a href="#方法一：直接输出" class="headerlink" title="方法一：直接输出"></a>方法一：直接输出</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPageHelper</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"><span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line"><span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line"><span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(is);</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession(<span class="literal">true</span>);</span><br><span class="line"><span class="type">EmpMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(EmpMapper.class);</span><br><span class="line"><span class="comment">//访问第一页，每页四条数据</span></span><br><span class="line">Page&lt;Object&gt; page = PageHelper.startPage(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">List&lt;Emp&gt; emps = mapper.selectByExample(<span class="literal">null</span>);</span><br><span class="line"><span class="comment">//在查询到List集合后，打印分页数据</span></span><br><span class="line">System.out.println(page);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">分页相关数据：</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Page&#123;count=true, pageNum=1, pageSize=4, startRow=0, endRow=4, total=8, pages=2, reasonable=false, pageSizeZero=false&#125;[Emp&#123;eid=1, empName=&#x27;admin&#x27;, age=22, sex=&#x27;男&#x27;, email=&#x27;456@qq.com&#x27;, did=3&#125;, Emp&#123;eid=2, empName=&#x27;admin2&#x27;, age=22, sex=&#x27;男&#x27;, email=&#x27;456@qq.com&#x27;, did=3&#125;, Emp&#123;eid=3, empName=&#x27;王五&#x27;, age=12, sex=&#x27;女&#x27;, email=&#x27;123@qq.com&#x27;, did=3&#125;, Emp&#123;eid=4, empName=&#x27;赵六&#x27;, age=32, sex=&#x27;男&#x27;, email=&#x27;123@qq.com&#x27;, did=1&#125;]</span><br></pre></td></tr></table></figure><h4 id="方法二：使用PageInfo"><a href="#方法二：使用PageInfo" class="headerlink" title="方法二：使用PageInfo"></a>方法二：使用PageInfo</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">在查询获取list集合之后，使用`PageInfo&lt;T&gt; pageInfo = new PageInfo&lt;&gt;(List&lt;T&gt; list, intnavigatePages)`获取分页相关数据</span><br><span class="line"></span><br><span class="line">list：分页之后的数据  </span><br><span class="line">navigatePages：导航分页的页码数</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPageHelper</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"><span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line"><span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line"><span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(is);</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession(<span class="literal">true</span>);</span><br><span class="line"><span class="type">EmpMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(EmpMapper.class);</span><br><span class="line">PageHelper.startPage(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">List&lt;Emp&gt; emps = mapper.selectByExample(<span class="literal">null</span>);</span><br><span class="line">PageInfo&lt;Emp&gt; page = <span class="keyword">new</span> <span class="title class_">PageInfo</span>&lt;&gt;(emps,<span class="number">5</span>);</span><br><span class="line">System.out.println(page);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">分页相关数据：</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PageInfo<span class="punctuation">&#123;</span></span><br><span class="line">pageNum=<span class="number">1</span><span class="punctuation">,</span> pageSize=<span class="number">4</span><span class="punctuation">,</span> size=<span class="number">4</span><span class="punctuation">,</span> startRow=<span class="number">1</span><span class="punctuation">,</span> endRow=<span class="number">4</span><span class="punctuation">,</span> total=<span class="number">8</span><span class="punctuation">,</span> pages=<span class="number">2</span><span class="punctuation">,</span> </span><br><span class="line">list=Page<span class="punctuation">&#123;</span>count=<span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> pageNum=<span class="number">1</span><span class="punctuation">,</span> pageSize=<span class="number">4</span><span class="punctuation">,</span> startRow=<span class="number">0</span><span class="punctuation">,</span> endRow=<span class="number">4</span><span class="punctuation">,</span> total=<span class="number">8</span><span class="punctuation">,</span> pages=<span class="number">2</span><span class="punctuation">,</span> reasonable=<span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span> pageSizeZero=<span class="literal"><span class="keyword">false</span></span><span class="punctuation">&#125;</span><span class="punctuation">[</span>Emp<span class="punctuation">&#123;</span>eid=<span class="number">1</span><span class="punctuation">,</span> empName=&#x27;admin&#x27;<span class="punctuation">,</span> age=<span class="number">22</span><span class="punctuation">,</span> sex=&#x27;男&#x27;<span class="punctuation">,</span> email=&#x27;<span class="number">456</span>@qq.com&#x27;<span class="punctuation">,</span> did=<span class="number">3</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> Emp<span class="punctuation">&#123;</span>eid=<span class="number">2</span><span class="punctuation">,</span> empName=&#x27;admin2&#x27;<span class="punctuation">,</span> age=<span class="number">22</span><span class="punctuation">,</span> sex=&#x27;男&#x27;<span class="punctuation">,</span> email=&#x27;<span class="number">456</span>@qq.com&#x27;<span class="punctuation">,</span> did=<span class="number">3</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> Emp<span class="punctuation">&#123;</span>eid=<span class="number">3</span><span class="punctuation">,</span> empName=&#x27;王五&#x27;<span class="punctuation">,</span> age=<span class="number">12</span><span class="punctuation">,</span> sex=&#x27;女&#x27;<span class="punctuation">,</span> email=&#x27;<span class="number">123</span>@qq.com&#x27;<span class="punctuation">,</span> did=<span class="number">3</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> Emp<span class="punctuation">&#123;</span>eid=<span class="number">4</span><span class="punctuation">,</span> empName=&#x27;赵六&#x27;<span class="punctuation">,</span> age=<span class="number">32</span><span class="punctuation">,</span> sex=&#x27;男&#x27;<span class="punctuation">,</span> email=&#x27;<span class="number">123</span>@qq.com&#x27;<span class="punctuation">,</span> did=<span class="number">1</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span> </span><br><span class="line">prePage=<span class="number">0</span><span class="punctuation">,</span> nextPage=<span class="number">2</span><span class="punctuation">,</span> isFirstPage=<span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> isLastPage=<span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span> hasPreviousPage=<span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span> hasNextPage=<span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> navigatePages=<span class="number">5</span><span class="punctuation">,</span> navigateFirstPage=<span class="number">1</span><span class="punctuation">,</span> navigateLastPage=<span class="number">2</span><span class="punctuation">,</span> navigatepageNums=<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">其中list中的数据等同于方法一中直接输出的page数据</span><br></pre></td></tr></table></figure><h4 id="常用数据："><a href="#常用数据：" class="headerlink" title="常用数据："></a>常用数据：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pageNum：当前页的页码  </span><br><span class="line">pageSize：每页显示的条数  </span><br><span class="line">size：当前页显示的真实条数  </span><br><span class="line">total：总记录数  </span><br><span class="line">pages：总页数  </span><br><span class="line">prePage：上一页的页码  </span><br><span class="line">nextPage：下一页的页码</span><br><span class="line">isFirstPage/isLastPage：是否为第一页/最后一页  </span><br><span class="line">hasPreviousPage/hasNextPage：是否存在上一页/下一页  </span><br><span class="line">navigatePages：导航分页的页码数  </span><br><span class="line">navigatepageNums：导航分页的页码，[1,2,3,4,5]</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">MyBatis的简介、搭建MyBatis环境、配置文件详解、使用MyBatis增删改查、动态SQL、缓存、逆向工程、分页插件相关知识</summary>
    
    
    
    <category term="数据库" scheme="https://chenhaonan.dpdns.org/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="教程" scheme="https://chenhaonan.dpdns.org/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="Java" scheme="https://chenhaonan.dpdns.org/tags/Java/"/>
    
    <category term="数据库" scheme="https://chenhaonan.dpdns.org/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="Mybatis" scheme="https://chenhaonan.dpdns.org/tags/Mybatis/"/>
    
  </entry>
  
  <entry>
    <title>JDBC</title>
    <link href="https://chenhaonan.dpdns.org/posts/5c27/"/>
    <id>https://chenhaonan.dpdns.org/posts/5c27/</id>
    <published>2024-10-12T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.907Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、JDBC介绍"><a href="#一、JDBC介绍" class="headerlink" title="一、JDBC介绍"></a>一、JDBC介绍</h1><blockquote><p>JDBC (Java DataBase Contectivity) Java与数据库的连接——数据库编程</p><p>JDBC 是Java语言（JDK）为完成数据库的访问操作提供的一套统一的标准。</p></blockquote><p><img src="/../images/JDBC/image-20211015111756439.png" alt="image-20211015111756439"></p><h1 id="二、JDBC步骤"><a href="#二、JDBC步骤" class="headerlink" title="二、JDBC步骤"></a>二、JDBC步骤</h1><p><img src="/../images/JDBC/image-20211015121216207.png" alt="image-20211015121216207"></p><h1 id="三、JDBC入门案例"><a href="#三、JDBC入门案例" class="headerlink" title="三、JDBC入门案例"></a>三、JDBC入门案例</h1><blockquote><p>JDBC 是用Java代码完成数据访问的规范</p></blockquote><h2 id="3-1-加载驱动"><a href="#3-1-加载驱动" class="headerlink" title="3.1 加载驱动"></a>3.1 加载驱动</h2><h3 id="3-1-1-下载驱动jar包"><a href="#3-1-1-下载驱动jar包" class="headerlink" title="3.1.1 下载驱动jar包"></a>3.1.1 下载驱动jar包</h3><blockquote><p>对应数据库匹配版本的驱动jar包</p></blockquote><ul><li><p>地址<a href="https://mvnrepository.com/">https://mvnrepository.com/</a></p></li><li><p>搜索<code>mysql</code></p><p><img src="/../images/JDBC/image-20211015124423535.png" alt="image-20211015124423535"></p></li><li><p>选择版本下载</p><p>MySQL数据库版本为5.x,驱动jar包建议使用<code>5.1.47</code></p><p>MySQL数据库版本为8.x,驱动jar包建议使用<code>8.0.x</code></p><p><img src="/../images/JDBC/image-20211015124643518.png" alt="image-20211015124643518"></p></li></ul><h3 id="3-1-2-将驱动jar文件添加到Java应用"><a href="#3-1-2-将驱动jar文件添加到Java应用" class="headerlink" title="3.1.2 将驱动jar文件添加到Java应用"></a>3.1.2 将驱动jar文件添加到Java应用</h3><ul><li>在java应用中创建lib文件夹</li><li>将下载好的jar文件拷贝—粘贴到lib目录</li><li>将驱动jar文件设置为java库：选择lib&#x2F;驱动jar—右键—Add as Library.. —OK</li></ul><h3 id="3-1-3-注册驱动"><a href="#3-1-3-注册驱动" class="headerlink" title="3.1.3 注册驱动"></a>3.1.3 注册驱动</h3><blockquote><p>通过反射机制，将驱动jar文件中提供的驱动类载入到JVM中</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.注册驱动（驱动jar包中的驱动类（Driver）的路径：com.mysql.cj.jdbc.Driver）</span></span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="3-2-创建连接"><a href="#3-2-创建连接" class="headerlink" title="3.2 创建连接"></a>3.2 创建连接</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.创建连接：通过数据库驱动管理器 DriverManager（java.sql.Driver）获取连接</span></span><br><span class="line"><span class="comment">//  JDBC JDK提供的数据库连接的规范 --- java.sql</span></span><br><span class="line"><span class="comment">//  java.sql.Connection接口  一个对象就表示一个数据库连接</span></span><br><span class="line"><span class="comment">//  url 数据库的统一资源定位器（定位数据库连接资源）</span></span><br><span class="line"><span class="comment">//  url参数</span></span><br><span class="line"><span class="comment">//      characterEncoding 设置编码</span></span><br><span class="line"><span class="comment">//      useSSL=true  使用SSL通信</span></span><br><span class="line"><span class="comment">//      useTimezone=true  设置客户端和服务端时区转换</span></span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3&quot;</span>;</span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;@QFedu123&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="3-3-编写SQL指令"><a href="#3-3-编写SQL指令" class="headerlink" title="3.3 编写SQL指令"></a>3.3 编写SQL指令</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.编写要执行的SQL指令:SQL指令中需要的参数可以通过字符串拼接的形式（会导致SQL注入）</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_id,book_name,book_author,book_price,book_stock,book_desc) values(&#x27;&quot;</span>+id+<span class="string">&quot;&#x27;,&#x27;&quot;</span>+name+<span class="string">&quot;&#x27;,&#x27;&quot;</span>+author+<span class="string">&quot;&#x27;,&quot;</span>+price+<span class="string">&quot;,&quot;</span>+stock+<span class="string">&quot;,&#x27;&quot;</span>+desc+<span class="string">&quot;&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure><h2 id="3-4-加载SQL指令"><a href="#3-4-加载SQL指令" class="headerlink" title="3.4 加载SQL指令"></a>3.4 加载SQL指令</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//4.加载SQL指令:获取SQL指令的加载器</span></span><br><span class="line"><span class="comment">//  java.sql.Statement 对象 可以理解为 SQL指令的“加载器”</span></span><br><span class="line"><span class="comment">//  java.sql.PreparedStatement 对象   SQL指令的“预编译加载器”</span></span><br><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br></pre></td></tr></table></figure><h2 id="3-5-执行SQL、获取结果"><a href="#3-5-执行SQL、获取结果" class="headerlink" title="3.5 执行SQL、获取结果"></a>3.5 执行SQL、获取结果</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//5.执行SQL获取执行结果</span></span><br><span class="line"><span class="comment">// a. 如果SQL指令为DQL,则  ResultSet rs = statement.executeQuery(sql);  rs中就是查询结果</span></span><br><span class="line"><span class="comment">// b. 如果SQL指令为DML，则  int i = statement.executeUpdate(sql);   i就表示DML操作影响的数据行数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果i&gt;0，表示DML操作是成功的；如果i=0表示DML操作对数据表中的数据没有影响</span></span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> statement.executeUpdate(sql);  </span><br></pre></td></tr></table></figure><h2 id="3-6-处理结果"><a href="#3-6-处理结果" class="headerlink" title="3.6 处理结果"></a>3.6 处理结果</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//6.处理结果（业务）</span></span><br><span class="line"><span class="comment">// 添加操作：返回值i&gt;0表示添加成功，否则表示添加失败</span></span><br><span class="line"><span class="comment">// 修改操作：返回值i&gt;0表示修改对数据有影响，如果i=0 表示对数据库没有影响</span></span><br><span class="line"><span class="comment">// 删除操作：返回值i&gt;0表示删除对数据有影响，如果i=0 表示对数据库没有影响</span></span><br><span class="line"><span class="comment">// 查询操作：从ResultSet rs中取出查询结果，封装到Java对象中</span></span><br><span class="line">System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;添加成功&quot;</span>:<span class="string">&quot;添加失败&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="3-7-关闭连接"><a href="#3-7-关闭连接" class="headerlink" title="3.7 关闭连接"></a>3.7 关闭连接</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//7.关闭连接</span></span><br><span class="line"><span class="comment">// 如果执行DML操作：需要关闭Statement和Connection</span></span><br><span class="line"><span class="comment">// 如果执行DQL操作：需要关闭ResultSet、Statement和Connection</span></span><br><span class="line"><span class="comment">// 关闭之前先判空、由xiao到大关闭</span></span><br><span class="line"><span class="keyword">if</span>(statement != <span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">    statement.close();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(connection !=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">    connection.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="四、JDBC增删查改操作实例"><a href="#四、JDBC增删查改操作实例" class="headerlink" title="四、JDBC增删查改操作实例"></a>四、JDBC增删查改操作实例</h1><blockquote><p>使用JDBC完成数据库的CRUD访问</p></blockquote><h2 id="4-1-insert操作"><a href="#4-1-insert操作" class="headerlink" title="4.1 insert操作"></a>4.1 insert操作</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestInsertBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;Java进阶之路&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> <span class="string">&quot;老王&quot;</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> <span class="number">22.22</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> <span class="string">&quot;这本书很好&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.注册驱动（驱动jar包中的驱动类（Driver）的路径：com.mysql.cj.jdbc.Driver）</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.创建连接：通过数据库驱动管理器 DriverManager（java.sql.Driver）获取连接</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.编写要执行的SQL指令</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(&#x27;&quot;</span>+name+<span class="string">&quot;&#x27;,&#x27;&quot;</span>+author+<span class="string">&quot;&#x27;,&quot;</span>+price+<span class="string">&quot;,&quot;</span>+stock+<span class="string">&quot;,&#x27;&quot;</span>+desc+<span class="string">&quot;&#x27;)&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.加载SQL指令:获取SQL指令的加载器</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.执行SQL获取执行结果</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> statement.executeUpdate(sql);  </span><br><span class="line">        </span><br><span class="line">        <span class="comment">//6.处理结果（业务）</span></span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;添加成功&quot;</span>:<span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//7.关闭连接</span></span><br><span class="line">        <span class="keyword">if</span>(statement != <span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection !=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-2-delete操作"><a href="#4-2-delete操作" class="headerlink" title="4.2 delete操作"></a>4.2 delete操作</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestDeleteBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">bid</span> <span class="operator">=</span> <span class="number">1012</span>;</span><br><span class="line">        <span class="comment">//使用JDBC，根据图书编号删除图书信息</span></span><br><span class="line">        <span class="comment">//1.注册驱动</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="comment">//2.创建连接</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="comment">//3.编写SQL</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=&quot;</span>+bid;</span><br><span class="line">        <span class="comment">//4.获取SQL加载器</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="comment">//5.执行SQL</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line">        <span class="comment">//6.处理结果</span></span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;删除成功&quot;</span>:<span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">        <span class="comment">//7.关闭连接</span></span><br><span class="line">        <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-3-update操作"><a href="#4-3-update操作" class="headerlink" title="4.3 update操作"></a>4.3 update操作</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUpdateBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="comment">// 根据数据记录的主键 修改其他的字段</span></span><br><span class="line">        <span class="comment">// 根据图书ID，修改图书名称、作者、价格、库存、描述</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> <span class="number">1011</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;Java进阶之路&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> <span class="string">&quot;亮亮&quot;</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> <span class="number">36.80</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> <span class="number">8</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> <span class="string">&quot;这本书非常好&quot;</span>;</span><br><span class="line"></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=&#x27;&quot;</span>+name+<span class="string">&quot;&#x27;,book_author=&#x27;&quot;</span>+author+<span class="string">&quot;&#x27;,book_price=&quot;</span>+price+<span class="string">&quot;,book_stock=&quot;</span>+stock</span><br><span class="line">                +<span class="string">&quot;,book_desc=&#x27;&quot;</span>+desc+<span class="string">&quot;&#x27; where book_id=&quot;</span>+id;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;修改成功&quot;</span>:<span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-4-select操作（一条结果）"><a href="#4-4-select操作（一条结果）" class="headerlink" title="4.4 select操作（一条结果）"></a>4.4 select操作（一条结果）</h2><table><thead><tr><th>结果集处理</th></tr></thead><tbody><tr><td><img src="/../images/JDBC/image-20211015172123116.png" alt="image-20211015172123116"></td></tr></tbody></table><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSelectBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="comment">//根据图书ID，查询一本图书信息</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">bid</span> <span class="operator">=</span> <span class="number">1011</span>;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=&quot;</span>+bid;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="comment">//通过executeQuery方法执行查询语句，并且将查询的结果存放到一个ResultSet对象中（结果集）</span></span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">        <span class="comment">//处理结果：从rs中获取查询结果</span></span><br><span class="line">        <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookId</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            System.out.println(bookId+<span class="string">&quot;\t&quot;</span>+bookName+<span class="string">&quot;\t&quot;</span>+bookAuthor+<span class="string">&quot;\t&quot;</span>+bookPrice+<span class="string">&quot;\t&quot;</span>+bookStock+<span class="string">&quot;\t&quot;</span>+bookDesc);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭连接  结果集也需要关闭</span></span><br><span class="line">        <span class="keyword">if</span>(rs!=<span class="literal">null</span> &amp;&amp; !rs.isClosed())&#123;</span><br><span class="line">            rs.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-5-select操作（多条结果）"><a href="#4-5-select操作（多条结果）" class="headerlink" title="4.5 select操作（多条结果）"></a>4.5 select操作（多条结果）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSelectBooks</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//查询所有图书信息</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books&quot;</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">        <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookId</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            System.out.println(bookId+<span class="string">&quot;\t&quot;</span>+bookName+<span class="string">&quot;\t&quot;</span>+bookAuthor+<span class="string">&quot;\t&quot;</span>+bookPrice+<span class="string">&quot;\t&quot;</span>+bookStock+<span class="string">&quot;\t&quot;</span>+bookDesc);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(rs!=<span class="literal">null</span> &amp;&amp; !rs.isClosed())&#123;</span><br><span class="line">            rs.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="五、JDBC的核心类与接口"><a href="#五、JDBC的核心类与接口" class="headerlink" title="五、JDBC的核心类与接口"></a>五、JDBC的核心类与接口</h1><blockquote><p>java.sql.DriverManager类  驱动管理器</p><p>java.sql.Connection接口 数据库连接</p><p>java.sql.Statement接口 SQL指令的“加载&#x2F;执行器”</p><p>java.sql.ResultSet接口   结果集</p></blockquote><h2 id="5-1-DriverManager类"><a href="#5-1-DriverManager类" class="headerlink" title="5.1 DriverManager类"></a>5.1 DriverManager类</h2><blockquote><ul><li>注册驱动</li><li>创建数据库连接</li></ul></blockquote><ul><li><p>注册驱动</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在Driver类中的静态初始化块中，注册驱动：DriverManager.registerDriver(new Driver());</span></span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在我们的应用程序中手动注册驱动的代码也可以省略 【Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);】</span></span><br><span class="line"><span class="comment">// 如果我们没有手动注册驱动，驱动管理器在获取连接的时候发现没有注册驱动则读取 驱动jar/META-INF/servicesjava.sql.Driver文件中配置的驱动类路径进行注册</span></span><br></pre></td></tr></table></figure></li><li><p>获取连接</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// url  数据库服务器的地址</span></span><br><span class="line"><span class="comment">// username  数据库连接用户名</span></span><br><span class="line"><span class="comment">// password  数据库连接密码</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br></pre></td></tr></table></figure></li></ul><h2 id="5-2-Connection接口"><a href="#5-2-Connection接口" class="headerlink" title="5.2 Connection接口"></a>5.2 Connection接口</h2><blockquote><p>Connection对象表示Java应用程序与数据库之间的连接</p><ul><li>通过Connection接口对象，获取执行SQL语句的Statement对象</li><li>完成数据的事务管理</li></ul></blockquote><h3 id="5-2-1-获取Statement对象"><a href="#5-2-1-获取Statement对象" class="headerlink" title="5.2.1 获取Statement对象"></a>5.2.1 获取Statement对象</h3><ul><li><p>Statement接口: 编译执行静态SQL指令</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br></pre></td></tr></table></figure></li><li><p>PreparedStatement接口：继承了Statement接口，预编译动态SQL指令（解决SQL注入问题）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br></pre></td></tr></table></figure></li><li><p>CallableStatement接口：继承了PreparedStatement接口，可以调用存储过程</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CallableStatement</span> <span class="variable">callableStatement</span> <span class="operator">=</span> connection.prepareCall(sql);</span><br></pre></td></tr></table></figure></li></ul><h3 id="5-2-2-事务管理"><a href="#5-2-2-事务管理" class="headerlink" title="5.2.2 事务管理"></a>5.2.2 事务管理</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开启事务（关闭事务自动提交）</span></span><br><span class="line">connection.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//事务回滚</span></span><br><span class="line">connection.rollback();</span><br><span class="line"></span><br><span class="line"><span class="comment">//提交事务</span></span><br><span class="line">connection.commit();</span><br></pre></td></tr></table></figure><h2 id="5-3-Statement接口"><a href="#5-3-Statement接口" class="headerlink" title="5.3 Statement接口"></a>5.3 Statement接口</h2><blockquote><p>用于编译、执行SQL指令的</p></blockquote><p><img src="/../images/JDBC/image-20211018144851383.png" alt="image-20211018144851383"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行DML操作的SQL指令</span></span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行DQL操作的SQL指令</span></span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br></pre></td></tr></table></figure><h2 id="5-4-ResultSet接口"><a href="#5-4-ResultSet接口" class="headerlink" title="5.4 ResultSet接口"></a>5.4 ResultSet接口</h2><blockquote><p>ResultSet接口对象，表示查询操作返回的结果集，提供了便利的方法用于获取结果集中的数据</p></blockquote><ul><li><p>判断结果集中是否还有数据未取出</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(select_statement);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断rs中是否还有数据</span></span><br><span class="line">rs.next();</span><br></pre></td></tr></table></figure></li><li><p>获取rs指向的结果集中某行的数据</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(String columnLable);  <span class="comment">//获取rs指向的行的  列 数据（字段名）</span></span><br><span class="line"><span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="type">int</span> columnIndex);</span><br><span class="line"></span><br><span class="line">rs.getString(<span class="string">&quot;&quot;</span>); <span class="comment">//获取String类型数据</span></span><br><span class="line">rs.getDouble(<span class="string">&quot;&quot;</span>); <span class="comment">//获取Double类型数据</span></span><br><span class="line">....</span><br><span class="line">rs.getDate(<span class="string">&quot;&quot;</span>); <span class="comment">//获取日期类型数据</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="六、SQL注入问题"><a href="#六、SQL注入问题" class="headerlink" title="六、SQL注入问题"></a>六、SQL注入问题</h1><h2 id="6-1-什么是SQL注入问题？"><a href="#6-1-什么是SQL注入问题？" class="headerlink" title="6.1 什么是SQL注入问题？"></a>6.1 什么是SQL注入问题？</h2><blockquote><p>在JDBC操作SQL指令编写过程中，如果SQL指令中需要数据，我们可以通过字符串拼接的形式将参数拼接到SQL指令中，如<code>String sql = &quot;delete from books where book_id=&quot;+s;</code>(s就是拼接到SQL中的变量)</p><p>使用字符串拼接变量的形式来设置SQL语句中的数据，可能会导致<code>因变量值的改变引起SQL指令的原意发生改变</code>，这就被称为SQL注入。SQL注入问题是需要避免的。</p><p>例如：</p><ul><li>如果s的值为<code>1</code>，SQL指令 ： delete from books where book_id&#x3D;1</li><li>如果s的值为<code>1 or 1=1</code>，SQL指令：delete from books where book_id&#x3D;1 or 1&#x3D;1</li></ul></blockquote><h2 id="6-2-如何解决SQL注入问题？"><a href="#6-2-如何解决SQL注入问题？" class="headerlink" title="6.2 如何解决SQL注入问题？"></a>6.2 如何解决SQL注入问题？</h2><blockquote><p>使用PreparedStatement进行SQL预编译解决SQL注入问题：</p><ul><li><p>在编写SQL指令时，如果SQL指令中需要参数，一律使用<code>?</code>参数占位符</p></li><li><p>如果SQL指令中有<code>?</code>，在JDBC操作步骤中不再使用Statement，而是从Conection对象获取PreparedStatement对SQL指令进行预编译 <code>PreparedStatement preparedStatement = connection.prepareStatement(sql);</code></p></li><li><p>预编译完成之后，通过PreparedStatement对象给预编译后的SQL指令的<code>?</code>复制</p><ul><li>prepareadStatement.setInt(参数占位符序号,值);</li><li>prepareadStatement.setString(参数占位符序号,值);</li></ul></li><li><p>SQL指令中的所有<code>?</code>完成赋值之后，通过PreparedStatement执行SQL<strong>执行SQL时不再加载SQL</strong></p><ul><li>int i &#x3D; prepareadStatement.executeUpdate();</li><li>ResultSet rs &#x3D; preparedStatement.executeQuery();</li></ul></li></ul></blockquote><h2 id="6-3-使用PreparedStatement预编译案例"><a href="#6-3-使用PreparedStatement预编译案例" class="headerlink" title="6.3 使用PreparedStatement预编译案例"></a>6.3 使用PreparedStatement预编译案例</h2><ul><li>删除操作</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysql.cj.jdbc.Driver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestDeleteBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入你要删除的图书的ID：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">        <span class="type">int</span> <span class="variable">bid</span> <span class="operator">=</span> Integer.parseInt(s);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.注册驱动</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="comment">//2.创建连接</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="comment">//3.编写SQL:SQL指令中的参数使用?表示</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="comment">//4.如果SQL指令有参数占位符?,则从Connection获取PreparedStatement预编译SQL指令</span></span><br><span class="line">        <span class="comment">//  预编译：在SQL指令中的参数赋值之前对SQL执行的语法结构进行编译</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//  SQL指令预编译之后，给SQL中的?赋值</span></span><br><span class="line">        preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">        <span class="comment">//5.执行SQL</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">        <span class="comment">//6.处理结果</span></span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;删除成功&quot;</span>:<span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">        <span class="comment">//7.关闭连接</span></span><br><span class="line">        <span class="keyword">if</span>(preparedStatement!=<span class="literal">null</span> &amp;&amp; !preparedStatement.isClosed())&#123;</span><br><span class="line">            preparedStatement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>修改操作</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestInsertBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;Java进阶之路&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> <span class="string">&quot;老王&quot;</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> <span class="number">22.22</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> <span class="string">&quot;这本书很好&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.注册驱动</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.创建连接</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.编写要执行的SQL指令:SQL指令中所需的参数一律使用?</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.SQL中有? 使用PreparedStatement预编译SQL</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 给SQL指令中的?复制</span></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>,name);</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>,author);</span><br><span class="line">        preparedStatement.setDouble(<span class="number">3</span>,price);</span><br><span class="line">        preparedStatement.setInt(<span class="number">4</span>,stock);</span><br><span class="line">        preparedStatement.setString(<span class="number">5</span>,desc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.执行SQL获取执行结果</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate(); </span><br><span class="line"></span><br><span class="line">        <span class="comment">//6.处理结果（业务）</span></span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;添加成功&quot;</span>:<span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//7.关闭连接</span></span><br><span class="line">        <span class="keyword">if</span>(preparedStatement != <span class="literal">null</span> &amp;&amp; !preparedStatement.isClosed())&#123;</span><br><span class="line">            preparedStatement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection !=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>练习1：修改操作</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUpdateBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="comment">// 根据数据记录的主键 修改其他的字段</span></span><br><span class="line">        <span class="comment">// 根据图书ID，修改图书名称、作者、价格、库存、描述</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> <span class="number">1011</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;Java进阶之路&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> <span class="string">&quot;亮亮&quot;</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> <span class="number">36.80</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> <span class="number">8</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> <span class="string">&quot;这本书非常好&quot;</span>;</span><br><span class="line"></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="comment">//1.</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">        <span class="comment">//2.</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//3.</span></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>,name);</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>,author);</span><br><span class="line">        preparedStatement.setDouble(<span class="number">3</span>,price);</span><br><span class="line">        preparedStatement.setInt(<span class="number">4</span>,stock);</span><br><span class="line">        preparedStatement.setString(<span class="number">5</span>,desc);</span><br><span class="line">        <span class="comment">//4.</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;修改成功&quot;</span>:<span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">        <span class="comment">//5.</span></span><br><span class="line">        <span class="keyword">if</span>(preparedStatement!=<span class="literal">null</span> &amp;&amp; !preparedStatement.isClosed())&#123;</span><br><span class="line">            preparedStatement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>练习2：根据ID查询图书信息</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">package com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line">import java.sql.<span class="operator">*</span>;</span><br><span class="line"></span><br><span class="line">public class TestSelectBook &#123;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">static</span> void main(String[] args) throws ClassNotFoundException, <span class="keyword">SQLException</span> &#123;</span><br><span class="line">        <span class="operator">/</span><span class="operator">/</span>根据图书ID，查询一本图书信息</span><br><span class="line">        <span class="type">int</span> bid <span class="operator">=</span> <span class="number">1013</span>;</span><br><span class="line">        Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><span class="line">        String url <span class="operator">=</span> &quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;;</span><br><span class="line">        Connection connection <span class="operator">=</span> DriverManager.getConnection(url, &quot;root&quot;, &quot;@QFedu123&quot;);</span><br><span class="line">        String <span class="keyword">sql</span> <span class="operator">=</span> &quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;;</span><br><span class="line">        PreparedStatement preparedStatement <span class="operator">=</span> connection.prepareStatement(<span class="keyword">sql</span>);</span><br><span class="line">        preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">        <span class="operator">/</span><span class="operator">/</span>通过executeQuery方法执行查询语句，并且将查询的结果存放到一个ResultSet对象中（结果集）</span><br><span class="line">        ResultSet rs <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line">        <span class="operator">/</span><span class="operator">/</span>处理结果：从rs中获取查询结果</span><br><span class="line">        if(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> bookId <span class="operator">=</span> rs.getInt(&quot;book_id&quot;);</span><br><span class="line">            String bookName <span class="operator">=</span> rs.getString(&quot;book_name&quot;);</span><br><span class="line">            String bookAuthor <span class="operator">=</span> rs.getString(&quot;book_author&quot;);</span><br><span class="line">            <span class="keyword">double</span> bookPrice <span class="operator">=</span> rs.getDouble(&quot;book_price&quot;);</span><br><span class="line">            <span class="type">int</span> bookStock <span class="operator">=</span> rs.getInt(&quot;book_stock&quot;);</span><br><span class="line">            String bookDesc <span class="operator">=</span> rs.getString(&quot;book_desc&quot;);</span><br><span class="line">            System.out.println(bookId<span class="operator">+</span>&quot;\t&quot;<span class="operator">+</span>bookName<span class="operator">+</span>&quot;\t&quot;<span class="operator">+</span>bookAuthor<span class="operator">+</span>&quot;\t&quot;<span class="operator">+</span>bookPrice<span class="operator">+</span>&quot;\t&quot;<span class="operator">+</span>bookStock<span class="operator">+</span>&quot;\t&quot;<span class="operator">+</span>bookDesc);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="operator">/</span><span class="operator">/</span>关闭连接  结果集也需要关闭</span><br><span class="line">        if(rs<span class="operator">!=</span><span class="keyword">null</span> <span class="operator">&amp;&amp;</span> <span class="operator">!</span>rs.isClosed())&#123;</span><br><span class="line">            rs.close();</span><br><span class="line">        &#125;</span><br><span class="line">        if(preparedStatement<span class="operator">!=</span><span class="keyword">null</span> <span class="operator">&amp;&amp;</span> <span class="operator">!</span>preparedStatement.isClosed())&#123;</span><br><span class="line">            preparedStatement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        if(connection<span class="operator">!=</span><span class="keyword">null</span> <span class="operator">&amp;&amp;</span> <span class="operator">!</span>connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><code>备注</code></strong> 如果SQL指令中需要参数，则使用PreparedStatement进行SQL预编译，如果SQL指令中没有参数建议使用Statement（Statement执行效率要高于PreparedStatement）。</p><h1 id="七、工具类封装"><a href="#七、工具类封装" class="headerlink" title="七、工具类封装"></a>七、工具类封装</h1><h2 id="7-1-代码的复用性"><a href="#7-1-代码的复用性" class="headerlink" title="7.1 代码的复用性"></a>7.1 代码的复用性</h2><p>在我们的应用程序中，如果需要完成相同的操作，相同的代码无需重复编写，我们只需一次编写多次调用即可！</p><blockquote><p>JDBC数据库编程是由一个固定的步骤：</p><ol><li>注册驱动</li><li>创建连接</li><li>编写SQL</li><li>获取Statement对象</li><li>执行SQL</li><li>处理结果</li><li>关闭连接</li></ol></blockquote><h2 id="7-2-工具类封装"><a href="#7-2-工具类封装" class="headerlink" title="7.2 工具类封装"></a>7.2 工具类封装</h2><blockquote><p>DBManager</p><p>DBUtil</p><p>JDBCUtil</p><p>DBHelper</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DBHelper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*将创建数据库连接所需的字符串定义为常量，集中管理*/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DRIVER</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">URL</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USERNAME</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;@QFedu123&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册驱动只需执行一次，因此我们放在帮助类的静态初始化块中完成</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(DRIVER);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----------注册驱动失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建数据库连接对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DriverManager.getConnection(URL, USERNAME, PASSWORD);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----------创建连接失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭连接</span></span><br><span class="line"><span class="comment">     * 多态的应用：使用Statement接口做参数，既可以传递Statement接口对象，</span></span><br><span class="line"><span class="comment">     * 也可以传递PreparedStatement接口对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Statement statement, Connection connection)</span>&#123;</span><br><span class="line">        close(<span class="literal">null</span>,statement,connection);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭连接</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(ResultSet resultSet,Statement statement, Connection connection)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(resultSet!=<span class="literal">null</span> &amp;&amp; !resultSet.isClosed())&#123;</span><br><span class="line">                resultSet.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;~~~~~关闭数据库连接失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="八、DAO与DTO的封装"><a href="#八、DAO与DTO的封装" class="headerlink" title="八、DAO与DTO的封装"></a>八、DAO与DTO的封装</h1><blockquote><p>DAO  Data Access Object 数据访问对象</p><p>DTO Data Transfer Object 数据传输对象（实体类）  用于传输DML操作参数及DQL的查询结果</p></blockquote><h2 id="8-1-CRUD方法的封装"><a href="#8-1-CRUD方法的封装" class="headerlink" title="8.1 CRUD方法的封装"></a>8.1 CRUD方法的封装</h2><blockquote><p>面向对象的特征之一——封装</p><p>我们将能够完成某个CRUD操作的代码单独定义成一个方法，当需要完成此CRUD操作时调用这个方法即可;</p></blockquote><ul><li>insert操作封装</li><li>delete操作封装</li><li>update操作封装</li></ul><h2 id="8-2-DTO实体类封装"><a href="#8-2-DTO实体类封装" class="headerlink" title="8.2 DTO实体类封装"></a>8.2 DTO实体类封装</h2><blockquote><p>问题：在封装CRUD方法时，对于查询操作而言，需要将查询到的数据库记录返回给调用者，但是一个查询方法只能返回一个值，而一条数据库记录有多个值，如何将一条数据库记录的多个值返回呢？</p></blockquote><blockquote><p>处理：在Java程序中创建一个属性与数据库表匹配的类，通过此类的对象封装查询到的数据，我们把用于传递JDBC增删查改操作的数据的对象称之为<code>数据传输对象</code>——DTO(实体类：带有属性，其对象可以存放数据的类)</p></blockquote><p>实体类创建规则：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 1.类中属性的个数和类型，与对应的数据表保持一致</span><br><span class="line">* 2.提供所有属性的get和set方法：Alt+Insert --- Getter And Setter --- 选择所有属性 --- OK</span><br><span class="line">* 3.提供全参构造器：Alt+Insert --- Constructor --- 选择所有属性 --- OK</span><br><span class="line">* 4.提供无参构造器：Alt+Insert --- Constructor --- SelectNone</span><br><span class="line">* 5.重写toString方法：Alt+Insert --- toString --- OK</span><br><span class="line">* 6.[暂略] 重写hashcode和equals</span><br><span class="line">* 7.[暂略]实现序列化Serializable接口</span><br></pre></td></tr></table></figure><p>实体类实例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookId;</span><br><span class="line">    <span class="keyword">private</span> String bookName;</span><br><span class="line">    <span class="keyword">private</span> String bookAuthor;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> bookPrice;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookStock;</span><br><span class="line">    <span class="keyword">private</span> String bookDesc;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Book&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;bookId=&quot;</span> + bookId +</span><br><span class="line">                <span class="string">&quot;, bookName=&#x27;&quot;</span> + bookName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, bookAuthor=&#x27;&quot;</span> + bookAuthor + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, bookPrice=&quot;</span> + bookPrice +</span><br><span class="line">                <span class="string">&quot;, bookStock=&quot;</span> + bookStock +</span><br><span class="line">                <span class="string">&quot;, bookDesc=&#x27;&quot;</span> + bookDesc + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Book</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Book</span><span class="params">(<span class="type">int</span> bookId, String bookName, String bookAuthor, <span class="type">double</span> bookPrice, <span class="type">int</span> bookStock, String bookDesc)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bookId = bookId;</span><br><span class="line">        <span class="built_in">this</span>.bookName = bookName;</span><br><span class="line">        <span class="built_in">this</span>.bookAuthor = bookAuthor;</span><br><span class="line">        <span class="built_in">this</span>.bookPrice = bookPrice;</span><br><span class="line">        <span class="built_in">this</span>.bookStock = bookStock;</span><br><span class="line">        <span class="built_in">this</span>.bookDesc = bookDesc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//get和set方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用实体类封装查询操作返回的结果：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 根据图书ID查询一条图书记录</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> Book <span class="title function_">queryBook</span><span class="params">(<span class="type">int</span> bid)</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">    <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">    preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">    <span class="comment">//通过executeQuery方法执行查询语句，并且将查询的结果存放到一个ResultSet对象中（结果集）</span></span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line">    <span class="comment">//处理结果：从rs中获取查询结果</span></span><br><span class="line">    <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">        <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">        <span class="comment">//我们需要将查询到的一条数据库图书记录的6个值返回</span></span><br><span class="line">        book = <span class="keyword">new</span> <span class="title class_">Book</span>(id,name,author,price,stock,desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//关闭连接  结果集也需要关闭</span></span><br><span class="line">    DBHelper.close(rs,preparedStatement,connection);</span><br><span class="line">    <span class="keyword">return</span> book;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-3-实体类封装查询结果"><a href="#8-3-实体类封装查询结果" class="headerlink" title="8.3 实体类封装查询结果"></a>8.3 实体类封装查询结果</h2><blockquote><p>查询的每条结果分别存放到一个DTO对象中，再将多个DTO对象存放到一个List集合中，返回这个List集合</p></blockquote><p><img src="/../images/JDBC/image-20211019105351846.png" alt="image-20211019105351846"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dto.Book;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSelectBooks</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Book&gt; list = <span class="keyword">new</span> <span class="title class_">TestSelectBooks</span>().listBooks();</span><br><span class="line">        <span class="keyword">for</span>(Book b:list)&#123;</span><br><span class="line">            System.out.println(b.getBookName()+<span class="string">&quot;\t&quot;</span>+b.getBookAuthor());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listBooks</span><span class="params">()</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        List&lt;Book&gt; bookList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//查询所有图书信息</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books&quot;</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">        <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookId</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>(bookId, bookName, bookAuthor, bookPrice, bookStock, bookDesc);</span><br><span class="line">            bookList.add(book);</span><br><span class="line">        &#125;</span><br><span class="line">        DBHelper.close(rs,statement,connection);</span><br><span class="line">        <span class="keyword">return</span> bookList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-4-实体类传递添加、修改操作参数"><a href="#8-4-实体类传递添加、修改操作参数" class="headerlink" title="8.4 实体类传递添加、修改操作参数"></a>8.4 实体类传递添加、修改操作参数</h2><blockquote><p>在JDBC的添加、修改等方法中需要多个数据，我们可以通过实体类来进行参数传递</p></blockquote><h3 id="8-4-1-添加操作"><a href="#8-4-1-添加操作" class="headerlink" title="8.4.1 添加操作"></a>8.4.1 添加操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insertBook</span><span class="params">(Book book)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">//调用工具类，获取数据库连接对象</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">    preparedStatement.setString(<span class="number">1</span>,book.getBookName());</span><br><span class="line">    preparedStatement.setString(<span class="number">2</span>,book.getBookAuthor());</span><br><span class="line">    preparedStatement.setDouble(<span class="number">3</span>,book.getBookPrice());</span><br><span class="line">    preparedStatement.setInt(<span class="number">4</span>,book.getBookStock());</span><br><span class="line">    preparedStatement.setString(<span class="number">5</span>,book.getBookDesc());</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();  </span><br><span class="line">    flag = i&gt;<span class="number">0</span>;</span><br><span class="line">    <span class="comment">//关闭连接</span></span><br><span class="line">    DBHelper.close(preparedStatement,connection);</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-4-2-修改操作"><a href="#8-4-2-修改操作" class="headerlink" title="8.4.2 修改操作"></a>8.4.2 修改操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateBook</span><span class="params">(Book book)</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">    preparedStatement.setString(<span class="number">1</span>,book.getBookName());</span><br><span class="line">    preparedStatement.setString(<span class="number">2</span>,book.getBookAuthor());</span><br><span class="line">    preparedStatement.setDouble(<span class="number">3</span>,book.getBookPrice());</span><br><span class="line">    preparedStatement.setInt(<span class="number">4</span>,book.getBookStock());</span><br><span class="line">    preparedStatement.setString(<span class="number">5</span>,book.getBookDesc());</span><br><span class="line">    preparedStatement.setInt(<span class="number">6</span>,book.getBookId());</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">    flag = i&gt;<span class="number">0</span>;</span><br><span class="line">    DBHelper.close(preparedStatement,connection);</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-5-DAO类封装"><a href="#8-5-DAO类封装" class="headerlink" title="8.5 DAO类封装"></a>8.5 DAO类封装</h2><blockquote><p>DAO封装：将对数据库中同一张数据表的JDBC操作方法封装到同一个Java类中，这个类就是访问此数据表的<code>数据访问对象</code></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteBook</span><span class="params">(<span class="type">int</span> bid)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//使用JDBC，根据图书编号删除图书信息</span></span><br><span class="line">        <span class="comment">//1.注册驱动 创建连接</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="comment">//3.编写SQL</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="comment">//4.如果SQL指令有参数占位符?,则从Connection获取PreparedStatement预编译SQL指令</span></span><br><span class="line">        <span class="comment">//  预编译：在SQL指令中的参数赋值之前对SQL执行的语法结构进行编译</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//  SQL指令预编译之后，给SQL中的?赋值</span></span><br><span class="line">        preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">        <span class="comment">//5.执行SQL</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">        <span class="comment">//6.处理结果</span></span><br><span class="line">        flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//7.关闭连接</span></span><br><span class="line">        DBHelper.close(preparedStatement,connection);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加图书</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果添加成功返回true，如果添加失败则返回false</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insertBook</span><span class="params">(Book book)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//调用工具类，获取数据库连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>,book.getBookName());</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>,book.getBookAuthor());</span><br><span class="line">        preparedStatement.setDouble(<span class="number">3</span>,book.getBookPrice());</span><br><span class="line">        preparedStatement.setInt(<span class="number">4</span>,book.getBookStock());</span><br><span class="line">        preparedStatement.setString(<span class="number">5</span>,book.getBookDesc());</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();  <span class="comment">// 如果i&gt;0，表示DML操作是成功的；如果i=0表示DML操作对数据表中的数据没有影响</span></span><br><span class="line">        flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//关闭连接</span></span><br><span class="line">        DBHelper.close(preparedStatement,connection);</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据图书ID查询一条图书记录</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">queryBook</span><span class="params">(<span class="type">int</span> bid)</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">        <span class="comment">//通过executeQuery方法执行查询语句，并且将查询的结果存放到一个ResultSet对象中（结果集）</span></span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line">        <span class="comment">//处理结果：从rs中获取查询结果</span></span><br><span class="line">        <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            <span class="comment">//我们需要将查询到的一条数据库图书记录的6个值返回</span></span><br><span class="line">            book = <span class="keyword">new</span> <span class="title class_">Book</span>(id,name,author,price,stock,desc);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭连接  结果集也需要关闭</span></span><br><span class="line">        DBHelper.close(rs,preparedStatement,connection);</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listBooks</span><span class="params">()</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        List&lt;Book&gt; bookList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//查询所有图书信息</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books&quot;</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">        <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookId</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>(bookId, bookName, bookAuthor, bookPrice, bookStock, bookDesc);</span><br><span class="line">            bookList.add(book);</span><br><span class="line">        &#125;</span><br><span class="line">        DBHelper.close(rs,statement,connection);</span><br><span class="line">        <span class="keyword">return</span> bookList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateBook</span><span class="params">(Book book)</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>,book.getBookName());</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>,book.getBookAuthor());</span><br><span class="line">        preparedStatement.setDouble(<span class="number">3</span>,book.getBookPrice());</span><br><span class="line">        preparedStatement.setInt(<span class="number">4</span>,book.getBookStock());</span><br><span class="line">        preparedStatement.setString(<span class="number">5</span>,book.getBookDesc());</span><br><span class="line">        preparedStatement.setInt(<span class="number">6</span>,book.getBookId());</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">        flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        DBHelper.close(preparedStatement,connection);</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-6-DAO类代码优化"><a href="#8-6-DAO类代码优化" class="headerlink" title="8.6 DAO类代码优化"></a>8.6 DAO类代码优化</h2><blockquote><p>1.在应用程序开发中，如果方法中抛出异常且自己可以处理，则直接通过try&#x2F;catch进行捕获处理；</p><p>2.JDBC操作方法的连接需要放在finally中进行关闭；</p><p>3.将数据库连接Connection、Statement、ResultSet等需要关闭的数据库对象定义在try之前;</p><p>4.因为所有的JDBC操作都需要Conection、Statement对象，查询方法都需要ResultSet对象，因此在DAO中可以将这些对象定义成类的成员变量</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dto.Book;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Connection connection;</span><br><span class="line">    <span class="keyword">private</span> Statement statement;</span><br><span class="line">    <span class="keyword">private</span> PreparedStatement preparedStatement;</span><br><span class="line">    <span class="keyword">private</span> ResultSet rs;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteBook</span><span class="params">(<span class="type">int</span> bid)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            connection = DBHelper.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insertBook</span><span class="params">(Book book)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//调用工具类，获取数据库连接对象</span></span><br><span class="line">            connection = DBHelper.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,book.getBookName());</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>,book.getBookAuthor());</span><br><span class="line">            preparedStatement.setDouble(<span class="number">3</span>,book.getBookPrice());</span><br><span class="line">            preparedStatement.setInt(<span class="number">4</span>,book.getBookStock());</span><br><span class="line">            preparedStatement.setString(<span class="number">5</span>,book.getBookDesc());</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();  <span class="comment">// 如果i&gt;0，表示DML操作是成功的；如果i=0表示DML操作对数据表中的数据没有影响</span></span><br><span class="line">            flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">queryBook</span><span class="params">(<span class="type">int</span> bid)</span> &#123;</span><br><span class="line">        <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DBHelper.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setInt(<span class="number">1</span>, bid);</span><br><span class="line">            <span class="comment">//通过executeQuery方法执行查询语句，并且将查询的结果存放到一个ResultSet对象中（结果集）</span></span><br><span class="line">            rs = preparedStatement.executeQuery();</span><br><span class="line">            <span class="comment">//处理结果：从rs中获取查询结果</span></span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">                <span class="comment">//我们需要将查询到的一条数据库图书记录的6个值返回</span></span><br><span class="line">                book = <span class="keyword">new</span> <span class="title class_">Book</span>(id, name, author, price, stock, desc);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(rs, preparedStatement, connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listBooks</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;Book&gt; bookList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DBHelper.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books&quot;</span>;</span><br><span class="line">            statement = connection.createStatement();</span><br><span class="line">            rs = statement.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">bookId</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">                <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>(bookId, bookName, bookAuthor, bookPrice, bookStock, bookDesc);</span><br><span class="line">                bookList.add(book);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(rs, statement, connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bookList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateBook</span><span class="params">(Book book)</span>  &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DBHelper.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>, book.getBookName());</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>, book.getBookAuthor());</span><br><span class="line">            preparedStatement.setDouble(<span class="number">3</span>, book.getBookPrice());</span><br><span class="line">            preparedStatement.setInt(<span class="number">4</span>, book.getBookStock());</span><br><span class="line">            preparedStatement.setString(<span class="number">5</span>, book.getBookDesc());</span><br><span class="line">            preparedStatement.setInt(<span class="number">6</span>, book.getBookId());</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            flag = i &gt; <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement, connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="九、JDBC综合案例"><a href="#九、JDBC综合案例" class="headerlink" title="九、JDBC综合案例"></a>九、JDBC综合案例</h1><blockquote><p>完成学生信息的CRUD操作</p></blockquote><h2 id="9-1-JDBC数据库编程的流程"><a href="#9-1-JDBC数据库编程的流程" class="headerlink" title="9.1 JDBC数据库编程的流程"></a>9.1 JDBC数据库编程的流程</h2><ul><li><p>创建数据库、数据表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> students(</span><br><span class="line">stu_num <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">primary key</span>,</span><br><span class="line">stu_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not null</span>,</span><br><span class="line">stu_gender <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not null</span>,</span><br><span class="line">stu_age <span class="type">int</span> <span class="keyword">not null</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p>创建新的Java工程</p></li><li><p>创建JDBC的工具类：DBHelper</p></li><li><p>创建DTO类（用于封装参数及查询结果）</p></li><li><p>创建DAO类（用于完成CRUD操作）</p></li></ul><h2 id="9-2-创建JDBC工具类"><a href="#9-2-创建JDBC工具类" class="headerlink" title="9.2 创建JDBC工具类"></a>9.2 创建JDBC工具类</h2><ul><li>在Java工程中创建package :<code>com.qfedu.jdbc.utils</code></li><li>在<code>com.qfedu.jdbc.utils</code>包中创建工具类<code>DBHelper</code></li><li>编写<code>DBHelper</code>工具类：<ul><li>添加驱动jar文件</li><li>编写DBHelper代码</li></ul></li></ul><h2 id="9-3-创建DTO类"><a href="#9-3-创建DTO类" class="headerlink" title="9.3 创建DTO类"></a>9.3 创建DTO类</h2><ul><li><p>在Java工程中创建package：<code>com.qfedu.jdbc.dto</code></p></li><li><p>在<code>com.qfedu.jdbc.dto</code>创建数据表对应的实体类<code>Student</code></p></li><li><p>编写实体类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String stuNum;</span><br><span class="line">    <span class="keyword">private</span> String stuName;</span><br><span class="line">    <span class="keyword">private</span> String stuGender;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> stuAge;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;stuNum=&#x27;&quot;</span> + stuNum + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, stuName=&#x27;&quot;</span> + stuName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, stuGender=&#x27;&quot;</span> + stuGender + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, stuAge=&quot;</span> + stuAge +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String stuNum, String stuName, String stuGender, <span class="type">int</span> stuAge)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.stuNum = stuNum;</span><br><span class="line">        <span class="built_in">this</span>.stuName = stuName;</span><br><span class="line">        <span class="built_in">this</span>.stuGender = stuGender;</span><br><span class="line">        <span class="built_in">this</span>.stuAge = stuAge;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//get  set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="9-4-创建DAO类"><a href="#9-4-创建DAO类" class="headerlink" title="9.4 创建DAO类"></a>9.4 创建DAO类</h2><blockquote><p>创建DAO类，完成JDBC操作</p></blockquote><ul><li>在Java项目中创建package:<code>com.qfedu.jdbc.dao</code></li><li>在<code>com.qfedu.jdbc.dao</code>包中创建类<code>StudentDAO</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dto.Student;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Connection connection;</span><br><span class="line">    <span class="keyword">private</span> Statement statement;</span><br><span class="line">    <span class="keyword">private</span> PreparedStatement preparedStatement;</span><br><span class="line">    <span class="keyword">private</span> ResultSet resultSet;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1、添加学生信息</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insert</span><span class="params">(Student student)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into students(stu_num,stu_name,stu_gender,stu_age) values(?,?,?,?)&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,student.getStuNum());</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>,student.getStuName());</span><br><span class="line">            preparedStatement.setString(<span class="number">3</span>,student.getStuGender());</span><br><span class="line">            preparedStatement.setInt(<span class="number">4</span>,student.getStuAge());</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//2、根据学号查询一个学生记录</span></span><br><span class="line">    <span class="keyword">public</span> Student <span class="title function_">queryStudent</span><span class="params">(String snum)</span>&#123;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select stu_num,stu_name,stu_gender,stu_age from students where stu_num=?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,snum);</span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line">            <span class="keyword">if</span>(resultSet.next())&#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuNum</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_num&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuGender</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_gender&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">stuAge</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;stu_age&quot;</span>);</span><br><span class="line">                student = <span class="keyword">new</span> <span class="title class_">Student</span>(stuNum,stuName,stuGender,stuAge);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(resultSet,preparedStatement,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> student;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//3、查询多个学生信息</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Student&gt; <span class="title function_">listStudents</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;Student&gt; studentList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select stu_num,stu_name,stu_gender,stu_age from students&quot;</span>;</span><br><span class="line">            statement = connection.createStatement();</span><br><span class="line">            resultSet = statement.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span>(resultSet.next())&#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuNum</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_num&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuGender</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_gender&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">stuAge</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;stu_age&quot;</span>);</span><br><span class="line">                <span class="type">Student</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(stuNum,stuName,stuGender,stuAge);</span><br><span class="line">                studentList.add(s);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(resultSet,statement,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> studentList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="9-5-测试DAO类中的方法"><a href="#9-5-测试DAO类中的方法" class="headerlink" title="9.5 测试DAO类中的方法"></a>9.5 测试DAO类中的方法</h2><blockquote><p>使用junit对DAO中创建的JDBC方法进行单元测试</p></blockquote><h3 id="9-5-1-下载导入junit依赖到项目中"><a href="#9-5-1-下载导入junit依赖到项目中" class="headerlink" title="9.5.1 下载导入junit依赖到项目中"></a>9.5.1 下载导入junit依赖到项目中</h3><ul><li><p>下载：<a href="https://mvnrepository.com/">https://mvnrepository.com/</a>     （如果使用junit 4.10 + 版本单元测试，需要以下两个jar文件）</p><ul><li>junit-4.12.jar</li><li>hamcrest-core-1.3.jar</li></ul></li><li><p>将<code>junit-4.12.jar</code>、<code>hamcrest-core-1.3.jar</code>拷贝项目的<code>lib</code>文件夹</p></li><li><p>选择拷贝到项目中的jar文件—右键—Add as Library</p></li></ul><h3 id="9-5-2-创建单元测试类"><a href="#9-5-2-创建单元测试类" class="headerlink" title="9.5.2 创建单元测试类"></a>9.5.2 创建单元测试类</h3><blockquote><p>如果我们需要对某个类中的方法进行单元测试，我们需要创建这个类的测试类</p><p>StudentDAO ———&gt; StudentDAOTest（测试类：类名&#x3D;被测试类+Test）</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dao.StudentDAO;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dto.Student;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Descript</span> 此类是StudentDAO的单元测试类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> 千锋涛哥</span></span><br><span class="line"><span class="comment"> * 公众号： Java架构栈</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentDAOTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.在测试类中定义成员变量：创建被测试类的对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">StudentDAO</span> <span class="variable">studentDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StudentDAO</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2创建测试方法 ： 用来测试StudentDAO类中的insertStudent方法</span></span><br><span class="line">    <span class="comment">//a.测试方法名=test+被测试方法名</span></span><br><span class="line">    <span class="comment">//b.测试方法无参数无返回值</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testInsertStudent</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//准备被测试方法所需的参数</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;1008&quot;</span>,<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;男&quot;</span>,<span class="number">20</span>);</span><br><span class="line">        <span class="comment">//调用被测试方法，获取结果</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> studentDAO.insertStudent(stu);</span><br><span class="line">        <span class="comment">//断言返回结果(成立 | 不成立)</span></span><br><span class="line">        assertTrue(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testQueryStudent</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">snum</span> <span class="operator">=</span> <span class="string">&quot;1008&quot;</span>;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> studentDAO.queryStudent(snum);</span><br><span class="line">        assertEquals(<span class="string">&quot;Tom2&quot;</span>,student.getStuName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testListStudents</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;Student&gt; studentList = studentDAO.listStudents();</span><br><span class="line">        assertEquals(<span class="number">8</span>,studentList.size());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="十、JDBC事务管理"><a href="#十、JDBC事务管理" class="headerlink" title="十、JDBC事务管理"></a>十、JDBC事务管理</h1><blockquote><ul><li>什么是事务？</li><li>事务的四大特性—ACID</li><li>事务的隔离级别</li><li>MySQL事务管理：<ul><li>start transaction</li><li>rollback</li><li>commit</li></ul></li></ul></blockquote><h2 id="10-1-JDBC实现借书操作"><a href="#10-1-JDBC实现借书操作" class="headerlink" title="10.1 JDBC实现借书操作"></a>10.1 JDBC实现借书操作</h2><blockquote><ol><li>向<code>records</code>表添加借书记录</li><li>修改<code>books</code>表中的库存</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 借书：</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> stuNum 借书的学生学号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bookId 借书的图书编号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> num   借书的数量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">borrowBook2</span><span class="params">(String stuNum,<span class="type">int</span> bookId,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//1.向`records`表添加借书记录</span></span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;insert into records(snum,bid,borrow_num,is_return,borrow_date) values(?,?,?,0,sysdate())&quot;</span>;</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql1);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,stuNum);</span><br><span class="line">            preparedStatement.setInt(<span class="number">2</span>,bookId);</span><br><span class="line">            preparedStatement.setInt(<span class="number">3</span>,num);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">10</span>/<span class="number">0</span>;  <span class="comment">//造异常：算术异常</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//2.修改`books`表中的库存</span></span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection2</span> <span class="operator">=</span> DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;update books set book_stock=book_stock-? where book_id=?&quot;</span>;</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">preparedStatement2</span> <span class="operator">=</span> connection2.prepareStatement(sql2);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">1</span>,num);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">2</span>,bookId);</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> preparedStatement2.executeUpdate();</span><br><span class="line">            flag = i&gt;<span class="number">0</span> &amp;&amp; j&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 关闭连接</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>分析：</p><ul><li>借书业务由两个数据库操作完成，这两个操作要么同时成功，要么同时失败，构成一个数据库事务；</li><li>JDBC的DML操作默认是自定提交的，因此当第一个DML操作（添加借书记录）完成后，无论第二个操作（修改库存）是否成功，借书记录都会添加到数据库，而且是永久的</li><li>JDBC中该如何做事务管理呢？</li></ul><h2 id="10-2-JDBC事务管理"><a href="#10-2-JDBC事务管理" class="headerlink" title="10.2 JDBC事务管理"></a>10.2 JDBC事务管理</h2><blockquote><ol><li>一个事务中的多个DML操作需要基于同一个数据库连接；</li><li>创建连接之后，设置事务手动提交（关闭自动提交）；<code>connection.setAutoCommit(false);</code></li><li>当当前事务中的所有DML操作完成之后手动提交；<code>connection.commit();</code></li><li>当事务中的任何一个步骤出现异常，在catch代码块中执行事务回滚。<code>connection.rollback();</code></li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 借书：</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> stuNum 借书的学生学号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bookId 借书的图书编号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> num   借书的数量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">borrowBook</span><span class="params">(String stuNum,<span class="type">int</span> bookId,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="comment">//设置使用当前Connection连接操作数据库自动提交关闭</span></span><br><span class="line">            connection.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//1.向`records`表添加借书记录</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;insert into records(snum,bid,borrow_num,is_return,borrow_date) values(?,?,?,0,sysdate())&quot;</span>;</span><br><span class="line">            preparedStatement1 = connection.prepareStatement(sql1);</span><br><span class="line">            preparedStatement1.setString(<span class="number">1</span>,stuNum);</span><br><span class="line">            preparedStatement1.setInt(<span class="number">2</span>,bookId);</span><br><span class="line">            preparedStatement1.setInt(<span class="number">3</span>,num);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement1.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">10</span>/<span class="number">0</span>;  <span class="comment">//造异常：算术异常</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//2.修改`books`表中的库存</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;update books set book_stock=book_stock-? where book_id=?&quot;</span>;</span><br><span class="line">            preparedStatement2 = connection.prepareStatement(sql2);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">1</span>,num);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">2</span>,bookId);</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> preparedStatement2.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 提交事务</span></span><br><span class="line">            connection.commit();</span><br><span class="line">            flag = i&gt;<span class="number">0</span> &amp;&amp; j&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//一旦事务执行过程中出现异常，执行回滚</span></span><br><span class="line">                connection.rollback();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement1,<span class="literal">null</span>);</span><br><span class="line">            DBHelper.close(preparedStatement2,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="10-3-Service层的事务管理"><a href="#10-3-Service层的事务管理" class="headerlink" title="10.3 Service层的事务管理"></a>10.3 Service层的事务管理</h2><blockquote><p>DAO只负责数据库的操作，业务由service层进行管理</p></blockquote><h3 id="10-3-1-Service分层介绍"><a href="#10-3-1-Service分层介绍" class="headerlink" title="10.3.1 Service分层介绍"></a>10.3.1 Service分层介绍</h3><blockquote><ul><li>DAO负责特定的数据库操作</li><li>Servcie进行业务处理，Service业务处理过程如果需要数据库操作，则调用DAO完成</li></ul></blockquote><h3 id="10-3-2-Service分层实现"><a href="#10-3-2-Service分层实现" class="headerlink" title="10.3.2 Service分层实现"></a>10.3.2 Service分层实现</h3><ul><li>创建<code>RecordDAO</code>，完成<code>insertRecord</code>方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecordDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  添加借书记录</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> snum 借书的学生的学号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bid 借书的图书编号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> num 借书的数量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 添加借书记录成功返回true，失败返回false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insertRecord</span><span class="params">(String snum,<span class="type">int</span> bid,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//1.向`records`表添加借书记录</span></span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;insert into records(snum,bid,borrow_num,is_return,borrow_date) values(?,?,?,0,sysdate())&quot;</span>;</span><br><span class="line">            preparedStatement1 = connection.prepareStatement(sql1);</span><br><span class="line">            preparedStatement1.setString(<span class="number">1</span>,snum);</span><br><span class="line">            preparedStatement1.setInt(<span class="number">2</span>,bid);</span><br><span class="line">            preparedStatement1.setInt(<span class="number">3</span>,num);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement1.executeUpdate();</span><br><span class="line">            flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement1,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>在<code>BookDAO</code>中定义<code>updateStock</code>修改库存方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改库存</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bid 要修改库存的图书编号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> num  book_stock=book_stock-num</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateStock</span><span class="params">(<span class="type">int</span> bid,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//2.修改`books`表中的库存</span></span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;update books set book_stock=book_stock-? where book_id=?&quot;</span>;</span><br><span class="line">            preparedStatement2 = connection.prepareStatement(sql2);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">1</span>,num);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">2</span>,bid);</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> preparedStatement2.executeUpdate();</span><br><span class="line">            flag = j&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement2,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>创建<code>BookService</code>完成借书业务</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dao.BookDAO;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dao.RecordDAO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">RecordDAO</span> <span class="variable">recordDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RecordDAO</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">BookDAO</span> <span class="variable">bookDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BookDAO</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 借书业务，包含两个步骤，这两个步骤要么同时成功，要么同时失败——事务</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">borrowBook</span><span class="params">(String stuNum,<span class="type">int</span> bookId,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="comment">//1.添加借书记录</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b1</span> <span class="operator">=</span> recordDAO.insertRecord(stuNum, bookId, num);</span><br><span class="line">        <span class="comment">//2.修改图书库存</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b2</span> <span class="operator">=</span> bookDAO.updateStock(bookId, num);</span><br><span class="line">        <span class="comment">// 结果处理</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">r</span> <span class="operator">=</span> b1 &amp;&amp; b2;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="10-3-3-Service层的事务管理"><a href="#10-3-3-Service层的事务管理" class="headerlink" title="10.3.3 Service层的事务管理"></a>10.3.3 Service层的事务管理</h3><blockquote><p>Servcie层事务中多个数据库的DML操作是相互独立的，如何保证所有DML要么同时成功，要么同时失败呢？</p><p>事务管理要满足以下条件：</p><ul><li>多个DML操作需使用同一个数据库连接</li><li>第一个DML操作之前设置事务手动提交</li><li>所有DML操作执行完成之后提交事务</li><li>出现异常则进行事务回滚</li></ul></blockquote><p><strong>如何让Service事务中的多个DML使用同一个数据库连接？</strong></p><ul><li><p><code>在Service获取连接对象，将连接对象传递到DAO中</code></p><p>分析：DAO类中的Connection对象需要通过Service传递给进来，这种对象传递本来也无可厚非，但是当我们通过面向接口开发时（面向接口，是为了能够灵活的定义实现类），容易造成接口的冗余（接口污染）</p></li><li><p><code>使用ThreadLocal容器，实现多个DML操作使用相同的连接</code></p><p><img src="/../images/JDBC/image-20211020125509949.png" alt="image-20211020125509949"></p><blockquote><p>存储Connection的容器可以使用List集合</p><ul><li>使用List集合做容器，在多线程并发编程中会出现资源竞争问题——多个并发的线程使用的是同一个数据库连接对象（我们的要求是同一个事务中使用同一个连接，而并非多个线程共享连接）</li><li>为了解决并发编程的连接对象共享问题，我们可以使用ThreadLocal作为数据库连接对象的容器</li></ul></blockquote><p><img src="/../images/JDBC/image-20211020130039260.png" alt="image-20211020130039260"></p><p><img src="/../images/JDBC/image-20211020141735005.png" alt="image-20211020141735005"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DBHelper</span> &#123;</span><br><span class="line">    <span class="comment">//1.定义数据库连接信息</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DRIVER</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">URL</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USERNAME</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;@QFedu123&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1️⃣定义ThreadLocal容器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;Connection&gt; local = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.静态初始化块注册驱动</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(DRIVER);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.创建数据库连接</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnectin</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 2️⃣从ThreadLocal容器中获取连接</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> local.get();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(connection == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="comment">//3️⃣如果容器中没有连接，则创建连接，并将创建的连接存放到容器</span></span><br><span class="line">                connection = DriverManager.getConnection(URL,USERNAME,PASSWORD);</span><br><span class="line">                local.set(connection);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4. 4️⃣关闭连接</span></span><br><span class="line">    <span class="comment">// 如果使用ThreadLocal存储数据库连接，关闭连接时同时要将Connection对象从ThreadLocal中移除</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 获取到当前线程使用的数据库连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> local.get();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(connection !=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 将关闭后的连接对象从ThreadLocal中移除</span></span><br><span class="line">            local.remove();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeStatement</span><span class="params">(Statement statement)</span>&#123;</span><br><span class="line">        closeStatement(<span class="literal">null</span>,statement);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeStatement</span><span class="params">(ResultSet resultSet, Statement statement)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(resultSet!=<span class="literal">null</span> &amp;&amp; !resultSet.isClosed())&#123;</span><br><span class="line">                resultSet.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="十一、数据库连接池"><a href="#十一、数据库连接池" class="headerlink" title="十一、数据库连接池"></a>十一、数据库连接池</h1><h2 id="11-1-什么是数据库连接池？"><a href="#11-1-什么是数据库连接池？" class="headerlink" title="11.1 什么是数据库连接池？"></a>11.1 什么是数据库连接池？</h2><blockquote><p>如果每个JDBC操作需要数据库连接都重新创建，使用完成之后都销毁，我们的JVM会因为频繁的创建、销毁连接而占用额外的系统资源。</p><p>数据库连接本质上是可被重用的资源（当一个JDBC操作完成之后，其创建的连接是可以被其他JDBC操作使用的），基于这个特性：</p><ul><li>我们可以创建一个<code>存放数据库连接的容器</code>（连接池），连接池是有最大容量的</li><li>当我们要进行JDBC操作时，直接从这个容器中获取连接<ul><li>如果容器中没有空闲的连接且连接池中连接的个数没有达到最大值，则创建新的数据库连接存入连接池并给这个操作使用，使用完成之后无需关闭连接直接归还这个容器中即可；</li><li>如果容器中没有空闲的连接且连接池中连接的个数达到最大值，当前操作就会进行等待，等待连接池中的某个连接被归还，归还之后再使用；</li><li>如果容器中有空闲连接，则无需创建新的连接，直接从容器中获取这个空闲连接进行使用；</li></ul></li></ul></blockquote><p>连接池：存放数据库连接对象的容器</p><p>连接池作用：对数据库连接进行管理，减少因重复创建、销毁连接导致的系统开销</p><h2 id="11-2-常用连接池"><a href="#11-2-常用连接池" class="headerlink" title="11.2 常用连接池"></a>11.2 常用连接池</h2><blockquote><p>我们可以编程实现：创建一个数组、集合来存放数据库连接；</p><p>目前市面上已经有多种实现的数据库连接池了，我们无需再手动实现，只需引用对应的数据库连接池产品，即可在我们自己的Java应用中使用连接池（站在巨人的肩上）</p></blockquote><table><thead><tr><th>功能</th><th>dbcp</th><th>druid</th><th>c3p0</th><th>HikariCP</th></tr></thead><tbody><tr><td>是否支持PSCache</td><td>是</td><td>是</td><td>是</td><td>否</td></tr><tr><td>监控</td><td>jmx</td><td>jmx&#x2F;log&#x2F;http</td><td>jmx,log</td><td>jmx</td></tr><tr><td>扩展性</td><td>弱</td><td>好</td><td>弱</td><td>弱</td></tr><tr><td>sql拦截及解析</td><td>无</td><td>支持</td><td>无</td><td>无</td></tr><tr><td>代码</td><td>简单</td><td>中等</td><td>复杂</td><td>简单</td></tr><tr><td>特点</td><td>依赖于common-pool</td><td>阿里开源，功能全面</td><td>历史久远，代码逻辑复杂，且不易维护</td><td>优化力度大，功能简单，起源于boneCP</td></tr><tr><td>连接池管理</td><td>LinkedBlockingDeque</td><td>数组</td><td></td><td>ThreadLocal<br>CopyOnWriteArrayList</td></tr></tbody></table><ul><li>基于连接池的性能、使用的便捷性、连接监控等多方面综合情况，druid是目前企业应用中使用最广泛的</li><li>Hikari在SpringBoot中默认集成，性能是诸多竞品中最好的</li></ul><h2 id="11-3-使用Druid连接池"><a href="#11-3-使用Druid连接池" class="headerlink" title="11.3 使用Druid连接池"></a>11.3 使用Druid连接池</h2><h3 id="11-3-1-创建Java应用"><a href="#11-3-1-创建Java应用" class="headerlink" title="11.3.1 创建Java应用"></a>11.3.1 创建Java应用</h3><ul><li>创建Java工程</li><li>添加驱动jar文件</li></ul><h3 id="11-3-2-创建连接池属性配置"><a href="#11-3-2-创建连接池属性配置" class="headerlink" title="11.3.2 创建连接池属性配置"></a>11.3.2 创建连接池属性配置</h3><ul><li><p>在src中创建package：<code>com.qfedu.jdbc.utils</code></p></li><li><p>在<code>com.qfedu.jdbc.utils</code>中创建<code>druid.properties</code>文件</p></li><li><p>配置druid连接池的实行</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 数据库连接信息</span><br><span class="line">driverClassName=com.mysql.cj.jdbc.Driver</span><br><span class="line">url=jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8</span><br><span class="line">username=root</span><br><span class="line">password=@QFedu123</span><br><span class="line"></span><br><span class="line"># 连接池属性</span><br><span class="line"># 连接池的初始化连接数&lt;创建数据库连接池时默认初始化的连接的个数&gt;</span><br><span class="line">initialSize=10</span><br><span class="line"># 连接池的最大连接数</span><br><span class="line">maxActive=50</span><br><span class="line"># 最小空闲连接数（当数据库连接使用率很低时，连接池中的连接会被释放一部分）</span><br><span class="line">minIdle=5</span><br><span class="line"># 超时等待时间(单位：ms)</span><br><span class="line">maxWait=30000</span><br></pre></td></tr></table></figure><h3 id="11-3-3-创建连接池工具类"><a href="#11-3-3-创建连接池工具类" class="headerlink" title="11.3.3 创建连接池工具类"></a>11.3.3 创建连接池工具类</h3><ul><li><p>下载并导入druid的jar文件<code>druid-1.2.8.jar</code></p></li><li><p>在<code>com.qfedu.jdbc.utils</code>创建<code>DruidUtils</code>工具类（工具类与属性文件<code>druid.properties</code>在同目录下）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DruidUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.定义DruidDataSource对象：表示Druid数据库连接池（数据源）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DruidDataSource druidDataSource;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.静态代码块初始化定义DruidDataSource对象</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//读取druid.properties文件中配置的属性</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> DruidUtils.class.getResourceAsStream(<span class="string">&quot;druid.properties&quot;</span>);</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(is);</span><br><span class="line">            <span class="comment">//使用属性文件初始化DruidDataSource对象</span></span><br><span class="line">            druidDataSource = </span><br><span class="line">                (DruidDataSource) DruidDataSourceFactory.createDataSource(properties);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.创建静态方法，从连接池对象中获取连接</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection =  druidDataSource.getConnection();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="十二、通用JDBC操作封装"><a href="#十二、通用JDBC操作封装" class="headerlink" title="十二、通用JDBC操作封装"></a>十二、通用JDBC操作封装</h1><blockquote><p>在DAO层的JDBC操作中，对数据的表增、删、改、查操作存在代码的冗余，我们可以对其公共部分进行封装，实现代码的复用。</p></blockquote><h2 id="12-1-DML操作封装"><a href="#12-1-DML操作封装" class="headerlink" title="12.1 DML操作封装"></a>12.1 DML操作封装</h2><blockquote><p>对于数据库的DML操作：</p><ul><li>参数不同</li><li>SQL通过</li><li>SQL参数复制不同</li></ul></blockquote><ul><li>通用的DML操作方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 公共DML操作</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql 执行的SQL指令</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * sql : delete from students where stu_num=?</span></span><br><span class="line"><span class="comment">     * args: snum</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * sql : insert into students(stu_num,stu_name,stu_gender,stu_age) values(?,?,?,?)</span></span><br><span class="line"><span class="comment">     * args: 1009  Lucy  女   18</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">update</span><span class="params">(String sql, Object... args)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DruidUtils.getConnection();</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length ; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            b = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="12-2-DQL操作封装"><a href="#12-2-DQL操作封装" class="headerlink" title="12.2 DQL操作封装"></a>12.2 DQL操作封装</h2><table><thead><tr><th>使用泛型设置通用查询方法的返回类型</th></tr></thead><tbody><tr><td><img src="/../images/JDBC/image-20211020201919666.png" alt="image-20211020201919666"></td></tr></tbody></table><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">RowMapper</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getRow</span><span class="params">(ResultSet resultSet)</span> <span class="keyword">throws</span> SQLException;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonDAO</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 公共DML操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">update</span><span class="params">(String sql, Object... args)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DruidUtils.getConnection();</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length ; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            b = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;T&gt; <span class="title function_">select</span><span class="params">(String sql, RowMapper&lt;T&gt; rowMapper,Object...args)</span>&#123;</span><br><span class="line">        List&lt;T&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DruidUtils.getConnection();</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;args.length ; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line">            <span class="keyword">while</span>(resultSet.next())&#123;</span><br><span class="line">                <span class="comment">// 从查询结果中取出一条记录（多个值），封装到一个实体类对象中</span></span><br><span class="line">                <span class="comment">//  getRow就是方法调用者在调用方法时，传递进来的用于映射查询结果的方法</span></span><br><span class="line">               <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span>  rowMapper.getRow(resultSet);</span><br><span class="line">               list.add(t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="12-3-基于通用JDBC操作的案例"><a href="#12-3-基于通用JDBC操作的案例" class="headerlink" title="12.3 基于通用JDBC操作的案例"></a>12.3 基于通用JDBC操作的案例</h2><blockquote><p>图书信息进行JDBC操作</p><ul><li>创建图书实体类Book</li><li>创建BookDAO</li></ul></blockquote><h3 id="12-3-1-创建实体类"><a href="#12-3-1-创建实体类" class="headerlink" title="12.3.1 创建实体类"></a>12.3.1 创建实体类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookId;</span><br><span class="line">    <span class="keyword">private</span> String bookName;</span><br><span class="line">    <span class="keyword">private</span> String bookAuthor;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> bookPrice;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookStock;</span><br><span class="line">    <span class="keyword">private</span> String bookDesc;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//无参构造器</span></span><br><span class="line">    <span class="comment">//全参构造器</span></span><br><span class="line">    <span class="comment">//toString</span></span><br><span class="line">    <span class="comment">//get和set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-3-2-创建DAO类"><a href="#12-3-2-创建DAO类" class="headerlink" title="12.3.2 创建DAO类"></a>12.3.2 创建DAO类</h3><blockquote><p>DAO中的操作都是调用CommonDAO实现的</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dto.Book;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.CommonDAO;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.RowMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> CommonDAO&lt;Book&gt; commonDAO = <span class="keyword">new</span> <span class="title class_">CommonDAO</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  <span class="type">boolean</span> <span class="title function_">insertBook</span><span class="params">(Book book)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> commonDAO.update(sql, book.getBookName(), book.getBookAuthor(), book.getBookPrice(), book.getBookStock(), book.getBookDesc());</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteBook</span><span class="params">(<span class="type">int</span> bookId)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> commonDAO.update(sql, bookId);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateBook</span><span class="params">(Book book)</span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> commonDAO.update(sql, book.getBookName(), book.getBookAuthor(), book.getBookPrice(), book.getBookStock(), book.getBookDesc(), book.getBookId());</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">queryBook</span><span class="params">(<span class="type">int</span> bookId)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;</span>;</span><br><span class="line">        RowMapper&lt;Book&gt; bookRowMapper = <span class="keyword">new</span> <span class="title class_">RowMapper</span>&lt;Book&gt;()&#123;</span><br><span class="line">            <span class="keyword">public</span> Book <span class="title function_">getRow</span><span class="params">(ResultSet resultSet)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">bid</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Book</span>(bid,bookName,bookAuthor,bookPrice,bookStock,bookDesc);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        List&lt;Book&gt; list = commonDAO.select(sql, bookRowMapper, bookId);</span><br><span class="line">        <span class="keyword">return</span> list.size()&gt;<span class="number">0</span>?list.get(<span class="number">0</span>):<span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listBooks</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books&quot;</span>;</span><br><span class="line">        List&lt;Book&gt; list = commonDAO.select(sql, resultSet -&gt; &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">bid</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Book</span>(bid, bookName, bookAuthor, bookPrice, bookStock, bookDesc);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="十三、Apache-DBUtils"><a href="#十三、Apache-DBUtils" class="headerlink" title="十三、Apache DBUtils"></a>十三、Apache DBUtils</h1><h2 id="13-1-DBUtils介绍"><a href="#13-1-DBUtils介绍" class="headerlink" title="13.1 DBUtils介绍"></a>13.1 DBUtils介绍</h2><blockquote><p>Commons DBUtils是Apache组织提供的一个针对JDBC进行简单封装的开源工具类库，使用DBUtils可以极大简化JDBC应用程序开发，同时不会影响数据库访问的性能。</p></blockquote><blockquote><p>DBUtils是Java编程中数据库访问的轻巧、使用的工具类库</p><ul><li>提供对数据表通用的DML操作</li><li>提供对数据表通用的DQL操作（可以把结果封装成对象、集合等类型）</li></ul></blockquote><blockquote><p>DBUtils工具类库中的核心类：</p><ul><li><p><strong>QueryRunner</strong>，用于执行SQL指令（相当于我们自己封装的CommonDAO类）</p><ul><li>update() , 用于执行DML指令</li><li>query(), 用于执行DQL指令</li></ul></li><li><p><strong>ResultSetHandler</strong>接口，结果集处理器，用于处理查询结果（相当于我们自己的封装的RowMapper接口）</p><ul><li>BeanHandler实现类：当查询语句返回一条结果时，使用BeanHandler将结果转换成一个对象</li><li>BeanListHandler实现类：当查询语句返回多个结果时，使用BeanListHandler将结果转换成一个集合</li><li>ScalarHandler实现类：当查询结果返回一个值时，使用ScalarHandler将这个值转换成Java变量类型</li></ul></li></ul></blockquote><h2 id="13-2-DBUtils的使用准备"><a href="#13-2-DBUtils的使用准备" class="headerlink" title="13.2 DBUtils的使用准备"></a>13.2 DBUtils的使用准备</h2><ol><li><p>新建Java工程</p></li><li><p>添加依赖：</p><ul><li><code>mysql-connector-java-8.0.26.jar</code></li><li><code>druid-1.2.8.jar</code>Apache DBUtils建立数据库连接是依赖连接池数据源的，因此我们需要使用连接池</li><li><code>commons-dbutils-1.7.jar</code></li></ul></li><li><p>配置druid的属性文件</p><p>创建<code>com.qfedu.jdbc.utils</code>包</p><p>在包中创建<code>druid.properties</code>文件，配置如下</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据库连接信息</span></span><br><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">@QFedu123</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 连接池属性</span></span><br><span class="line"><span class="comment"># 连接池的初始化连接数&lt;创建数据库连接池时默认初始化的连接的个数&gt;</span></span><br><span class="line"><span class="attr">initialSize</span>=<span class="string">10</span></span><br><span class="line"><span class="comment"># 连接池的最大连接数</span></span><br><span class="line"><span class="attr">maxActive</span>=<span class="string">50</span></span><br><span class="line"><span class="comment"># 最小空闲连接数（当数据库连接使用率很低时，连接池中的连接会被释放一部分）</span></span><br><span class="line"><span class="attr">minIdle</span>=<span class="string">5</span></span><br><span class="line"><span class="comment"># 超时等待时间(单位：ms)</span></span><br><span class="line"><span class="attr">maxWait</span>=<span class="string">30000</span></span><br></pre></td></tr></table></figure></li><li><p>创建Druid连接池工具类</p><p>在<code>com.qfedu.jdbc.utils</code>包创建<code>DruidUtils</code>工具类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DruidUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DruidDataSource druidDataSource;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> DruidUtils.class.getResourceAsStream(<span class="string">&quot;druid.properties&quot;</span>);</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(is);</span><br><span class="line">            druidDataSource = (DruidDataSource) DruidDataSourceFactory.createDataSource(properties);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取数据库连接池数据源对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> DataSource <span class="title function_">getDataSource</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> druidDataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = druidDataSource.getConnection();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="13-3-DBUtils使用"><a href="#13-3-DBUtils使用" class="headerlink" title="13.3 DBUtils使用"></a>13.3 DBUtils使用</h2><blockquote><p>完成图书信息的数据库操作</p></blockquote><ul><li>创建实体类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookId;</span><br><span class="line">    <span class="keyword">private</span> String bookName;</span><br><span class="line">    <span class="keyword">private</span> String bookAuthor;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> bookPrice;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookStock;</span><br><span class="line">    <span class="keyword">private</span> String bookDesc;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="13-3-1-添加操作"><a href="#13-3-1-添加操作" class="headerlink" title="13.3.1 添加操作"></a>13.3.1 添加操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertBook</span><span class="params">(Book book)</span>&#123;</span><br><span class="line">    <span class="type">int</span> i= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//1.编写SQL</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="comment">//2.准备参数</span></span><br><span class="line">        Object[] params = &#123;book.getBookName(),book.getBookAuthor(),book.getBookPrice(),book.getBookStock(),book.getBookDesc()&#125;;</span><br><span class="line">        <span class="comment">//3.调用commons-dbutils中的QueryRunner执行SQL</span></span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        i = queryRunner.update(sql, params);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="13-3-2-删除操作"><a href="#13-3-2-删除操作" class="headerlink" title="13.3.2 删除操作"></a>13.3.2 删除操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteBook</span><span class="params">(<span class="type">int</span> bookId)</span>&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        i = queryRunner.update(sql,bookId);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="13-3-3-修改操作"><a href="#13-3-3-修改操作" class="headerlink" title="13.3.3 修改操作"></a>13.3.3 修改操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updateBook</span><span class="params">(Book book)</span>&#123;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">        Object[] params = &#123;book.getBookName(),book.getBookAuthor(),book.getBookPrice(),book.getBookStock(),book.getBookDesc(),book.getBookId()&#125;;</span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        i = queryRunner.update(sql, params);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="13-3-4-查询操作"><a href="#13-3-4-查询操作" class="headerlink" title="13.3.4 查询操作"></a>13.3.4 查询操作</h3><p><strong>查询一条记录</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Book <span class="title function_">queryBook</span><span class="params">(<span class="type">int</span> bookId)</span>&#123;</span><br><span class="line">    <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id bookId,book_name bookName,book_author bookAuthor,book_price bookPrice,book_stock bookStock,book_desc bookDesc from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        <span class="comment">//1.对于查询操作，我们需要通过QueryRunner对象调用query方法来执行</span></span><br><span class="line">        <span class="comment">//2.所有的query方法都需要一个ResultSetHandler的参数，通过此参数指定query方法的返回类型</span></span><br><span class="line">        <span class="comment">//  如果SQL指令执行之后返回的是一行记录，我们通过BeanHandler指定查询结果封装的实体类类型</span></span><br><span class="line">        <span class="comment">//  要求：查询结果集的字段名必须与指定的实体类的属性名匹配</span></span><br><span class="line">        <span class="comment">//     方案1：创建实体类的时候，实体类中属性的名字与数据表中的列名相同</span></span><br><span class="line">        <span class="comment">//     方案2：查询语句字段取别名，让字段别名与实体类属性名一致</span></span><br><span class="line">        book = queryRunner.query(sql, <span class="keyword">new</span> <span class="title class_">BeanHandler</span>&lt;Book&gt;(Book.class), bookId);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> book;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>自定义结果集处理</strong> 自定义ResultSetHandler</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Book <span class="title function_">queryBook2</span><span class="params">(<span class="type">int</span> bookId)</span>&#123;</span><br><span class="line">    <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        <span class="comment">//1.对于查询操作，我们需要通过QueryRunner对象调用query方法来执行</span></span><br><span class="line">        <span class="comment">//2.所有的query方法都需要一个ResultSetHandler的参数，通过此参数指定query方法的返回类型</span></span><br><span class="line">        <span class="comment">//  如果SQL指令执行之后返回的是一行记录，我们通过BeanHandler指定查询结果封装的实体类类型</span></span><br><span class="line">        <span class="comment">//  要求：查询结果集的字段名必须与指定的实体类的属性名匹配</span></span><br><span class="line">        <span class="comment">//     方案3：自定义ResultSetHandler结果处理</span></span><br><span class="line">        ResultSetHandler&lt;Book&gt; resultSetHandler = <span class="keyword">new</span> <span class="title class_">ResultSetHandler</span>&lt;Book&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Book <span class="title function_">handle</span><span class="params">(ResultSet resultSet)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">                <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">if</span>(resultSet.next()) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">                    <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">                    <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">                    book = <span class="keyword">new</span> <span class="title class_">Book</span>(id,bookName,bookAuthor,bookPrice,bookStock,bookDesc);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> book;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        book = queryRunner.query(sql, resultSetHandler, bookId);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> book;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>查询多条记录</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listBooks</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;Book&gt; bookList = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select  book_id bookId,book_name bookName,book_author bookAuthor,book_price bookPrice,book_stock bookStock,book_desc bookDesc  from books&quot;</span>;</span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        <span class="comment">//如果SQL指令执行之后返回的是多行记录，我们通过BeanListHandler指定查询结果封装的实体类的集合类型</span></span><br><span class="line">        bookList = queryRunner.query(sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;Book&gt;(Book.class));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> bookList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>查询一个值</strong></p><blockquote><p>例如在做分页的时候，我们需要查询数据的总记录数</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getCount</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select count(1) from books&quot;</span>;</span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">    <span class="comment">// 如果SQL指令执行之后返回的是一个值时，我们通过ScalarHandler指定返回类型</span></span><br><span class="line">    <span class="comment">// QueryRunner在处理统计操作时，是以long类型进行操作的，因此不能直接转成Integer</span></span><br><span class="line">    <span class="comment">// 如果我们确定这个值在int范围内，我们可以在得到long类型之后进行强转，建议使用long处理</span></span><br><span class="line">    ScalarHandler&lt;Long&gt; scalarHandler = <span class="keyword">new</span> <span class="title class_">ScalarHandler</span>&lt;Long&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        count = queryRunner.query(sql, scalarHandler);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">JDBC相关内容</summary>
    
    
    
    <category term="数据库" scheme="https://chenhaonan.dpdns.org/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Java" scheme="https://chenhaonan.dpdns.org/tags/Java/"/>
    
    <category term="数据库" scheme="https://chenhaonan.dpdns.org/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="JDBC" scheme="https://chenhaonan.dpdns.org/tags/JDBC/"/>
    
  </entry>
  
  <entry>
    <title>MySQL教程</title>
    <link href="https://chenhaonan.dpdns.org/posts/b9a6/"/>
    <id>https://chenhaonan.dpdns.org/posts/b9a6/</id>
    <published>2024-10-11T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.934Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、数据库相关概念"><a href="#一、数据库相关概念" class="headerlink" title="一、数据库相关概念"></a>一、数据库相关概念</h2><h3 id="1-1-数据库"><a href="#1-1-数据库" class="headerlink" title="1.1 数据库"></a>1.1 数据库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.数据库即存储数据的仓库，数据是有组织的存储</span><br><span class="line">2.英文：DataBase,简称：DB</span><br></pre></td></tr></table></figure><h3 id="1-2-数据库软件"><a href="#1-2-数据库软件" class="headerlink" title="1.2 数据库软件"></a>1.2 数据库软件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.数据库软件即管理数据库的软件</span><br><span class="line">2.英文：DataBase Management System,简称：DBMS</span><br></pre></td></tr></table></figure><h3 id="1-3-SQL"><a href="#1-3-SQL" class="headerlink" title="1.3 SQL"></a>1.3 SQL</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.英文：Structured Query Langeage,简称：SQL,结构化查询语言</span><br><span class="line">2.操作关系型数据库的编程语言</span><br><span class="line">3.定义操作所有关系型数据库的统一标准</span><br></pre></td></tr></table></figure><h2 id="二、常见的关系型数据库管理系统"><a href="#二、常见的关系型数据库管理系统" class="headerlink" title="二、常见的关系型数据库管理系统"></a>二、常见的关系型数据库管理系统</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MySQL: 开源免费的中小型数据库</span><br><span class="line">Oracel: 收费的大型数据库</span><br><span class="line">SQL Server: MicroSoft公司收费的的中型数据库</span><br><span class="line">DB2: IBM公司的大型收费数据库</span><br><span class="line">MariaDB: 开源免费的中小型数据库</span><br><span class="line">PostgreSQL: 开源免费的中小型数据库</span><br><span class="line">SQLite: 嵌入式的微型数据库,如作为Android内置数据库</span><br><span class="line">……</span><br></pre></td></tr></table></figure><h2 id="三、MySQL数据库"><a href="#三、MySQL数据库" class="headerlink" title="三、MySQL数据库"></a>三、MySQL数据库</h2><h3 id="3-1-安装MySQL"><a href="#3-1-安装MySQL" class="headerlink" title="3.1 安装MySQL"></a>3.1 安装MySQL</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在Centos7中,通过Docker安装MySQL(8.0.27),注：目前学习阶段未对mysql的数据目录做数据卷的处理，删除容器后数据也会消失，因此删除容器前注意备份数据。</span><br><span class="line"></span><br><span class="line">安装步骤如下:</span><br></pre></td></tr></table></figure><ol><li><strong>拉取镜像</strong></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:8.0.27</span><br></pre></td></tr></table></figure><ol start="2"><li><strong>运行镜像，产生容器</strong></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=root --name=mysql mysql</span><br></pre></td></tr></table></figure><h3 id="3-2-设置Root账户可远程访问数据库"><a href="#3-2-设置Root账户可远程访问数据库" class="headerlink" title="3.2 设置Root账户可远程访问数据库"></a>3.2 设置Root账户可远程访问数据库</h3><p>在 MySQL 8.0 中，要设置 <code>root</code> 用户可以从远程主机访问，你需要执行几个步骤。以下是如何实现的步骤：</p><ol><li><strong>登录MySQL</strong></li></ol><p>首先，你需要以 <code>root</code> 用户身份登录到 MySQL 服务器。这通常是在服务器上本地完成的。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure><p>输入密码后，你将进入 MySQL 提示符。</p><ol start="2"><li><strong>创建远程 root 用户</strong>（如果还没有的话）</li></ol><p>默认情况下，MySQL 的 <code>root</code> 用户可能只允许从 <code>localhost</code> 访问。要允许从任何主机访问，你需要为该用户指定一个 ‘%’ 通配符，但这并不安全。建议只允许来自特定主机的连接。但如果你只是想测试或临时允许从任何主机访问，可以这样做：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;YOUR_PASSWORD&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br></pre></td></tr></table></figure><p>注意：<code>YOUR_PASSWORD</code> 需要替换为你的密码。出于安全考虑，强烈建议仅为受信任的主机创建用户，而不是使用 ‘%’。</p><ol start="3"><li><strong>刷新权限</strong></li></ol><p>为了让新的权限设置立即生效，你需要刷新 MySQL 的权限表：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><ol start="4"><li><strong>开放3306端口</strong></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=publish --add-port=3306/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><ol start="5"><li><strong>测试远程连接</strong></li></ol><p>从远程主机使用 MySQL 客户端工具（如 <code>mysql</code> 命令行工具或任何图形界面工具）尝试连接到 MySQL 服务器。确保使用正确的 IP 地址、端口和凭据。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h YOUR_SERVER_IP -u root -p</span><br></pre></td></tr></table></figure><p>输入你在步骤 2 中设置的密码。</p><p><strong>注意</strong>：允许从远程主机访问 MySQL 的 <code>root</code> 用户可能会带来安全风险。确保你了解这些风险，并仅在必要时采取此操作。在生产环境中，通常建议创建具有适当权限的专用用户来管理远程连接。</p><h3 id="3-3-卸载MySQL"><a href="#3-3-卸载MySQL" class="headerlink" title="3.3 卸载MySQL"></a>3.3 卸载MySQL</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通过Docker安装的MySQL,卸载十分的方便,卸载MySQL即删除对应的容器，注：目前学习阶段未对mysql的数据目录做数据卷的处理，删除容器后数据也会消失，因此删除容器前注意备份数据。</span><br></pre></td></tr></table></figure><p><strong>删除容器的命令</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">rm</span> 容器Id</span><br></pre></td></tr></table></figure><h3 id="3-4-MySQL的数据模型"><a href="#3-4-MySQL的数据模型" class="headerlink" title="3.4 MySQL的数据模型"></a>3.4 MySQL的数据模型</h3><p><strong>关系型数据库</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">关系型数据库即通过多张能够相互连接的二维表来存储数据的数据库</span><br></pre></td></tr></table></figure><p><strong>数据模型</strong></p><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20240601100207516.png" alt="image-20240601100207516"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">一个MySQL数据库管理系统中可以创建多个数据库,一个数据库中可以创建多张数据表,一个表中可以存放多条数据。</span><br><span class="line"></span><br><span class="line">数据库：文件夹的方式存在</span><br><span class="line">数据表：以fmf结尾的文件</span><br><span class="line">数据：以MY0结尾的文件</span><br></pre></td></tr></table></figure><h2 id="四、SQL"><a href="#四、SQL" class="headerlink" title="四、SQL"></a>四、SQL</h2><p>通过SQL，来告诉数据库管理系统做什么操作。<br>根据MySQL的数据模型可以看出,需要<code>通过SQL来操作数据库、数据表、以及数据表中的数据</code>。操作的类型分为：<code>增、删、改、查</code></p><h3 id="4-1-SQL通用语法"><a href="#4-1-SQL通用语法" class="headerlink" title="4.1 SQL通用语法"></a>4.1 SQL通用语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.SQL语句可以单行或多行书写,以分号结尾</span><br><span class="line">2.SQL语句不区分大小写,关键字建议使用大写</span><br><span class="line">3.注释：</span><br><span class="line">-- 单行注释内容</span><br><span class="line">/* 多行注释内容 */</span><br><span class="line"># 单行注释内容(MySQL 特有)</span><br></pre></td></tr></table></figure><h3 id="4-2-SQL分类"><a href="#4-2-SQL分类" class="headerlink" title="4.2 SQL分类"></a>4.2 SQL分类</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DDL: 数据定义语言，用于定义数据库对象: 数据库、表、视图、索引、存储过程等(操作数据库和、数据表、视图、索引、存储过程)</span><br><span class="line">DML: 数据库操作语言，用于对数据库中的表的数据进行增删改的操作(操作表中的数据)</span><br><span class="line">DQL: 数据库查询语言，用于对数据库中的表的数据进行查询操作(操作表中的数据)</span><br><span class="line">DCL: 数据库控制语言，用于定义数据库的访问权限和安全级别(用户、用户权限、事务等操作)</span><br></pre></td></tr></table></figure><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20240601112506390.png" alt="image-20240601112506390"></p><h3 id="4-3-DDL"><a href="#4-3-DDL" class="headerlink" title="4.3 DDL"></a>4.3 DDL</h3><h4 id="4-3-1-数据库相关操作"><a href="#4-3-1-数据库相关操作" class="headerlink" title="4.3.1 数据库相关操作"></a>4.3.1 数据库相关操作</h4><p><strong>增加数据库</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 创建数据库</span><br><span class="line"><span class="keyword">create</span> database 数据库名;</span><br><span class="line"># 创建数据库,当指定的数据库不存在时才执行</span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> 数据库名;</span><br><span class="line"># 在创建数据库的同时指定数据库的字符集(数据存储在数据库中采用的编码格式 utf8 gbk)</span><br><span class="line"><span class="keyword">create</span> database 数据库名 <span class="keyword">character set</span> utf8;</span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> 数据库名 <span class="keyword">character set</span> utf8;</span><br></pre></td></tr></table></figure><p><strong>删除数据库</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 删除数据库</span><br><span class="line"><span class="keyword">drop</span> database 数据库名;</span><br><span class="line"># 删除数据库,当指定的数据库存在时才执行</span><br><span class="line"><span class="keyword">drop</span> database if <span class="keyword">exists</span> 数据库名;</span><br></pre></td></tr></table></figure><p><strong>修改数据库</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 修改数据库的字符集</span><br><span class="line"><span class="keyword">alter</span> database 数据库名 <span class="keyword">character set</span> utf8;</span><br></pre></td></tr></table></figure><p><strong>查询数据库</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 显示当前mysql数据库中的数据库列表</span><br><span class="line"><span class="keyword">show</span> databases;</span><br><span class="line"># 查看当前使用的数据库</span><br><span class="line"><span class="keyword">select</span> database();</span><br><span class="line"># 显示指定名称的数据库创建的<span class="keyword">SQL</span>指令</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> database 数据库名; </span><br></pre></td></tr></table></figure><p><strong>使用数据库</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use 数据库名;</span><br></pre></td></tr></table></figure><h4 id="4-3-2-数据表相关操作"><a href="#4-3-2-数据表相关操作" class="headerlink" title="4.3.2 数据表相关操作"></a>4.3.2 数据表相关操作</h4><p><strong>增加表</strong></p><p><em><strong>注：字段的最后一行尾不能加逗号</strong></em></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 创建表</span><br><span class="line"><span class="keyword">create table</span> 表名(</span><br><span class="line">字段名<span class="number">1</span> 数据类型<span class="number">1</span> [约束] [comment 字段描述],</span><br><span class="line">字段名<span class="number">2</span> 数据类型<span class="number">2</span> [约束] [comment 字段描述],</span><br><span class="line">……</span><br><span class="line">字段名n 数据类型n [约束] [comment 字段描述]</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"># 创建表,当表不存在时才执行</span><br><span class="line"><span class="keyword">create table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> 表名(</span><br><span class="line">字段名<span class="number">1</span> 数据类型<span class="number">1</span> [约束] [comment 字段描述],</span><br><span class="line">字段名<span class="number">2</span> 数据类型<span class="number">2</span> [约束] [comment 字段描述],</span><br><span class="line">……</span><br><span class="line">字段名n 数据类型n [约束] [comment 字段描述]</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>删除表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 删除表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> 表名;</span><br><span class="line"># 删除表,当表存在时才执行</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> 表名;</span><br></pre></td></tr></table></figure><p><strong>修改表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 修改表名:</span><br><span class="line"><span class="keyword">alter table</span> 表名 rename <span class="keyword">to</span> 新表名;</span><br><span class="line"># 修改表的字符集</span><br><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">character set</span> utf8;</span><br><span class="line"># 添加列:</span><br><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">add</span> 列名 数据类型 [约束] [comment 字段描述];</span><br><span class="line"># 删除字段:</span><br><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">drop</span> 列名;</span><br><span class="line"># 修改列的数据类型:</span><br><span class="line"><span class="keyword">alter table</span> 表名 modify 列名 新的数据类型;</span><br><span class="line"># 修改列的列名和数据类型:</span><br><span class="line"><span class="keyword">alter table</span> 表名 change 列名 新列名 新数据类型</span><br></pre></td></tr></table></figure><p><strong>查询表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 查询当前数据库下的所有表的名称:</span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"># 查询表结构：</span><br><span class="line"><span class="keyword">desc</span> 表名称;</span><br></pre></td></tr></table></figure><h4 id="4-3-3-数据类型"><a href="#4-3-3-数据类型" class="headerlink" title="4.3.3 数据类型"></a>4.3.3 数据类型</h4><p><strong>数值类型</strong></p><table><thead><tr><th>类型</th><th>内存空间大小</th><th>范围</th><th>说明</th></tr></thead><tbody><tr><td>tinyint</td><td>1byte</td><td>有符号 -128<del>127, 无符号 0</del>255</td><td>特小型整数(年龄)</td></tr><tr><td>smallint</td><td>2byte</td><td>有符号 -32768<del>32767, 无符号 0</del>65535</td><td>小型整数</td></tr><tr><td>mediumint</td><td>3byte</td><td>有符号 -2^31<del>2^31-1, 无符号 0</del>2^32-1</td><td>中型整数</td></tr><tr><td>int&#x2F;integer</td><td>4byte</td><td></td><td>整数</td></tr><tr><td>bigint</td><td>8byte</td><td></td><td>大型整数</td></tr><tr><td>float</td><td>4byte</td><td></td><td>单精度</td></tr><tr><td>double</td><td>8byte</td><td></td><td>双精度</td></tr><tr><td>decimal</td><td>一般情况: 第一个参数+2</td><td></td><td>decimal(10,2),表示数值一共10为位，小数位有2位</td></tr></tbody></table><p><strong>字符串类型</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">在数据库中存储图片或者视频音频等内容，一般是存储，文件在服务器上的路径，当然如</span><br><span class="line">果非要存储就需要将图片等数据转成二进制进行存储，所以blob类型是可以存储所有类型的，但</span><br><span class="line">是前提是需要转换成二进制，所以此类型用的很少。</span><br><span class="line"></span><br><span class="line">longtext类型一般用于varchar类型储存不下的时候。</span><br></pre></td></tr></table></figure><table><thead><tr><th>类型</th><th>字符长度</th><th>说明</th></tr></thead><tbody><tr><td>char</td><td>0~255字节</td><td>定长字符串,最多可以存储255个字符;当我们指定数据表字段为char(n)时,此列中的数据最长为n,如果添加的数据少于n,则补’\u0000’至n长度</td></tr><tr><td>varchar</td><td>0~65535字节</td><td>可变长度字符串,此类型的列最大长度为65535</td></tr><tr><td>tinyblob</td><td>0~255字节</td><td>存储二进制字符串</td></tr><tr><td>blob</td><td>0~65535字节</td><td>存储二进制字符串</td></tr><tr><td>mediumblob</td><td>0~1677215字节</td><td>存储二进制字符串</td></tr><tr><td>longblob</td><td>0~4294967295字节</td><td>存储二进制字符串</td></tr><tr><td>tinytext</td><td>0~255字节</td><td>文本数据(字符串)</td></tr><tr><td>text</td><td>0~65535字节</td><td>文本数据(字符串)</td></tr><tr><td>mediumtext</td><td>0~1677215字节</td><td>文本数据(字符串)</td></tr><tr><td>longtext</td><td>0~4294967295字节</td><td>文本数据(字符串)</td></tr></tbody></table><p><strong>日期类型</strong></p><table><thead><tr><th>类型</th><th>格式</th><th>说明</th></tr></thead><tbody><tr><td>date</td><td>yyyy-MM-dd</td><td>日期，只存储年月日</td></tr><tr><td>time</td><td>HH:mm:ss</td><td>时间，只存储时分秒</td></tr><tr><td>datetime</td><td>yyyy-MM-dd HH:mm:ss</td><td>日期+时间，存储年月日时分秒</td></tr><tr><td>year</td><td>yyyy</td><td>年份</td></tr><tr><td>timestamp</td><td>时间戳</td><td>日期+时间 (时间戳)</td></tr></tbody></table><h3 id="4-4-DML"><a href="#4-4-DML" class="headerlink" title="4.4 DML"></a>4.4 DML</h3><h4 id="4-4-1-增加数据"><a href="#4-4-1-增加数据" class="headerlink" title="4.4.1 增加数据"></a>4.4.1 增加数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名(列名<span class="number">1</span>,列名<span class="number">2</span>,列名<span class="number">3</span>,……) <span class="keyword">values</span>(值<span class="number">1</span>,值<span class="number">2</span>,值<span class="number">3</span>,……)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名 <span class="keyword">values</span>(值<span class="number">1</span>,值<span class="number">2</span>,值<span class="number">3</span>,……)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名(列名<span class="number">1</span>,列名<span class="number">2</span>,列名<span class="number">3</span>,……) <span class="keyword">values</span>(值<span class="number">1</span>,值<span class="number">2</span>,值<span class="number">3</span>,……),(值<span class="number">1</span>,值<span class="number">2</span>,值<span class="number">3</span>,……)……;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名 <span class="keyword">values</span>(值<span class="number">1</span>,值<span class="number">2</span>,值<span class="number">3</span>,……),(值<span class="number">1</span>,值<span class="number">2</span>,值<span class="number">3</span>,……),</span><br></pre></td></tr></table></figure><h4 id="4-4-2-删除数据"><a href="#4-4-2-删除数据" class="headerlink" title="4.4.2 删除数据"></a>4.4.2 删除数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> 表名 [<span class="keyword">where</span> 条件]</span><br></pre></td></tr></table></figure><h4 id="4-4-3-修改数据"><a href="#4-4-3-修改数据" class="headerlink" title="4.4.3 修改数据"></a>4.4.3 修改数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> 表名 <span class="keyword">set</span> 列名<span class="number">1</span><span class="operator">=</span>值<span class="number">1</span>,列名<span class="number">2</span><span class="operator">=</span>值<span class="number">2</span>,…… [<span class="keyword">where</span> 条件]</span><br></pre></td></tr></table></figure><h3 id="4-5-DQL"><a href="#4-5-DQL" class="headerlink" title="4.5 DQL"></a>4.5 DQL</h3><p><strong>基本语法</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">字段列表</span><br><span class="line">from </span><br><span class="line">表名列表</span><br><span class="line">where</span><br><span class="line">条件列表</span><br><span class="line">group by </span><br><span class="line">分支字段列表</span><br><span class="line">having</span><br><span class="line">分组后的条件列表</span><br><span class="line">order by </span><br><span class="line">排序字段列表</span><br><span class="line">limit </span><br><span class="line">分页限定</span><br></pre></td></tr></table></figure><p><strong>查询分类</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">基础查询</span><br><span class="line">条件查询(where)</span><br><span class="line">分组查询(group by)</span><br><span class="line">排序查询(order by)</span><br><span class="line">分页查询(limit)</span><br></pre></td></tr></table></figure><h4 id="4-5-1-基础查询"><a href="#4-5-1-基础查询" class="headerlink" title="4.5.1 基础查询"></a>4.5.1 基础查询</h4><p><strong>格式</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表名</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 表名</span><br></pre></td></tr></table></figure><p><strong>去除重复记录</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select distinct 字段列表 from 表名</span><br></pre></td></tr></table></figure><p><strong>起别名</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select 字段 as 字段别名 from 表名</span><br><span class="line">select 字段 字段别名 from 表名</span><br></pre></td></tr></table></figure><h4 id="4-5-2-条件查询"><a href="#4-5-2-条件查询" class="headerlink" title="4.5.2 条件查询"></a>4.5.2 条件查询</h4><p><strong>格式</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表名 where 条件列表</span><br></pre></td></tr></table></figure><p><strong>条件</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt;</span><br><span class="line">&lt;</span><br><span class="line">=</span><br><span class="line">&gt;=</span><br><span class="line">&lt;=</span><br><span class="line">!=或&lt;&gt;</span><br><span class="line">between …… and ……</span><br><span class="line">in(……)</span><br><span class="line">like </span><br><span class="line">is null</span><br><span class="line">is not null</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">and</span><br><span class="line">or</span><br><span class="line">not</span><br></pre></td></tr></table></figure><h4 id="4-5-3-分组查询"><a href="#4-5-3-分组查询" class="headerlink" title="4.5.3 分组查询"></a>4.5.3 分组查询</h4><p><strong>聚合函数</strong></p><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20240601131353025.png" alt="image-20240601131353025"></p><p><strong>格式</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表名 [where 条件列表] group by 分组字段名 [having 分组后的过滤条件]</span><br></pre></td></tr></table></figure><p><strong>注意事项</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">分组后查询的字段为 聚合函数和分组字段,查询其他字段无任何意义</span><br></pre></td></tr></table></figure><p><strong>where与having的区别</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.执行时机不一样: where是在分组之前进行限定,不满足where条件的数据,不参与分组,而having是分组之后对结果进行过滤</span><br><span class="line">2.判断条件不一样: where不能对聚合函数进行判断,having可以</span><br><span class="line"></span><br><span class="line">执行顺序: where &gt; 聚合函数 &gt; having</span><br></pre></td></tr></table></figure><h4 id="4-5-4-排序查询"><a href="#4-5-4-排序查询" class="headerlink" title="4.5.4 排序查询"></a>4.5.4 排序查询</h4><p><strong>格式</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表名 order by 排序字段名1 [排序方式1],排序字段名2 [排序方式2]……</span><br></pre></td></tr></table></figure><p><strong>排序方式</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">asc : 升序(默认值)</span><br><span class="line">desc : 降序</span><br><span class="line">注：如果有多个排序条件,当前面的条件值一样时,才会根据第二条件排序</span><br></pre></td></tr></table></figure><h4 id="4-5-5-分页查询"><a href="#4-5-5-分页查询" class="headerlink" title="4.5.5 分页查询"></a>4.5.5 分页查询</h4><p><strong>格式</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表名 limit 起始索引,查询条目数</span><br></pre></td></tr></table></figure><p><strong>注意事项</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">起始索引: 从0开始</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">计算公式: 起始索引=(当前页码-1)*每页显示的条数</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">分页查询limit是MySQL数据库的方言</span><br><span class="line">Oracel分页查询使用rownumber</span><br><span class="line">SQL SERVER分页查询使用top</span><br></pre></td></tr></table></figure><h2 id="五、约束"><a href="#五、约束" class="headerlink" title="五、约束"></a>五、约束</h2><h3 id="5-1-约束的概念"><a href="#5-1-约束的概念" class="headerlink" title="5.1 约束的概念"></a>5.1 约束的概念</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">约束是作用于表中列上的规则,用于现状加入表中的数据</span><br><span class="line">约束的存在保证了数据库中的数据的完整性、有效性、正确性</span><br></pre></td></tr></table></figure><h3 id="5-2-约束分类"><a href="#5-2-约束分类" class="headerlink" title="5.2 约束分类"></a>5.2 约束分类</h3><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20240601143403572.png" alt="image-20240601143403572"></p><p><strong>注：MySQL不支持检查约束</strong></p><h3 id="5-3-自增长"><a href="#5-3-自增长" class="headerlink" title="5.3 自增长"></a>5.3 自增长</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">条件: 当列是数字类型的时候可以加自增长</span><br><span class="line"></span><br><span class="line">auto_increment</span><br></pre></td></tr></table></figure><h3 id="5-4-添加约束-非外键约束"><a href="#5-4-添加约束-非外键约束" class="headerlink" title="5.4 添加约束(非外键约束)"></a>5.4 添加约束(非外键约束)</h3><h4 id="5-4-1-创建表的时候添加"><a href="#5-4-1-创建表的时候添加" class="headerlink" title="5.4.1 创建表的时候添加"></a>5.4.1 创建表的时候添加</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line">列名 数据类型 约束,</span><br><span class="line">列名 数据类型 约束,</span><br><span class="line">……</span><br><span class="line">列名 数据类型 约束</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="5-4-2-创建完表之后添加"><a href="#5-4-2-创建完表之后添加" class="headerlink" title="5.4.2 创建完表之后添加"></a>5.4.2 创建完表之后添加</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 modify 字段 数据类型 约束;</span><br></pre></td></tr></table></figure><h3 id="5-5-删除约束-非外键约束"><a href="#5-5-删除约束-非外键约束" class="headerlink" title="5.5 删除约束(非外键约束)"></a>5.5 删除约束(非外键约束)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 modify 字段 数据类型;</span><br></pre></td></tr></table></figure><h3 id="5-6-添加外键约束"><a href="#5-6-添加外键约束" class="headerlink" title="5.6 添加外键约束"></a>5.6 添加外键约束</h3><h4 id="5-6-1-创建表的时候添加"><a href="#5-6-1-创建表的时候添加" class="headerlink" title="5.6.1 创建表的时候添加"></a>5.6.1 创建表的时候添加</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line">列名 数据类型,</span><br><span class="line">列名 数据类型,</span><br><span class="line">……</span><br><span class="line">列名 数据类型,</span><br><span class="line">constraint 外键名称 foreign key(外键列名) references 主表(主表列名)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="5-6-2-创建完表之后添加"><a href="#5-6-2-创建完表之后添加" class="headerlink" title="5.6.2 创建完表之后添加"></a>5.6.2 创建完表之后添加</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add constraint 外键名称 foreign key(外键列名) references 主表(主表列名)</span><br></pre></td></tr></table></figure><h3 id="5-7-删除外键约束"><a href="#5-7-删除外键约束" class="headerlink" title="5.7 删除外键约束"></a>5.7 删除外键约束</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 drop foreign key 外键名称</span><br></pre></td></tr></table></figure><h2 id="六、数据库设计"><a href="#六、数据库设计" class="headerlink" title="六、数据库设计"></a>六、数据库设计</h2><h3 id="6-1-数据库设计的概念"><a href="#6-1-数据库设计的概念" class="headerlink" title="6.1 数据库设计的概念"></a>6.1 数据库设计的概念</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据库设计即针对某个系统的需求进行设计，确定需要哪些表、表中有那些字段以及表于表之间的关系</span><br></pre></td></tr></table></figure><h3 id="6-2-表与表之间的关系"><a href="#6-2-表与表之间的关系" class="headerlink" title="6.2 表与表之间的关系"></a>6.2 表与表之间的关系</h3><h4 id="6-2-1-一对一"><a href="#6-2-1-一对一" class="headerlink" title="6.2.1 一对一"></a>6.2.1 一对一</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">一对一</span><br><span class="line">如：人与身份证号</span><br><span class="line">一个人拥有一个身份证号,一个身份证号对应一个人</span><br><span class="line">实现方式：在任意一方加外键，指向另一方的主键,且在外键字段上添加 唯一约束</span><br><span class="line"></span><br><span class="line">一对一的表关系一般用于表的拆分，将常用的字段放在一张表,不常用的字段放在另一张表,用于提升查询性能</span><br></pre></td></tr></table></figure><h4 id="6-2-2-一对多"><a href="#6-2-2-一对多" class="headerlink" title="6.2.2 一对多"></a>6.2.2 一对多</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">一对多</span><br><span class="line">如：部门和员工</span><br><span class="line">一个部门对应多个员工,一个员工对应一个部门</span><br><span class="line">实现方式：在多的一方建立外键,指向一的一方的主键</span><br></pre></td></tr></table></figure><h4 id="6-2-3-多对多"><a href="#6-2-3-多对多" class="headerlink" title="6.2.3 多对多"></a>6.2.3 多对多</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">多对多：</span><br><span class="line">如：订单和商品</span><br><span class="line">一个订单可以包含多个商品,一种商品可以属于多个订单</span><br><span class="line">实现方式：建立第三种中间表,中间表至少包含两个外键,分别关联两方的主键</span><br></pre></td></tr></table></figure><h2 id="七、多表查询"><a href="#七、多表查询" class="headerlink" title="七、多表查询"></a>七、多表查询</h2><h3 id="7-1-笛卡尔积"><a href="#7-1-笛卡尔积" class="headerlink" title="7.1 笛卡尔积"></a>7.1 笛卡尔积</h3><p>笛卡尔积，取A、B集合所有组合情况，最终查询出来的数据条数为多张表的分别记录条数的乘积,这种方式的查询会存在许多无效的数据,因此通常不会使用下面的查询方式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from A,B……</span><br></pre></td></tr></table></figure><h3 id="7-2-连接查询"><a href="#7-2-连接查询" class="headerlink" title="7.2 连接查询"></a>7.2 连接查询</h3><h4 id="7-2-1-内连接"><a href="#7-2-1-内连接" class="headerlink" title="7.2.1 内连接"></a>7.2.1 内连接</h4><p><code>内连接</code>：相当于查询A、B交集数据</p><p><strong>隐式内连接</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from A,B where A.id = B.id</span><br></pre></td></tr></table></figure><p><strong>显示内连接</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from A [inner] join B on A.id = B.id</span><br></pre></td></tr></table></figure><h4 id="7-2-2-外连接"><a href="#7-2-2-外连接" class="headerlink" title="7.2.2 外连接"></a>7.2.2 外连接</h4><p><strong>左外连接</strong></p><p><code>左外连接</code>：相当于查询A表所有数据和交集部分数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from A left [outer] join B on A.id = B.id</span><br></pre></td></tr></table></figure><p><strong>右外连接</strong></p><p><code>左外连接</code>：相当于查询B表所有数据和交集部分数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from A right [outer] join B on A.id = B.id</span><br></pre></td></tr></table></figure><h3 id="7-3-子查询"><a href="#7-3-子查询" class="headerlink" title="7.3 子查询"></a>7.3 子查询</h3><p><code>子查询</code>：查询中嵌套查询,嵌套查询为子查询。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">子查询根据查询结果不同，作用不同，可分为：</span><br><span class="line">单行单列</span><br><span class="line">多行单列</span><br><span class="line">多行多列</span><br></pre></td></tr></table></figure><h4 id="7-3-1-单行单列"><a href="#7-3-1-单行单列" class="headerlink" title="7.3.1 单行单列"></a>7.3.1 单行单列</h4><p><code>单行单列</code>: 作为条件值,使用&gt;、&#x3D;、&lt;等进行条件判断</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表 where 字段名 = (子查询)</span><br></pre></td></tr></table></figure><h4 id="7-3-2-多行单列"><a href="#7-3-2-多行单列" class="headerlink" title="7.3.2 多行单列"></a>7.3.2 多行单列</h4><p><code>多行单列</code>: 作为条件值，使用in关键字进行条件判断</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表 where 字段名 in (子查询)</span><br></pre></td></tr></table></figure><h4 id="7-3-3-多行多列"><a href="#7-3-3-多行多列" class="headerlink" title="7.3.3 多行多列"></a>7.3.3 多行多列</h4><p><code>多行多列</code>: 作为虚拟表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from (子查询) where 条件</span><br></pre></td></tr></table></figure><h2 id="八、事务"><a href="#八、事务" class="headerlink" title="八、事务"></a>八、事务</h2><h3 id="8-1-事务简介"><a href="#8-1-事务简介" class="headerlink" title="8.1 事务简介"></a>8.1 事务简介</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">数据库的事务(Transaction)是一种机制,一个操作序列,包含了一组数据库操作命令。</span><br><span class="line">事务把所有的命令看作一个整体一起向系统提交或撤销操作请求，即这组数据库命令要么同时成功，要么同时失败。</span><br><span class="line">事务是一个不可分割是工作逻辑单元</span><br></pre></td></tr></table></figure><h3 id="8-2-事务操作"><a href="#8-2-事务操作" class="headerlink" title="8.2 事务操作"></a>8.2 事务操作</h3><p><strong>开启事务</strong></p><p><code>开启事务</code>：即告诉系统，下面的数据库操作命令为临时的操作，不会真正的操作数据库中的数据，直到提交事务时才真正的对数据库进行操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">start transaction;</span><br><span class="line">或</span><br><span class="line">begin;</span><br></pre></td></tr></table></figure><p><strong>提交事务</strong></p><p><code>提交事务</code>：即告诉系统，所有的临时操作已经编写完成,可以按照临时操作对数据库中的数据进行真正的操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">commit;</span><br></pre></td></tr></table></figure><p><strong>回滚事务</strong></p><p><code>回滚事务</code>:即出现异常时,告诉系统撤销临时操作,回到开启事务前的状态</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rollback;</span><br></pre></td></tr></table></figure><h3 id="8-3-事务四大特性"><a href="#8-3-事务四大特性" class="headerlink" title="8.3 事务四大特性"></a>8.3 事务四大特性</h3><p><code>原子性 (Atomicity)</code>: 事务是不可分割的最小操作单元,要么同时成功,要么同时失败</p><p><code>一致性(Consistency)</code>: 事务完成时,必须使所有的数据都保持一致状态</p><p><code>隔离性(Isolation)</code>: 多个事务之间相互隔离，操作的可见性</p><p><code>持久性(Durability)</code>: 事务一旦提交或回滚,它对数据库中的数据的改变就是永久的 </p><h3 id="8-4-MySQL事务的提交方式"><a href="#8-4-MySQL事务的提交方式" class="headerlink" title="8.4 MySQL事务的提交方式"></a>8.4 MySQL事务的提交方式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select @@autocommit</span><br><span class="line"></span><br><span class="line">查询结果为1,表示自动提交,MySQL事务默认自动提交</span><br><span class="line">查询结果为0,表示需手动提交</span><br><span class="line"></span><br><span class="line">修改事务的提交方式:</span><br><span class="line">set @@autocommit = 1;</span><br><span class="line">set @@autocommit = 0;</span><br></pre></td></tr></table></figure><h3 id="8-5-事务的隔离级别"><a href="#8-5-事务的隔离级别" class="headerlink" title="8.5 事务的隔离级别"></a>8.5 事务的隔离级别</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据库允许多个事务并行，多个事务之间是隔离的、相互独立的；如果事务之间不相互隔离并且操作同一数据时，可能会导致数据的一致性被破坏。</span><br></pre></td></tr></table></figure><h4 id="8-5-1-读未提交-read-uncommitted"><a href="#8-5-1-读未提交-read-uncommitted" class="headerlink" title="8.5.1  读未提交(read uncommitted)"></a>8.5.1  读未提交(read uncommitted)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">T2可以读取T1执行但未提交的数据；可能会导致出现脏读;</span><br><span class="line">脏读,一个事务读取到了另一个事务中未提交的数据</span><br></pre></td></tr></table></figure><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20241013150847083.png" alt="image-20241013150847083"></p><h4 id="8-5-2-读已提交-read-committed"><a href="#8-5-2-读已提交-read-committed" class="headerlink" title="8.5.2 读已提交(read committed)"></a>8.5.2 读已提交(read committed)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">T2只能读取T1已经提交的数据;避免了脏读,但可能会导致不可重复度(虚读)</span><br><span class="line">不可重复度(虚读): 在同一个事务中，两次查询操作读取到数据不一致</span><br><span class="line">例如：T2进行第一次查询之后在第二次查询之前,T1修改并提交了数据,T2进行第二次查询时读取到的数据和第一次查询读取到数据不一致。</span><br></pre></td></tr></table></figure><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20241013151027691.png" alt="image-20241013151027691"></p><h4 id="8-5-3-可重复读-repeatable-read"><a href="#8-5-3-可重复读-repeatable-read" class="headerlink" title="8.5.3 可重复读(repeatable read)"></a>8.5.3 可重复读(repeatable read)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">T2执行第一次查询之后,在事务结束之前其他事务不能修改对应的数;避免了不可重复读(虚读)，但可能会导致幻读</span><br><span class="line">幻读,T2对数据表中的数据进行修改然后查询,在查询之前T1向数据表中新增了一条数据,就导致T2以为修改了所有数据,但却查询出了与修改不一致的数据（T1事务新增的数据）</span><br></pre></td></tr></table></figure><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20241013151201835.png" alt="image-20241013151201835"></p><h4 id="8-5-4-串行化-serializable"><a href="#8-5-4-串行化-serializable" class="headerlink" title="8.5.4 串行化(serializable)"></a>8.5.4 串行化(serializable)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">同时只允许一个事务对数据表进行操作；避免了脏读、虚读、幻读问题</span><br></pre></td></tr></table></figure><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20241013151244042.png" alt="image-20241013151244042"></p><h4 id="8-5-5-设置数据库事务隔离级别"><a href="#8-5-5-设置数据库事务隔离级别" class="headerlink" title="8.5.5 设置数据库事务隔离级别"></a>8.5.5 设置数据库事务隔离级别</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">我们可以通过设置数据库默认的事务隔离级别来控制事务之间的隔离性;</span><br><span class="line">也可以通过客户端与数据库连接设置来设置事务间的隔离性（在应用程序中设置--Spring）；</span><br><span class="line">MySQL数据库默认的隔离级别为 可重复读</span><br></pre></td></tr></table></figure><ul><li><p>查看MySQL数据库默认的隔离级别</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在MySQL8.0.3 之前</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@tx_isolation</span>;</span><br><span class="line"><span class="comment">-- 在MySQL8.0.3 之后</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@transaction_isolation</span>;</span><br></pre></td></tr></table></figure></li><li><p>设置MySQL默认隔离级别</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> session transaction isolation level 隔离级别;</span><br></pre></td></tr></table></figure></li></ul><h2 id="九、存储过程"><a href="#九、存储过程" class="headerlink" title="九、存储过程"></a>九、存储过程</h2><h3 id="9-1-SQL指令执行过程"><a href="#9-1-SQL指令执行过程" class="headerlink" title="9.1 SQL指令执行过程"></a>9.1 SQL指令执行过程</h3><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20241011214033100.png" alt="image-20241011214033100"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">从SQL执行执行的流程中我们分析存在的问题：</span><br><span class="line">1. 如果我们需要重复多次执行相同的SQL，SQL指令都需要通过连接传递到MySQL，并且需要</span><br><span class="line">经过编译和执行的步骤；</span><br><span class="line">2. 如果我们需要连续执行多个SQL指令，并且第二个SQL指令需要使用第一个SQL指令执行的</span><br><span class="line">结果作为参数；</span><br></pre></td></tr></table></figure><h3 id="9-2-存储过程介绍"><a href="#9-2-存储过程介绍" class="headerlink" title="9.2 存储过程介绍"></a>9.2 存储过程介绍</h3><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20241011214142677.png" alt="image-20241011214142677"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">存储过程：</span><br><span class="line">将能够完成特定功能的SQL指令进行封装（SQL指令集）,编译之后存储在数据库服务器</span><br><span class="line">上，并且为之取一个名字，客户端可以通过名字直接调用这个SQL指令集，获取执行结果。</span><br></pre></td></tr></table></figure><h3 id="9-3-存储过程优缺点分析"><a href="#9-3-存储过程优缺点分析" class="headerlink" title="9.3 存储过程优缺点分析"></a>9.3 存储过程优缺点分析</h3><p><strong>存储过程优点</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. SQL指令无需客户端编写，通过网络传送，可以节省网络开销，同时避免SQL指令在网络传</span><br><span class="line">输过程中被恶意篡改保证安全性；</span><br><span class="line">2. 存储过程经过编译创建并保存在数据库中的，执行过程无需重复的进行编译操作，对SQL指</span><br><span class="line">令的执行过程进行了性能提升；</span><br><span class="line">3. 存储过程中多个SQL指令之间存在逻辑关系，支持流程控制语句（分支、循环），可以实现</span><br><span class="line">更为复杂的业务;</span><br></pre></td></tr></table></figure><p><strong>存储过程缺点</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 存储过程是根据不同的数据库进行编译、创建并存储在数据库中；当我们需要切换到其他的</span><br><span class="line">数据库产品时，需要重写编写针对于新数据库的存储过程；</span><br><span class="line">2. 存储过程受限于数据库产品，如果需要高性能的优化会成为一个问题；</span><br><span class="line">3. 在互联网项目中，如果需要数据库的高（连接）并发访问，使用存储过程会增加数据库的连</span><br><span class="line">接执行时间（因为我们将复杂的业务交给了数据库进行处理）</span><br></pre></td></tr></table></figure><h3 id="9-4-创建存储过程"><a href="#9-4-创建存储过程" class="headerlink" title="9.4 创建存储过程"></a>9.4 创建存储过程</h3><p><strong>语法</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> 存储过程名称([<span class="keyword">IN</span><span class="operator">/</span><span class="keyword">OUT</span> args])</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">      <span class="comment">-- SQL</span></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p><strong>示例</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个存储过程实现加法运算:</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test1(<span class="keyword">IN</span> a <span class="type">int</span>,<span class="keyword">IN</span> b <span class="type">int</span>,<span class="keyword">OUT</span> c <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">SET</span> c <span class="operator">=</span> a<span class="operator">+</span>b;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h3 id="9-5-调用存储过程"><a href="#9-5-调用存储过程" class="headerlink" title="9.5 调用存储过程"></a>9.5 调用存储过程</h3><p><strong>语法</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">call</span> 存储过程名称(args……)</span><br></pre></td></tr></table></figure><p><strong>示例</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 调用存储过程</span></span><br><span class="line"><span class="comment">-- 定义变量@m</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@m</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">-- 调用存储过程，将3传递给a，将2传递给b，将@m传递给c</span></span><br><span class="line"><span class="keyword">call</span> proc_test1(<span class="number">3</span>,<span class="number">2</span>,<span class="variable">@m</span>);</span><br><span class="line"><span class="comment">-- 显示变量值（dual系统表，无需创建，定义变量的值都会在这里）</span></span><br><span class="line"><span class="keyword">select</span> <span class="variable">@m</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><h3 id="9-6-存储过程中的变量"><a href="#9-6-存储过程中的变量" class="headerlink" title="9.6 存储过程中的变量"></a>9.6 存储过程中的变量</h3><blockquote><p>存储过程中的变量分为两种：局部变量 和 用户变量</p></blockquote><h4 id="9-6-1-定义局部变量"><a href="#9-6-1-定义局部变量" class="headerlink" title="9.6.1 定义局部变量"></a>9.6.1 定义局部变量</h4><p><strong>语法</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 局部变量要定义在存储过程中，而且必须定义在存储过程开始</span></span><br><span class="line"><span class="keyword">declare</span> 参数名 参数类型 [<span class="keyword">default</span> 默认值];</span><br></pre></td></tr></table></figure><p><strong>示例</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test2(<span class="keyword">IN</span> a <span class="type">int</span>,<span class="keyword">OUT</span> r <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"> <span class="keyword">declare</span> x <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;  <span class="comment">-- 定义x  int类型，默认值为0</span></span><br><span class="line"> <span class="keyword">declare</span> y <span class="type">int</span> <span class="keyword">default</span> <span class="number">1</span>;  <span class="comment">-- 定义y</span></span><br><span class="line"> <span class="keyword">set</span> x <span class="operator">=</span> a<span class="operator">*</span>a;</span><br><span class="line"> <span class="keyword">set</span> y <span class="operator">=</span> a<span class="operator">/</span><span class="number">2</span>; </span><br><span class="line"> <span class="keyword">set</span> r <span class="operator">=</span> x<span class="operator">+</span>y;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h4 id="9-6-2-定义用户变量"><a href="#9-6-2-定义用户变量" class="headerlink" title="9.6.2 定义用户变量"></a>9.6.2 定义用户变量</h4><blockquote><p>用户变量：相当于全局变量，定义的用户变量可以通过 select @attrName from dual 进行查询</p></blockquote><p><strong>语法</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 用户变量会存储在mysql数据库的数据字典中（dual）</span></span><br><span class="line"><span class="comment">-- 用户变量定义使用set关键字直接定义，变量名要以@开头</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@n</span><span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure><h4 id="9-6-3-给变量赋值"><a href="#9-6-3-给变量赋值" class="headerlink" title="9.6.3 给变量赋值"></a>9.6.3 给变量赋值</h4><blockquote><p>无论是局部变量还是用户变量，都是使用 set 关键字修改值</p></blockquote><p><strong>语法</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> 变量名<span class="operator">=</span>值</span><br></pre></td></tr></table></figure><p><strong>示例</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set @n=1;</span><br><span class="line">call proc_test2(6,@n);</span><br><span class="line">select @n from dual;</span><br></pre></td></tr></table></figure><h4 id="9-6-4-将查询结果赋值给变量"><a href="#9-6-4-将查询结果赋值给变量" class="headerlink" title="9.6.4 将查询结果赋值给变量"></a>9.6.4 将查询结果赋值给变量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在存储过程中使用select..into..给变量赋值</span><br></pre></td></tr></table></figure><p><strong>示例</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询学生数量</span></span><br><span class="line"><span class="comment">-- 注意在储存过程中使用SQL语句需要将结果赋值给变量，那么就需要使用into关键字来进</span></span><br><span class="line">行赋值</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test3(<span class="keyword">OUT</span> c <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">select</span> <span class="built_in">count</span>(stu_num) <span class="keyword">INTO</span> c <span class="keyword">from</span> students; <span class="comment">-- 将查询到学生数量赋值给c</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">-- 调用存储过程</span></span><br><span class="line"><span class="keyword">call</span> proc_test3(<span class="variable">@n</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@n</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><h4 id="9-6-5-用户变量使用注意事项"><a href="#9-6-5-用户变量使用注意事项" class="headerlink" title="9.6.5 用户变量使用注意事项"></a>9.6.5 用户变量使用注意事项</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">因为用户变量相当于全局变量，可以在SQL指令以及多个存储过程中共享，在开发中建议尽量少使用用户变量，用户变量过多会导致程序不易理解、难以维护。</span><br></pre></td></tr></table></figure><h3 id="9-7-存储过程的参数"><a href="#9-7-存储过程的参数" class="headerlink" title="9.7 存储过程的参数"></a>9.7 存储过程的参数</h3><blockquote><p>MySQL存储过程的参数一共有三种：IN  \  OUT  \  INOUT</p></blockquote><h4 id="9-7-1-IN-输入参数"><a href="#9-7-1-IN-输入参数" class="headerlink" title="9.7.1 IN 输入参数"></a>9.7.1 IN 输入参数</h4><blockquote><p>输入参数——在调用存储过程中传递数据给存储过程的参数（在调用的过程必须为具有实际值的 变量 或者  字面值）</p></blockquote><p><strong>示例</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建存储过程：添加学生信息</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test4(<span class="keyword">IN</span> snum <span class="type">char</span>(<span class="number">8</span>),<span class="keyword">IN</span> sname <span class="type">varchar</span>(<span class="number">20</span>), <span class="keyword">IN</span> gender <span class="type">char</span>(<span class="number">2</span>), <span class="keyword">IN</span> age <span class="type">int</span>, <span class="keyword">IN</span> cid <span class="type">int</span>, <span class="keyword">IN</span> remark <span class="type">varchar</span>(<span class="number">255</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">insert into</span> students(stu_num,stu_name,stu_gender,stu_age,cid,remark)</span><br><span class="line">    <span class="keyword">values</span>(snum,sname,gender,age,cid,remark);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test4(<span class="string">&#x27;20220108&#x27;</span>,<span class="string">&#x27;小丽&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">20</span>,<span class="number">1</span>,<span class="string">&#x27;aaa&#x27;</span>);</span><br></pre></td></tr></table></figure><h4 id="9-7-2-OUT-输出参数"><a href="#9-7-2-OUT-输出参数" class="headerlink" title="9.7.2 OUT 输出参数"></a>9.7.2 OUT 输出参数</h4><blockquote><p>输出参数——将存储过程中产生的数据返回给过程调用者，相当于Java方法的返回值，但不同的是一个存储过程可以有多个输出参数</p></blockquote><p><strong>示例</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建存储过程，根据学生学号，查询学生姓名</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test5(<span class="keyword">IN</span> snum <span class="type">char</span>(<span class="number">8</span>),<span class="keyword">OUT</span> sname <span class="type">varchar</span>(<span class="number">20</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">select</span> stu_name <span class="keyword">INTO</span> sname <span class="keyword">from</span> students <span class="keyword">where</span> stu_num<span class="operator">=</span>snum;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@name</span><span class="operator">=</span><span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test5(<span class="string">&#x27;20220107&#x27;</span>,<span class="variable">@name</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@name</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><h4 id="9-7-3-INOUT-输入输出参数"><a href="#9-7-3-INOUT-输入输出参数" class="headerlink" title="9.7.3 INOUT 输入输出参数"></a>9.7.3 INOUT 输入输出参数</h4><blockquote><p>输入输出参数——该类型的参数既是输入参数也是输入参数。注意：此方式不建议使用，一般我们输入就用 IN 输出就用OUT，此参数代码可读性低，容易混淆。</p></blockquote><p><strong>示例</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test6(<span class="keyword">INOUT</span> str <span class="type">varchar</span>(<span class="number">20</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">select</span> stu_name <span class="keyword">INTO</span> str <span class="keyword">from</span> students <span class="keyword">where</span> stu_num<span class="operator">=</span>str;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@name</span><span class="operator">=</span><span class="string">&#x27;20220108&#x27;</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test6(<span class="variable">@name</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@name</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><h3 id="9-8-存储过程中的流程控制"><a href="#9-8-存储过程中的流程控制" class="headerlink" title="9.8 存储过程中的流程控制"></a>9.8 存储过程中的流程控制</h3><h4 id="9-8-1-分支语句"><a href="#9-8-1-分支语句" class="headerlink" title="9.8.1 分支语句"></a>9.8.1 分支语句</h4><ul><li>if-then-else</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 单分支：如果条件成立，则执行SQL</span></span><br><span class="line">if conditions <span class="keyword">then</span></span><br><span class="line">    <span class="comment">-- SQL</span></span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line"><span class="comment">-- 如果参数a的值为1，则添加一条班级信息</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test7(<span class="keyword">IN</span> a <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     if a<span class="operator">=</span><span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">insert into</span> classes(class_name,remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2209&#x27;</span>,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">     <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 双分支：如果条件成立则执行SQL1，否则执行SQL2</span></span><br><span class="line">if conditions <span class="keyword">then</span></span><br><span class="line">    <span class="comment">-- SQL1</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="comment">-- SQL2</span></span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line"><span class="comment">-- 如果参数a的值为1，则添加一条班级信息；否则添加一条学生信息</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test7(<span class="keyword">IN</span> a <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">     if a<span class="operator">=</span><span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">insert into</span> classes(class_name,remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2209&#x27;</span>,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">insert into</span> students(stu_num,stu_name,stu_gender,stu_age,cid,remark) <span class="keyword">values</span>(<span class="string">&#x27;20220110&#x27;</span>,<span class="string">&#x27;小花&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">19</span>,<span class="number">1</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line">     <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><ul><li>case</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- case</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test8(<span class="keyword">IN</span> a <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">case</span> a</span><br><span class="line">    <span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span>  </span><br><span class="line">        <span class="comment">-- SQL1   如果a的值为1  则执行SQL1</span></span><br><span class="line">        <span class="keyword">insert into</span> classes(class_name,remark) <span class="keyword">values</span>(<span class="string">&#x27;Java2210&#x27;</span>,<span class="string">&#x27;wahaha&#x27;</span>);</span><br><span class="line">    <span class="keyword">when</span> <span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- SQL2   如果a的值为2  则执行SQL2</span></span><br><span class="line">        <span class="keyword">insert into</span> students(stu_num,stu_name,stu_gender,stu_age,cid,remark) <span class="keyword">values</span>(<span class="string">&#x27;20220111&#x27;</span>,<span class="string">&#x27;小刚&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="number">2</span>,<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">-- SQL (如果变量的值和所有when的值都不匹配，则执行else中的这个SQL)</span></span><br><span class="line">        <span class="keyword">update</span> students <span class="keyword">set</span> stu_age<span class="operator">=</span><span class="number">18</span> <span class="keyword">where</span> stu_num<span class="operator">=</span><span class="string">&#x27;20220110&#x27;</span>;</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">case</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h4 id="9-8-2-循环语句"><a href="#9-8-2-循环语句" class="headerlink" title="9.8.2 循环语句"></a>9.8.2 循环语句</h4><ul><li>while</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- while</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test9(<span class="keyword">IN</span> num <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">declare</span> i <span class="type">int</span>;</span><br><span class="line">    <span class="keyword">set</span> i <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    while i<span class="operator">&lt;</span>num do</span><br><span class="line">            <span class="comment">-- SQL</span></span><br><span class="line">            <span class="keyword">insert into</span> classes(class_name,remark) <span class="keyword">values</span>( CONCAT(<span class="string">&#x27;Java&#x27;</span>,i) </span><br><span class="line">,<span class="string">&#x27;....&#x27;</span>);</span><br><span class="line">            <span class="keyword">set</span> i <span class="operator">=</span> i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span> while;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test9(<span class="number">4</span>);</span><br></pre></td></tr></table></figure><ul><li>repeat</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- repeat</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test10(<span class="keyword">IN</span> num <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">declare</span> i <span class="type">int</span>;</span><br><span class="line">    <span class="keyword">set</span> i <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    repeat</span><br><span class="line">        <span class="comment">-- SQL</span></span><br><span class="line">        <span class="keyword">insert into</span> classes(class_name,remark) <span class="keyword">values</span>( CONCAT(<span class="string">&#x27;Python&#x27;</span>,i) </span><br><span class="line">,<span class="string">&#x27;....&#x27;</span>);</span><br><span class="line">        <span class="keyword">set</span> i <span class="operator">=</span> i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">    until i <span class="operator">&gt;</span> num <span class="keyword">end</span> repeat;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test10(<span class="number">4</span>);</span><br></pre></td></tr></table></figure><ul><li>loop</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- loop</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test11(<span class="keyword">IN</span> num <span class="type">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="keyword">declare</span> i <span class="type">int</span> ;</span><br><span class="line">     <span class="keyword">set</span> i <span class="operator">=</span><span class="number">0</span>;</span><br><span class="line">     myloop:loop</span><br><span class="line">            <span class="comment">-- SQL</span></span><br><span class="line">            <span class="keyword">insert into</span> classes(class_name,remark) <span class="keyword">values</span>( CONCAT(<span class="string">&#x27;HTML&#x27;</span>,i) </span><br><span class="line">,<span class="string">&#x27;....&#x27;</span>);</span><br><span class="line">            <span class="keyword">set</span> i <span class="operator">=</span> i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">            # 结束循环的条件</span><br><span class="line">            if i<span class="operator">=</span>num <span class="keyword">then</span></span><br><span class="line">               # 离开循环</span><br><span class="line">               leave myloop;</span><br><span class="line">            <span class="keyword">end</span> if;</span><br><span class="line">     <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test11(<span class="number">5</span>);</span><br></pre></td></tr></table></figure><h3 id="9-9-查询存储过程"><a href="#9-9-查询存储过程" class="headerlink" title="9.9 查询存储过程"></a>9.9 查询存储过程</h3><blockquote><p>存储过程是属于某个数据库的，也就是说当我们将存储过程创建在某个数据库之后，只能在当前数据库中调用此存储过程。<br>查询存储过程：查询某个数据库中有哪些存储过程</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有存储过程</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">procedure</span>;</span><br><span class="line"><span class="comment">-- 根据数据库名，查询当前数据库中的存储过程</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">procedure</span> status <span class="keyword">where</span> db<span class="operator">=</span><span class="string">&#x27;db_test2&#x27;</span>;</span><br><span class="line"><span class="comment">-- 查询存储过程的创建细节</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">procedure</span> db_test2.proc_test1;</span><br></pre></td></tr></table></figure><h3 id="9-10-修改存储过程"><a href="#9-10-修改存储过程" class="headerlink" title="9.10 修改存储过程"></a>9.10 修改存储过程</h3><blockquote><p>修改存储过程指的是修改存储过程的特征&#x2F;特性</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">procedure</span> 存储过程名称 特征<span class="number">1</span> [特征<span class="number">2</span> 特征<span class="number">3</span> ....]</span><br></pre></td></tr></table></figure><p><strong>存储过程的特征参数：</strong></p><ul><li><p>CONTAINS SQL  表示子程序包含 SQL 语句，但不包含读或写数据的语句</p></li><li><p>NO SQL  表示子程序中不包含 SQL 语句</p></li><li><p>READS SQL DATA  表示子程序中包含读数据的语句</p></li><li><p>MODIFIES SQL DATA  表示子程序中包含写数据的语句</p></li><li><p>SQL SECURITY  { DEFINER |INVOKER } 指明谁有权限来执行</p></li><li><p>DEFINER 表示只有定义者自己才能够执行</p></li><li><p>INVOKER 表示调用者可以执行</p></li><li><p>COMMENT ‘string’  表示注释信息</p></li></ul><h3 id="9-11-删除存储过程"><a href="#9-11-删除存储过程" class="headerlink" title="9.11 删除存储过程"></a>9.11 删除存储过程</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除存储过程</span></span><br><span class="line"><span class="comment">-- drop 删除数据库中的对象 数据库、数据表、列、存储过程、视图、触发器、索引....</span></span><br><span class="line"><span class="comment">-- delete 删除数据表中的数据</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">procedure</span> 存储过程名称;</span><br></pre></td></tr></table></figure><h3 id="9-12-游标"><a href="#9-12-游标" class="headerlink" title="9.12 游标"></a>9.12 游标</h3><blockquote><p>问题：如果我们要创建一个存储过程，需要返回查询语句查询到的多条数据，该如何实现呢？</p></blockquote><h4 id="9-12-1-游标的概念"><a href="#9-12-1-游标的概念" class="headerlink" title="9.12.1 游标的概念"></a>9.12.1 游标的概念</h4><blockquote><p>游标可以用来依次取出查询结果集中的每一条数据——逐条读取查询结果集中的记录</p></blockquote><h4 id="9-12-2-游标使用步骤"><a href="#9-12-2-游标使用步骤" class="headerlink" title="9.12.2 游标使用步骤"></a>9.12.2 游标使用步骤</h4><p><strong>声明游标</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 声明游标语法</span></span><br><span class="line"><span class="keyword">DECLARE</span> 游标名称 <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> select_statement;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 示例</span></span><br><span class="line"><span class="keyword">declare</span> mycursor <span class="keyword">cursor</span> <span class="keyword">for</span> <span class="keyword">select</span> class_id,class_name <span class="keyword">from</span> classes;</span><br></pre></td></tr></table></figure><p><strong>打开游标</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法</span></span><br><span class="line"><span class="keyword">open</span> 游标名称;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 示例</span></span><br><span class="line"><span class="keyword">open</span> mycursor;</span><br></pre></td></tr></table></figure><p><strong>使用游标</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法</span></span><br><span class="line"><span class="comment">-- 使用游标：提取游标当前指向的记录（提取之后，游标自动下移）</span></span><br><span class="line"><span class="keyword">fetch</span> 游标名称 <span class="keyword">into</span> xxx,yyy;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 示例</span></span><br><span class="line"><span class="keyword">fetch</span> mycursor <span class="keyword">into</span> cid,cname;</span><br></pre></td></tr></table></figure><p><strong>关闭游标</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法</span></span><br><span class="line"><span class="keyword">CLOSE</span> 游标名称; </span><br><span class="line"></span><br><span class="line"><span class="comment">-- 示例</span></span><br><span class="line"><span class="keyword">CLOSE</span> mycursor; </span><br></pre></td></tr></table></figure><h4 id="9-12-3-游标使用案例"><a href="#9-12-3-游标使用案例" class="headerlink" title="9.12.3 游标使用案例"></a>9.12.3 游标使用案例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL中， Concat_WS()  函数 用来通过指定符号，将2个或多个字段拼接在一起，返回拼接后的字符串。</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> proc_test12(<span class="keyword">out</span> <span class="keyword">result</span> <span class="type">varchar</span>(<span class="number">200</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    # 游标变量</span><br><span class="line">    <span class="keyword">declare</span> cid <span class="type">int</span>;</span><br><span class="line">    # 游标变量</span><br><span class="line">    <span class="keyword">declare</span> cname <span class="type">varchar</span>(<span class="number">20</span>);</span><br><span class="line">    # 计数变量</span><br><span class="line">    <span class="keyword">declare</span> num <span class="type">int</span>;</span><br><span class="line">    # 计数变量</span><br><span class="line">    <span class="keyword">declare</span> i <span class="type">int</span>;</span><br><span class="line">    # 每条数据</span><br><span class="line">    <span class="keyword">declare</span> str <span class="type">varchar</span>(<span class="number">100</span>);</span><br><span class="line">    # 查询语句执行之后返回的是一个结果集（多条记录），使用游标遍历查询结果集</span><br><span class="line">    <span class="keyword">declare</span> mycursor <span class="keyword">cursor</span> <span class="keyword">for</span> <span class="keyword">select</span> class_id,class_name <span class="keyword">from</span> classes;</span><br><span class="line">    # 记录总数据量</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">into</span> num <span class="keyword">from</span> classes;</span><br><span class="line">    # 打开游标</span><br><span class="line">    <span class="keyword">open</span> mycursor;</span><br><span class="line">    <span class="keyword">set</span> i <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    # 开始遍历游标</span><br><span class="line">    while i<span class="operator">&lt;</span>num do</span><br><span class="line">        # 提取游标中的数据，并将结果赋值给游标变量</span><br><span class="line">        <span class="keyword">fetch</span> mycursor <span class="keyword">into</span> cid,cname;</span><br><span class="line">        <span class="keyword">set</span> i <span class="operator">=</span> i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">        # <span class="keyword">set</span> str<span class="operator">=</span>concat_ws(<span class="string">&#x27;~&#x27;</span>,cid,cname); 不同的写法</span><br><span class="line">        <span class="keyword">select</span> concat_ws(<span class="string">&#x27;~&#x27;</span>,cid,cname) <span class="keyword">into</span> str;</span><br><span class="line">        <span class="keyword">set</span> <span class="keyword">result</span> <span class="operator">=</span> concat_ws(<span class="string">&#x27;,&#x27;</span>,<span class="keyword">result</span>,str);</span><br><span class="line">    <span class="keyword">end</span> while;</span><br><span class="line">    <span class="keyword">close</span> mycursor;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"># 案例测试</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@r</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">call</span> proc_test12(<span class="variable">@r</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@r</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><h2 id="十、触发器"><a href="#十、触发器" class="headerlink" title="十、触发器"></a>十、触发器</h2><h3 id="10-1-触发器介绍"><a href="#10-1-触发器介绍" class="headerlink" title="10.1 触发器介绍"></a>10.1 触发器介绍</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">触发器，就是一种特殊的存储过程。触发器和存储过程一样是一个能够完成特定功能、存储在数据库服务器上的SQL片段，但是触发器无需调用，当对数据表中的数据执行DML操作时自动触发</span><br><span class="line">这个SQL片段的执行，无需手动调用。在MySQL,只有执行insert\delete\update操作才能触发触发器的执行</span><br></pre></td></tr></table></figure><h3 id="10-2-创建触发器"><a href="#10-2-创建触发器" class="headerlink" title="10.2 创建触发器"></a>10.2 创建触发器</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> 触发器名称</span><br><span class="line"><span class="operator">&lt;</span>before<span class="operator">|</span>after<span class="operator">&gt;</span>                     <span class="comment">-- 定义触发时机</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">insert</span><span class="operator">|</span><span class="keyword">delete</span><span class="operator">|</span><span class="keyword">update</span><span class="operator">&gt;</span>             <span class="comment">-- 定义DML类型</span></span><br><span class="line"><span class="keyword">ON</span> 表名</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span>                       <span class="comment">-- 声明为行级触发器（只要操作一条记录就触发触发器执行一次）</span></span><br><span class="line">sql_statement                      <span class="comment">-- 触发器操作</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 示例</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_test1</span><br><span class="line">after <span class="keyword">insert</span> <span class="keyword">on</span> students</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">insert into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(), concat(<span class="string">&#x27;添加&#x27;</span>,NEW.stu_num,<span class="string">&#x27;学生信息&#x27;</span>));</span><br></pre></td></tr></table></figure><h3 id="10-3-查看触发器"><a href="#10-3-查看触发器" class="headerlink" title="10.3 查看触发器"></a>10.3 查看触发器</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> triggers;</span><br></pre></td></tr></table></figure><h3 id="10-4-删除触发器"><a href="#10-4-删除触发器" class="headerlink" title="10.4 删除触发器"></a>10.4 删除触发器</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> 触发器名称;</span><br></pre></td></tr></table></figure><h3 id="10-5-NEW与OLD"><a href="#10-5-NEW与OLD" class="headerlink" title="10.5 NEW与OLD"></a>10.5 NEW与OLD</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">触发器用于监听对数据表中数据的insert、delete、update操作,在触发器中通常处理一些DML的关联操作;我们可以使用 NEW 和 OLD 关键字在触发器中获取触发这个触发器的DML操作的数据</span><br><span class="line">NEW: 在触发器中用于获取insert操作添加的数据、update操作修改后的记录</span><br><span class="line">OLD: 在触发器中用于获取delete操作删除前的数据、update操作修改前的数据</span><br></pre></td></tr></table></figure><p><strong>NEW</strong></p><ul><li>insert操作中：NEW表示添加的新记录</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_test1</span><br><span class="line">after <span class="keyword">insert</span> <span class="keyword">on</span> students</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">insert into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(), concat(<span class="string">&#x27;添加&#x27;</span>,NEW.stu_num,<span class="string">&#x27;学生信息&#x27;</span>));</span><br></pre></td></tr></table></figure><ul><li>update操作中：NEW 表示修改后的数据</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建触发器 : 在监听update操作的触发器中，可以使用NEW获取修改后的数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_test2</span><br><span class="line">after <span class="keyword">update</span> <span class="keyword">on</span> students <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">insert into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(), concat(<span class="string">&#x27;修改学生信息为：&#x27;</span>,NEW.stu_num,NEW.stu_name));</span><br></pre></td></tr></table></figure><p><strong>OLD</strong></p><ul><li>delete操作中：OLD表示删除的记录</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_test3</span><br><span class="line">after <span class="keyword">delete</span> <span class="keyword">on</span> students <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">insert into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(), concat(<span class="string">&#x27;删除&#x27;</span>,OLD.stu_num,<span class="string">&#x27;学生信息&#x27;</span>));</span><br></pre></td></tr></table></figure><ul><li>update操作中：OLD表示修改前的记录</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_test2</span><br><span class="line">after <span class="keyword">update</span> <span class="keyword">on</span> students <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">insert into</span> stulogs(<span class="type">time</span>,log_text) <span class="keyword">values</span>(now(), concat(<span class="string">&#x27;将学生姓名从【&#x27;</span>,OLD.stu_name,<span class="string">&#x27;】修改为【&#x27;</span>,NEW.stu_name,<span class="string">&#x27;】&#x27;</span>));</span><br></pre></td></tr></table></figure><h3 id="10-6-触发器使用终结"><a href="#10-6-触发器使用终结" class="headerlink" title="10.6 触发器使用终结"></a>10.6 触发器使用终结</h3><p><strong>优点</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">触发器是自动执行的,当对触发器相关的表执行响应的DML操作时立即执行;</span><br><span class="line">触发器可以实现表中的数据的级联操作(关联操作),有利于保证数据的完整性;</span><br><span class="line">触发器可以对DML操作的数据进行更为复杂的合法性校验(比如校验学员年龄)</span><br></pre></td></tr></table></figure><p><strong>缺点</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用触发器实现的业务逻辑如果出现问题将难以定位,后期维护困难;</span><br><span class="line">大量使用触发器容易导致代码结构杂乱,增加了程序的复杂;</span><br><span class="line">当触发器操作的数据量比较大时,执行效率会大大降低。</span><br></pre></td></tr></table></figure><p><strong>使用建议</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在互联网项目中，应避免使用触发器；</span><br><span class="line">对于并发量不大的项目可以选择使用存储过程，但是在互联网引用中不提倡使用存储过程（原因：存储过程时将实现业务的逻辑交给数据库处理，一则增减了数据库的负载，二则不利于数据库的迁移）</span><br></pre></td></tr></table></figure><h2 id="十一、视图"><a href="#十一、视图" class="headerlink" title="十一、视图"></a>十一、视图</h2><h3 id="11-1-视图的概念"><a href="#11-1-视图的概念" class="headerlink" title="11.1 视图的概念"></a>11.1 视图的概念</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">视图，就是由数据库中一张表或者多张表根据特定的条件查询出得数据构造成得虚拟表</span><br></pre></td></tr></table></figure><h3 id="11-2-视图的作用"><a href="#11-2-视图的作用" class="headerlink" title="11.2 视图的作用"></a>11.2 视图的作用</h3><ul><li><p><strong>安全性</strong>：如果我们直接将数据表授权给用户操作，那么用户可以CRUD数据表中所有数据，加入我们想要对数据表中的部分数据进行保护，可以将公开的数据生成视图，授权用户访问视图；用户通过查询视图可以获取数据表中公开的数据，从而达到将数据表中的部分数据对用户隐藏。</p></li><li><p><strong>简单性</strong>：如果我们需要查询的数据来源于多张数据表，可以使用多表连接查询来实现；我们通过视图将这些连表查询的结果对用户开放，用户则可以直接通过查询视图获取多表数据，操作更便捷。</p></li></ul><h3 id="11-3-创建视图"><a href="#11-3-创建视图" class="headerlink" title="11.3 创建视图"></a>11.3 创建视图</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> 视图名称</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">select_statement</span><br></pre></td></tr></table></figure><h3 id="11-4-查看视图"><a href="#11-4-查看视图" class="headerlink" title="11.4 查看视图"></a>11.4 查看视图</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询视图结构</span></span><br><span class="line"><span class="keyword">desc</span> 视图名称;</span><br></pre></td></tr></table></figure><h3 id="11-5-修改视图"><a href="#11-5-修改视图" class="headerlink" title="11.5 修改视图"></a>11.5 修改视图</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式1</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">OR</span> REPLACE <span class="keyword">view</span> 视图名称</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">select_statement</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">view</span> 视图名称</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">select_statement</span><br></pre></td></tr></table></figure><h3 id="11-6-删除视图"><a href="#11-6-删除视图" class="headerlink" title="11.6 删除视图"></a>11.6 删除视图</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> 视图名称;</span><br></pre></td></tr></table></figure><h3 id="11-7-视图数据的特性"><a href="#11-7-视图数据的特性" class="headerlink" title="11.7 视图数据的特性"></a>11.7 视图数据的特性</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">视图是虚拟表，查询视图的数据是来源于数据表的。当对视图进行操作时，对原数据表中的数据是否由影响呢？</span><br></pre></td></tr></table></figure><p><strong>查询操作</strong>：如果在原表中添加了新的数据，而且这个数据满足创建视图时查询语句的条件，通过查询视图也可以查询出新增的数据；当删除原表中满足查询条件的数据时，也会从视图中删除。</p><p><strong>新增数据</strong>：如果在视图中添加数据，数据会被添加到原数据表</p><p><strong>删除数据</strong>：如果从视图删除数据，数据也将从原表中删除</p><p><strong>修改操作</strong>：如果通过修改数据，则也将修改原数据表中的数据</p><p><code>视图的使用建议</code> : 对复杂查询简化操作，并且不会对数据进行修改的情况下可以使用视图。</p><h2 id="十二、索引"><a href="#十二、索引" class="headerlink" title="十二、索引"></a>十二、索引</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据库是用来存储数据，在互联网应用中数据库中存储的数据可能会很多(大数据),数据表中数据的查询速度会随着数据量的增长逐渐变慢 ，从而导致响应用户请求的速度变慢——用户体验差，我们如何提高数据库的查询效率呢？</span><br></pre></td></tr></table></figure><h3 id="12-1-索引介绍"><a href="#12-1-索引介绍" class="headerlink" title="12.1 索引介绍"></a>12.1 索引介绍</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">索引，就是用来提高数据表中数据的查询效率的。</span><br><span class="line">索引，就是将数据表中某一列/某几列的值取出来构造成便于查找的结构进行存储，生成数据表的目录</span><br><span class="line">当我们进行数据查询的时候，则先在目录中进行查找得到对应的数据的地址，然后再到数据表中根据地址快速的获取数据记录，避免全表扫描。</span><br></pre></td></tr></table></figure><p><img src="/../images/MySQL%E6%95%99%E7%A8%8B/image-20241013140940147.png" alt="image-20241013140940147"></p><h3 id="12-2-索引分类"><a href="#12-2-索引分类" class="headerlink" title="12.2 索引分类"></a>12.2 索引分类</h3><ul><li>主键索引：在数据表的主键字段创建的索引，这个字段必须被primary key修饰，每张表只能有一个主键</li><li>唯一索引：在数据表中的唯一列创建的索引(unique)，此列的所有值只能出现一次，可以为NULL</li><li>普通索引：在普通字段上创建的索引，没有唯一性的限制</li><li>组合索引：两个及以上字段联合起来创建的索引</li></ul><p><code>说明:</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 在创建数据表时,将字段声明为主键(添加主键约束),会自动在主键字段创建主键索引;</span><br><span class="line">2. 在创建数据表时,将字段声明为唯一键(添加唯一约束),会自动在唯一字段创建唯一索引;</span><br></pre></td></tr></table></figure><h3 id="12-3-创建索引"><a href="#12-3-创建索引" class="headerlink" title="12.3 创建索引"></a>12.3 创建索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建唯一索引: 创建唯一索引的列的值不能重复</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">unique</span> index 索引名 <span class="keyword">on</span> 表名(列名);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建普通索引: 不要求创建索引的列的值的唯一性</span></span><br><span class="line"><span class="keyword">create</span> index 索引名 <span class="keyword">on</span> 表名(列名);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建组合索引</span></span><br><span class="line"><span class="keyword">create</span> index 索引名 <span class="keyword">on</span> 表名(列名<span class="number">1</span>,列名<span class="number">2.</span>..);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 全文索引(了解即可),MySQL 5.6 版本新增的索引，可以通过此索引进行全文检索操作，因为MySQL全文检索不支持中文，因此这个全文索引不被开发者关注，在应用开发中通常是通过搜索引擎（数据库中间件）实现全文检索</span></span><br><span class="line"><span class="keyword">create</span> fulltext index 索引名 <span class="keyword">on</span> 表名(字段名);</span><br></pre></td></tr></table></figure><h3 id="12-4-查看索引"><a href="#12-4-查看索引" class="headerlink" title="12.4 查看索引"></a>12.4 查看索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询索引</span></span><br><span class="line"><span class="keyword">show</span> keys <span class="keyword">from</span> 表名;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询数据表的索引</span></span><br><span class="line"><span class="keyword">show</span> indexes <span class="keyword">from</span> 表名;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 通过创建表的语句查看索引</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create table</span> 表名;</span><br></pre></td></tr></table></figure><h3 id="12-5-删除索引"><a href="#12-5-删除索引" class="headerlink" title="12.5 删除索引"></a>12.5 删除索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除索引: 索引是建立在表的字段上的,不同的表中可能会出现相同名称的索引,因此删除索引时需要指定表名</span></span><br><span class="line"><span class="keyword">drop</span> index 索引名 <span class="keyword">on</span> 表名;</span><br></pre></td></tr></table></figure><h3 id="12-6-索引的使用"><a href="#12-6-索引的使用" class="headerlink" title="12.6 索引的使用"></a>12.6 索引的使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">索引创建完成之后无需调用,当根据创建索引的列进行数据查询的时候,会自动使用索引;</span><br><span class="line">组合索引需要根据创建索引的所有字段进行查询时触发（例如: tid=250000 and name=&#x27;aaa&#x27;）。</span><br></pre></td></tr></table></figure><p><code>在命令行窗口中可以查看查询语句的查询规划：</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain select_statement</span><br></pre></td></tr></table></figure><h3 id="12-7-索引的使用总结"><a href="#12-7-索引的使用总结" class="headerlink" title="12.7 索引的使用总结"></a>12.7 索引的使用总结</h3><p><strong>优点</strong></p><ul><li>索引大大降低了数据库服务器在执行查询操作时扫描的数据量，提高查询效率</li><li>索引可以避免服务器排序、将随机IO变成顺序IO</li></ul><p><strong>缺点</strong></p><ul><li>索引是根据数据表列的创建的，当数据表中数据发生DML操作时，索引页需要更新；</li><li>索引文件也会占用磁盘空间；</li></ul><p><strong>注意事项</strong></p><ul><li>数据表中数据不多时，全表扫面可能更快，不要使用索引；</li><li>数据量大但是DML操作很频繁时，不建议使用索引；</li><li>不要在数据重复度高的列上创建索引（性别）；</li><li>创建索引之后，要注意查询SQL语句的编写，避免索引失效。</li></ul>]]></content>
    
    
    <summary type="html">MYSQL的相关概念、安装、SQL、多表查询以及事务等</summary>
    
    
    
    <category term="数据库" scheme="https://chenhaonan.dpdns.org/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="教程" scheme="https://chenhaonan.dpdns.org/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="数据库" scheme="https://chenhaonan.dpdns.org/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="MySQL" scheme="https://chenhaonan.dpdns.org/tags/MySQL/"/>
    
    <category term="RDBMS" scheme="https://chenhaonan.dpdns.org/tags/RDBMS/"/>
    
  </entry>
  
  <entry>
    <title>Maven教程</title>
    <link href="https://chenhaonan.dpdns.org/posts/b280/"/>
    <id>https://chenhaonan.dpdns.org/posts/b280/</id>
    <published>2024-06-02T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.921Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、Maven简介"><a href="#一、Maven简介" class="headerlink" title="一、Maven简介"></a>一、Maven简介</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">传统项目管理存在的问题:</span><br><span class="line">1.Jar包不统一、Jar包不兼容</span><br><span class="line">2.工程升级维护过程操作繁琐</span><br><span class="line">由于传统项目存在以上问题，因此产生的Maven这个工具,用于对项目的依赖进行管理,以及管理项目的构建、编译、测试、打包、安装、发布等过程(注: 项目的构建过程依赖于Maven的插件,通过插件可在Maven的的构建生命周期的不同时间段进行某些操作)</span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240606230256948.png" alt="image-20240606230256948"></p><h3 id="1-1-Maven是什么"><a href="#1-1-Maven是什么" class="headerlink" title="1.1 Maven是什么"></a>1.1 Maven是什么</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Maven的本质就是一个项目管理工具,将项目开发和管理过程抽象成一个项目对象模型(POM)</span><br><span class="line"></span><br><span class="line">POM(Project Object Model): 项目对象模型</span><br></pre></td></tr></table></figure><h3 id="1-2-Maven的作用"><a href="#1-2-Maven的作用" class="headerlink" title="1.2 Maven的作用"></a>1.2 Maven的作用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.项目构建: 提供标准的、管平台的自动化项目构建方式</span><br><span class="line">2.依赖管理: 方便快捷的管理项目依赖的资源(Jar包),避免资源间的版本冲突问题</span><br><span class="line">3.同一开发结构: 提供标准的、统一的项目结构</span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240606230506863.png" alt="image-20240606230506863"></p><h2 id="二、下载与安装"><a href="#二、下载与安装" class="headerlink" title="二、下载与安装"></a>二、下载与安装</h2><p><strong>下载地址</strong>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">官网: https://maven.apache.org/</span><br></pre></td></tr></table></figure><p><strong>安装过程</strong>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.在官网下载Maven的压缩包</span><br><span class="line">2.解压压缩包</span><br><span class="line">3.配置环境变量:</span><br><span class="line">JAVA_HOME</span><br><span class="line">MAVEN_HOME</span><br><span class="line">PATH</span><br><span class="line">4.测试安装成功</span><br><span class="line">mvn -v</span><br></pre></td></tr></table></figure><h2 id="三、Maven的基础概念"><a href="#三、Maven的基础概念" class="headerlink" title="三、Maven的基础概念"></a>三、Maven的基础概念</h2><h3 id="3-1-仓库"><a href="#3-1-仓库" class="headerlink" title="3.1 仓库"></a>3.1 仓库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">仓库: 用于存储资源,包含各种Jar包</span><br><span class="line"></span><br><span class="line">仓库分类:</span><br><span class="line">本地仓库: 自己电脑中存放资源的仓库,连接远程仓库获取资源</span><br><span class="line">远程仓库: 非本机电脑上的仓库，为本地仓库提供资源</span><br><span class="line">中央仓库: Maven团队维护,存储了几乎所有开源的资源的仓库</span><br><span class="line">私服: 部门/公司范围内存储资源的仓库,从中央仓库获取资源</span><br><span class="line">私服的作用:</span><br><span class="line">1.保存具有版权的资源,包含购买或自主研发的Jar</span><br><span class="line">2.一定范围内共享资源,仅对内部开放,不对外共享</span><br><span class="line">中央仓库的地址: https://mvnrepository.com/</span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240606231958580.png" alt="image-20240606231958580"></p><h3 id="3-2-坐标"><a href="#3-2-坐标" class="headerlink" title="3.2 坐标"></a>3.2 坐标</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">什么是坐标: 坐标即用于描述仓库中资源的位置的一段信息</span><br><span class="line"></span><br><span class="line">一个坐标主要包括以下几个部分:</span><br><span class="line">groupId : 定义当前Maven项目隶属组织名称(通常是域名反写,例如: com.chenhao)</span><br><span class="line">artifactId : 定义当前Maven项目名称(通常是模块名称,例如: CRM、SMS)</span><br><span class="line">version : 定义当前项目的版本</span><br><span class="line"></span><br><span class="line">Maven坐标的作用:</span><br><span class="line">使用唯一标识,唯一性定位资源位置,通过该标识可以将资源的识别与下载工作交给机器完成</span><br></pre></td></tr></table></figure><h2 id="四、配置Maven"><a href="#四、配置Maven" class="headerlink" title="四、配置Maven"></a>四、配置Maven</h2><h3 id="4-1-配置本地仓库"><a href="#4-1-配置本地仓库" class="headerlink" title="4.1 配置本地仓库"></a>4.1 配置本地仓库</h3><p><strong>为什么需要配置本地仓库:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">由于Maven的本地仓库的位置是在当前用户目录下的.m2目录下的repository文件夹下,由于存在在C盘,而C盘一般作为系统盘,后期随着Maven的不断使用,本地仓库中会越来越大,因此通常会修改Maven的本地仓库。</span><br></pre></td></tr></table></figure><p><strong>在什么地方配置本地仓库:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Maven的安装目录下的conf文件夹下的settings文件</span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240606234810306.png" alt="image-20240606234810306"></p><p><strong>配置的内容:</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>本地仓库的位置<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240606235058709.png" alt="image-20240606235058709"></p><h3 id="4-2-配置镜像仓库"><a href="#4-2-配置镜像仓库" class="headerlink" title="4.2 配置镜像仓库"></a>4.2 配置镜像仓库</h3><p><strong>什么是镜像仓库:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">镜像仓库即某个仓库的镜像,镜像仓库中的内容与被镜像仓库中的资源一样</span><br></pre></td></tr></table></figure><p><strong>Maven默认配置的远程仓库:</strong></p><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240606235842414.png" alt="image-20240606235842414"></p><p><strong>为什么需要配置镜像仓库:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">由于Maven默认连接的远程仓库位置为国外的服务器,因此下载资源时速度比较慢,因此一般会配置一个镜像仓库来提高下载速度和稳定性。</span><br><span class="line">配置镜像仓库即告诉Maven,以后下载资源时直接访问配置的镜像仓库下载,不要直接去中央仓库下载</span><br></pre></td></tr></table></figure><p><strong>常用的镜像仓库:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">阿里云maven仓库：https://maven.aliyun.com/repository/public</span><br><span class="line">华为云maven仓库：https://mirrors.huaweicloud.com/repository/maven/</span><br><span class="line">腾讯云maven仓库：https://mirrors.cloud.tencent.com/nexus/repository/maven-public/</span><br><span class="line">网易云maven仓库：http://maven.netease.com/nexus/content/groups/public/</span><br></pre></td></tr></table></figure><p><strong>在什么地方配置远程仓库:</strong></p><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240606234810306.png" alt="image-20240606234810306"></p><p><strong>配置的内容:</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-public<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun public<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240607001207401.png" alt="image-20240607001207401"></p><p><strong>配置内容说明:</strong></p><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240607001404120.png" alt="image-20240607001404120"></p><h3 id="4-3-全局setting与用户setting"><a href="#4-3-全局setting与用户setting" class="headerlink" title="4.3 全局setting与用户setting"></a>4.3 全局setting与用户setting</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">全局setting: 它对整个系统是有效的</span><br><span class="line">用户setting: 只对当前用户有效</span><br><span class="line"></span><br><span class="line">注意: 用户范围的settings.xml会覆盖全局的settings.xml</span><br></pre></td></tr></table></figure><p><strong>setting.xml文件中的配置详细介绍可访问下面的超链接进行观看</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/DreamDrive/p/5571916.html</span><br></pre></td></tr></table></figure><h4 id="4-3-1-全局setting"><a href="#4-3-1-全局setting" class="headerlink" title="4.3.1 全局setting"></a>4.3.1 全局setting</h4><p><strong>存放位置</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Maven的安装目录/conf/setting.xml</span><br></pre></td></tr></table></figure><h4 id="4-3-2-用户setting"><a href="#4-3-2-用户setting" class="headerlink" title="4.3.2 用户setting"></a>4.3.2 用户setting</h4><p><strong>存放位置</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;user_home&#125;/.m2/settings.xml</span><br></pre></td></tr></table></figure><h2 id="五、手动制作Maven项目"><a href="#五、手动制作Maven项目" class="headerlink" title="五、手动制作Maven项目"></a>五、手动制作Maven项目</h2><h3 id="5-1-Maven的普通工程目录结构"><a href="#5-1-Maven的普通工程目录结构" class="headerlink" title="5.1 Maven的普通工程目录结构"></a>5.1 Maven的普通工程目录结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">project</span><br><span class="line">java-project</span><br><span class="line">src</span><br><span class="line">main</span><br><span class="line">java</span><br><span class="line">resources</span><br><span class="line">test</span><br><span class="line">java</span><br><span class="line">resources</span><br><span class="line">pom.xml</span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240612203132195.png" alt="image-20240612203132195"></p><h3 id="5-2-Maven的Web工程目录结构"><a href="#5-2-Maven的Web工程目录结构" class="headerlink" title="5.2 Maven的Web工程目录结构"></a>5.2 Maven的Web工程目录结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">project</span><br><span class="line">web-project</span><br><span class="line">src</span><br><span class="line">main</span><br><span class="line">java</span><br><span class="line">resources</span><br><span class="line">webapp</span><br><span class="line">WEB-INF</span><br><span class="line">web.xml</span><br><span class="line">index.jsp</span><br><span class="line">test</span><br><span class="line">java</span><br><span class="line">resources</span><br><span class="line">pom.xml</span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240612203538568.png" alt="image-20240612203538568"></p><h3 id="5-3-构建命令"><a href="#5-3-构建命令" class="headerlink" title="5.3 构建命令"></a>5.3 构建命令</h3><p>注：下面的命令须在pom文件所在的目录执行。一次可以执行多个命令,使用空格分隔</p><p><strong>编译</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn compile</span><br></pre></td></tr></table></figure><p><strong>清理</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean</span><br></pre></td></tr></table></figure><p><strong>测试</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn test</span><br></pre></td></tr></table></figure><p><strong>打包</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn package</span><br></pre></td></tr></table></figure><p><strong>安装到本地仓库</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn install</span><br></pre></td></tr></table></figure><h2 id="六、-Maven插件构建项目"><a href="#六、-Maven插件构建项目" class="headerlink" title="六、 Maven插件构建项目"></a>六、 Maven插件构建项目</h2><h3 id="6-1-创建普通工程"><a href="#6-1-创建普通工程" class="headerlink" title="6.1 创建普通工程"></a>6.1 创建普通工程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mvn archetype:generate</span><br><span class="line">-DarchetypeArtifactId=maven-archetype-quickstart</span><br><span class="line">-DgroupId=&#123;project-packaging&#125;</span><br><span class="line">-DartifactId=&#123;project-name&#125;</span><br><span class="line">-Dversion=&#123;version&#125;</span><br><span class="line">-DinteractiveMode=false</span><br></pre></td></tr></table></figure><h3 id="6-2-创建Web工程"><a href="#6-2-创建Web工程" class="headerlink" title="6.2 创建Web工程"></a>6.2 创建Web工程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mvn archetype:generate</span><br><span class="line">    -DarchetypeArtifactId=maven-archetype-webapp</span><br><span class="line">-DgroupId=&#123;project-packaging&#125;</span><br><span class="line">-DartifactId=&#123;project-name&#125;</span><br><span class="line">    -Dversion=&#123;version&#125;</span><br><span class="line">-DinteractiveMode=false</span><br></pre></td></tr></table></figure><h2 id="七、IDEA生成Maven项目"><a href="#七、IDEA生成Maven项目" class="headerlink" title="七、IDEA生成Maven项目"></a>七、IDEA生成Maven项目</h2><h3 id="7-1-IDEA中集成Maven"><a href="#7-1-IDEA中集成Maven" class="headerlink" title="7.1 IDEA中集成Maven"></a>7.1 IDEA中集成Maven</h3><p><strong>第一步</strong></p><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240612204104087.png" alt="image-20240612204104087"></p><p><strong>第二步</strong></p><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240612204507833.png" alt="image-20240612204507833"></p><h3 id="7-1-创建普通工程"><a href="#7-1-创建普通工程" class="headerlink" title="7.1 创建普通工程"></a>7.1 创建普通工程</h3><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240612204812150.png" alt="image-20240612204812150"></p><h3 id="7-2-创建Web工程"><a href="#7-2-创建Web工程" class="headerlink" title="7.2 创建Web工程"></a>7.2 创建Web工程</h3><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240612204853648.png" alt="image-20240612204853648"></p><h2 id="八、依赖管理"><a href="#八、依赖管理" class="headerlink" title="八、依赖管理"></a>八、依赖管理</h2><h3 id="8-1-依赖配置"><a href="#8-1-依赖配置" class="headerlink" title="8.1 依赖配置"></a>8.1 依赖配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">依赖指当前项目运行所需要的Jar,一个项目可以设置多个依赖</span><br></pre></td></tr></table></figure><p><strong>依赖管理的格式</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 当前项目所依赖的所有Jar --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 设置具体的依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 依赖所属群组Id --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 依赖所属项目Id --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 依赖版本号 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="8-2-依赖传递"><a href="#8-2-依赖传递" class="headerlink" title="8.2 依赖传递"></a>8.2 依赖传递</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">依赖具有传递性</span><br><span class="line">直接依赖: 在当前项目中通过依赖配置建立的依赖关系</span><br><span class="line">间接依赖: 被依赖的资源如果依赖其他资源,当前项目间接依赖其他资源</span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240612211424386.png" alt="image-20240612211424386"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">依赖传递的冲突问题:</span><br><span class="line">路径优先: 当依赖中出现相同资源时,层级越深,优先级越低,层级越浅,优先级越高</span><br><span class="line">声明优先: 当资源在相同层级被依赖时,配置顺序靠前的覆盖配置顺序靠后的</span><br><span class="line">特殊优先: 当同级配置了相同资源的不同版本,后配置的覆盖先配置的</span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240612212047266.png" alt="image-20240612212047266"></p><h3 id="8-3-可选依赖"><a href="#8-3-可选依赖" class="headerlink" title="8.3 可选依赖"></a>8.3 可选依赖</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">可选依赖指对外(依赖当前项目的项目)隐藏当前项目所依赖的资源---不透明</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 设置具体的依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 依赖所属群组Id --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 依赖所属项目Id --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 依赖版本号 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置可选依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="8-4-排除依赖"><a href="#8-4-排除依赖" class="headerlink" title="8.4 排除依赖"></a>8.4 排除依赖</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">排除依赖指主动断开依赖的资源,被排除的资源无需指定版本---不需要</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 设置具体的依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 依赖所属群组Id --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 依赖所属项目Id --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 依赖版本号 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置排除依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 依赖所属群组Id --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 依赖所属项目Id --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="8-5-依赖范围"><a href="#8-5-依赖范围" class="headerlink" title="8.5 依赖范围"></a>8.5 依赖范围</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">依赖的Jar默认情况下可以在任何地方使用,可以通过scope标签设定其作用范围。</span><br><span class="line"></span><br><span class="line">作用范围:</span><br><span class="line">主程序范围有效(maint文件夹范围内)</span><br><span class="line">测试程序范围有效(test文件夹范围内)</span><br><span class="line">是否参与打包 (package指令范围内)</span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240612213718960.png" alt="image-20240612213718960"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">依赖范围的传递性:</span><br><span class="line">带有依赖范围的资源在进行传递时,作用范围将受到影响</span><br></pre></td></tr></table></figure><p><img src="/../images/Maven%E6%95%99%E7%A8%8B/image-20240612214454677.png" alt="image-20240612214454677"></p><h2 id="九、生命周期与插件"><a href="#九、生命周期与插件" class="headerlink" title="九、生命周期与插件"></a>九、生命周期与插件</h2><h3 id="9-1-构建生命周期"><a href="#9-1-构建生命周期" class="headerlink" title="9.1 构建生命周期"></a>9.1 构建生命周期</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Maven对项目构建的生命周期划分为3套</span><br><span class="line">clean: 清理工作</span><br><span class="line">default: 核心工作,例如编译、测试、打包、部署等</span><br><span class="line">site: 产生报告、发布站点等</span><br></pre></td></tr></table></figure><h3 id="9-2-插件"><a href="#9-2-插件" class="headerlink" title="9.2 插件"></a>9.2 插件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">插件与生命周期内的阶段进行绑定,在执行到对应生命周期时,会执行对应插件功能。</span><br><span class="line">默认Maven在各个生命周期上绑定有预设的功能</span><br><span class="line">可以通过插件自定义其他功能</span><br></pre></td></tr></table></figure><p><strong>插件的配置格式</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 构建 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 设置插件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 具体的插件配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">phase</span>&gt;</span>绑定的生命周期的阶段<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="9-2-1-配置Tomcat插件"><a href="#9-2-1-配置Tomcat插件" class="headerlink" title="9.2.1 配置Tomcat插件"></a>9.2.1 配置Tomcat插件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 构建 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 设置插件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 具体的插件配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">port</span>&gt;</span>80<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">path</span>&gt;</span>/<span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Maven的概念、下载与安装、依赖管理、生命周期与插件等内容</summary>
    
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
    <category term="后端" scheme="https://chenhaonan.dpdns.org/tags/%E5%90%8E%E7%AB%AF/"/>
    
    <category term="工具" scheme="https://chenhaonan.dpdns.org/tags/%E5%B7%A5%E5%85%B7/"/>
    
    <category term="教程" scheme="https://chenhaonan.dpdns.org/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="项目构建" scheme="https://chenhaonan.dpdns.org/tags/%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA/"/>
    
  </entry>
  
  <entry>
    <title>Html教程</title>
    <link href="https://chenhaonan.dpdns.org/posts/9c04/"/>
    <id>https://chenhaonan.dpdns.org/posts/9c04/</id>
    <published>2023-11-11T16:00:00.000Z</published>
    <updated>2025-11-28T16:26:24.901Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、HTML初识"><a href="#一、HTML初识" class="headerlink" title="一、HTML初识"></a>一、HTML初识</h2><h3 id="1-1-网页由什么组成"><a href="#1-1-网页由什么组成" class="headerlink" title="1.1 网页由什么组成"></a>1.1 网页由什么组成</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">文字</span><br><span class="line">图片</span><br><span class="line">视频</span><br><span class="line">音频</span><br><span class="line">超链接</span><br></pre></td></tr></table></figure><h3 id="1-2-网页的本质"><a href="#1-2-网页的本质" class="headerlink" title="1.2 网页的本质"></a>1.2 网页的本质</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">一个网页就是一个HTML文件，通过浏览器可以将HTML文件中的代码转化成网页</span><br></pre></td></tr></table></figure><h3 id="1-3-浏览器是什么"><a href="#1-3-浏览器是什么" class="headerlink" title="1.3 浏览器是什么"></a>1.3 浏览器是什么</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">浏览器是网页展示、运行的平台</span><br></pre></td></tr></table></figure><h3 id="1-4-常见的浏览器"><a href="#1-4-常见的浏览器" class="headerlink" title="1.4  常见的浏览器"></a>1.4  常见的浏览器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">IE =&gt; Trident</span><br><span class="line">火狐 =&gt; Gecko</span><br><span class="line">Safari =&gt; Webkit</span><br><span class="line">Opera =&gt; Blink</span><br><span class="line">谷歌(推荐使用) =&gt; Blink</span><br><span class="line"></span><br><span class="line">注：浏览器的内核用于渲染网页，如果内核不一样，则同一个网页通过不同内核渲染时，渲染速度、效果可能不一样。</span><br></pre></td></tr></table></figure><h3 id="1-5-Web规范"><a href="#1-5-Web规范" class="headerlink" title="1.5 Web规范"></a>1.5 Web规范</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HTML =&gt; 负责网页结构/网页内容</span><br><span class="line">CSS =&gt; 负责网页外观/网页样式</span><br><span class="line">JS =&gt; 负责页面交互</span><br></pre></td></tr></table></figure><h2 id="二、HTML初体验"><a href="#二、HTML初体验" class="headerlink" title="二、HTML初体验"></a>二、HTML初体验</h2><h3 id="2-1-HTML简介"><a href="#2-1-HTML简介" class="headerlink" title="2.1 HTML简介"></a>2.1 HTML简介</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hyper Text Markup Language,中文翻译为超文本标记语言</span><br></pre></td></tr></table></figure><h3 id="2-2-文字变粗案例"><a href="#2-2-文字变粗案例" class="headerlink" title="2.2 文字变粗案例"></a>2.2 文字变粗案例</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">strong</span>&gt;</span>需要加粗的文字<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-3-HTML骨架："><a href="#2-3-HTML骨架：" class="headerlink" title="2.3 HTML骨架："></a>2.3 HTML骨架：</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>网页的标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">网页的主题内容</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-4-开发工具"><a href="#2-4-开发工具" class="headerlink" title="2.4 开发工具"></a>2.4 开发工具</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VSCode (推荐、体积小、免费、插件多)、WebStorm、Sublime、Dreamweaver、Hbuider</span><br></pre></td></tr></table></figure><h2 id="三、HTML语法"><a href="#三、HTML语法" class="headerlink" title="三、HTML语法"></a>三、HTML语法</h2><h3 id="3-1-注释"><a href="#3-1-注释" class="headerlink" title="3.1 注释"></a>3.1 注释</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注释的内容--&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-2-HTML标签的结构"><a href="#3-2-HTML标签的结构" class="headerlink" title="3.2 HTML标签的结构"></a>3.2 HTML标签的结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">双标签：</span><br><span class="line">&lt;开始标签&gt;内容&lt;/结束标签&gt;</span><br><span class="line">单标签：</span><br><span class="line">&lt;标签/&gt;</span><br></pre></td></tr></table></figure><h3 id="3-3-标签之间的关系"><a href="#3-3-标签之间的关系" class="headerlink" title="3.3 标签之间的关系"></a>3.3 标签之间的关系</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">父子关系：嵌套</span><br><span class="line">兄弟关系：并列</span><br></pre></td></tr></table></figure><h3 id="3-4-HTML标签"><a href="#3-4-HTML标签" class="headerlink" title="3.4 HTML标签"></a>3.4 HTML标签</h3><h4 id="3-4-1-排版标签"><a href="#3-4-1-排版标签" class="headerlink" title="3.4.1 排版标签"></a>3.4.1 排版标签</h4><p><strong>标题标签</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>一级标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>二级标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>三级标题<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>四级标题<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h5</span>&gt;</span>五级标题<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h6</span>&gt;</span>六级标题<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line"></span><br><span class="line">特点:</span><br><span class="line">文字都加粗、文字逐渐减小、独占一行</span><br></pre></td></tr></table></figure><p><strong>段落标签</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我是一段文字<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">特点:</span><br><span class="line">段落之间存在间隙、独占一行</span><br></pre></td></tr></table></figure><p><strong>换行</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br></pre></td></tr></table></figure><p><strong>水平分割线</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-2-文本格式化标签"><a href="#3-4-2-文本格式化标签" class="headerlink" title="3.4.2 文本格式化标签"></a>3.4.2 文本格式化标签</h4><p><strong>加粗</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">strong</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>下划线</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">u</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">u</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ins</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">ins</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>倾斜</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">em</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>删除线</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">s</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">s</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">del</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">del</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-3-媒体标签"><a href="#3-4-3-媒体标签" class="headerlink" title="3.4.3 媒体标签"></a>3.4.3 媒体标签</h4><p><strong>图片</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;图片路径&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;替换文本&quot;</span> <span class="attr">title</span>=<span class="string">&quot;提示文本&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>音频</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;音频路径&quot;</span> <span class="attr">controls</span> <span class="attr">autoplay</span> <span class="attr">loop</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>视频</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;视频路径&quot;</span> <span class="attr">controls</span> <span class="attr">autoplay</span> <span class="attr">loop</span> <span class="attr">muted</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-4-链接标签"><a href="#3-4-4-链接标签" class="headerlink" title="3.4.4 链接标签"></a>3.4.4 链接标签</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;跳转路径&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-5-列表标签"><a href="#3-4-5-列表标签" class="headerlink" title="3.4.5 列表标签"></a>3.4.5 列表标签</h4><p><strong>无序列表</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>苹果<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>香蕉<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>西瓜<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>有序列表</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>李四<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>王五<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>自定义列表</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dt</span>&gt;</span>自定义的主题<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dd</span>&gt;</span>自定义项<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dd</span>&gt;</span>自定义项<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-6-表格标签"><a href="#3-4-6-表格标签" class="headerlink" title="3.4.6 表格标签"></a>3.4.6 表格标签</h4><p><strong>表格</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span> <span class="attr">width</span>=<span class="string">&quot;20&quot;</span> <span class="attr">height</span>=<span class="string">&quot;20&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">caption</span>&gt;</span>表格标题<span class="tag">&lt;<span class="name">caption</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>4<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>5<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>6<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>7<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>8<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>9<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tfoot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>10<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>11<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>12<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tfoot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">跨行合并:rowspan</span><br><span class="line">跨列合并:colspan</span><br></pre></td></tr></table></figure><h4 id="3-4-7-表单标签"><a href="#3-4-7-表单标签" class="headerlink" title="3.4.7 表单标签"></a>3.4.7 表单标签</h4><p><strong>表单</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;提交的路径&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-8-Input系列标签"><a href="#3-4-8-Input系列标签" class="headerlink" title="3.4.8 Input系列标签"></a>3.4.8 Input系列标签</h4><p><strong>文本框</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;后台的key&quot;</span> <span class="attr">palceholder</span>=<span class="string">&quot;提示文本&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>密码框</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;后台的key&quot;</span> <span class="attr">palceholder</span>=<span class="string">&quot;提示文本&quot;</span> &gt;</span></span><br></pre></td></tr></table></figure><p><strong>单选框</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;后台的key&quot;</span> <span class="attr">checked</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>复选框</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;后台的key&quot;</span> <span class="attr">checked</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>文件</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;后台的key&quot;</span> <span class="attr">multiple</span> &gt;</span></span><br></pre></td></tr></table></figure><p><strong>提交按钮</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;我是一个提交按钮&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>重置按钮</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span> <span class="attr">value</span>=<span class="string">&quot;我是一个重置按钮&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>普通按钮</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;我是一个按钮&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-9-Button系列标签"><a href="#3-4-9-Button系列标签" class="headerlink" title="3.4.9 Button系列标签"></a>3.4.9 Button系列标签</h4><p><strong>提交按钮</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>我是提交按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>重置按钮</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;rest&quot;</span>&gt;</span>我是重置按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>普通按钮</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>我是普通按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-10-Select系列标签"><a href="#3-4-10-Select系列标签" class="headerlink" title="3.4.10 Select系列标签"></a>3.4.10 Select系列标签</h4><p><strong>下拉标签</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;后台的key&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> <span class="attr">selected</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;北京&quot;</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;上海&quot;</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;深圳&quot;</span>&gt;</span>深圳<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-11-TextArea标签"><a href="#3-4-11-TextArea标签" class="headerlink" title="3.4.11 TextArea标签"></a>3.4.11 TextArea标签</h4><p><strong>文本域</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">cols</span>=<span class="string">&quot;20&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;20&quot;</span> <span class="attr">palceholder</span>=<span class="string">&quot;提示文本&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-12-Lable标签"><a href="#3-4-12-Lable标签" class="headerlink" title="3.4.12 Lable标签"></a>3.4.12 Lable标签</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">lable</span> <span class="attr">for</span>=<span class="string">&quot;id&quot;</span>&gt;</span>标签<span class="tag">&lt;/<span class="name">lable</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">lable</span>&gt;</span>标签<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">lable</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-13-语义化标签"><a href="#3-4-13-语义化标签" class="headerlink" title="3.4.13 语义化标签"></a>3.4.13 语义化标签</h4><p><strong>无语言的标签</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">独占一行</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">在一行显示</span><br></pre></td></tr></table></figure><p><strong>有语义的标签(手机端)</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">header =&gt;头部</span><br><span class="line">nav =&gt;导航</span><br><span class="line">footer =&gt;底部</span><br><span class="line">aside =&gt;侧边栏</span><br><span class="line">section =&gt;区块</span><br><span class="line">article =&gt;文章</span><br></pre></td></tr></table></figure><p><img src="/../images/Html%E6%95%99%E7%A8%8B/image-20230522234259019.png" alt="image-20230522234259019"></p><h3 id="3-5-字符实体"><a href="#3-5-字符实体" class="headerlink" title="3.5 字符实体"></a>3.5 字符实体</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">空格: &amp;nbsp;</span><br><span class="line">&lt;: &amp;lt;</span><br><span class="line">&gt;: &amp;gt;</span><br><span class="line">&quot;: &amp;quot;</span><br><span class="line">&#x27;: &amp;apos;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Html相关的概念、初体验以及语法</summary>
    
    
    
    <category term="前端" scheme="https://chenhaonan.dpdns.org/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="教程" scheme="https://chenhaonan.dpdns.org/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="前端" scheme="https://chenhaonan.dpdns.org/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="HTML" scheme="https://chenhaonan.dpdns.org/tags/HTML/"/>
    
  </entry>
  
</feed>
