<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>JDBC | Johnny的空间站</title><meta name="keywords" content="后端,数据库,Java,JDBC"><meta name="author" content="Mr.Chen"><meta name="copyright" content="Mr.Chen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#18171d"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="JDBC"><meta name="application-name" content="JDBC"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#18171d"><meta property="og:type" content="article"><meta property="og:title" content="JDBC"><meta property="og:url" content="https://chenhaonan.dpdns.org/posts/5c27/index.html"><meta property="og:site_name" content="Johnny的空间站"><meta property="og:description" content="JDBC相关内容"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://chenhaonan.dpdns.org/images/JDBC/cover.png"><meta property="article:author" content="Mr.Chen"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://chenhaonan.dpdns.org/images/JDBC/cover.png"><meta name="description" content="JDBC相关内容"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://chenhaonan.dpdns.org/posts/5c27/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://twikoo-ruddy-six.vercel.app/',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助"]},
  algolia: {"appId":"AT743L39US","apiKey":"0833ddb85b214487ec625f98b115d700","indexName":"hexo-blog","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Mr.Chen","link":"链接: ","source":"来源: Johnny的空间站","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Johnny的空间站',
  title: 'JDBC',
  postAI: '',
  pageFillDescription: '一、JDBC介绍, 二、JDBC步骤, 三、JDBC入门案例, 3.1 加载驱动, 3.1.1 下载驱动jar包, 3.1.2 将驱动jar文件添加到Java应用, 3.1.3 注册驱动, 3.2 创建连接, 3.3 编写SQL指令, 3.4 加载SQL指令, 3.5 执行SQL、获取结果, 3.6 处理结果, 3.7 关闭连接, 四、JDBC增删查改操作实例, 4.1 insert操作, 4.2 delete操作, 4.3 update操作, 4.4 select操作（一条结果）, 4.5 select操作（多条结果）, 五、JDBC的核心类与接口, 5.1 DriverManager类, 5.2 Connection接口, 5.2.1 获取Statement对象, 5.2.2 事务管理, 5.3 Statement接口, 5.4 ResultSet接口, 六、SQL注入问题, 6.1 什么是SQL注入问题？, 6.2 如何解决SQL注入问题？, 6.3 使用PreparedStatement预编译案例, 七、工具类封装, 7.1 代码的复用性, 7.2 工具类封装, 八、DAO与DTO的封装, 8.1 CRUD方法的封装, 8.2 DTO实体类封装, 8.3 实体类封装查询结果, 8.4 实体类传递添加、修改操作参数, 8.4.1 添加操作, 8.4.2 修改操作, 8.5 DAO类封装, 8.6 DAO类代码优化, 九、JDBC综合案例, 9.1 JDBC数据库编程的流程, 9.2 创建JDBC工具类, 9.3 创建DTO类, 9.4 创建DAO类, 9.5 测试DAO类中的方法, 9.5.1 下载导入junit依赖到项目中, 9.5.2 创建单元测试类, 十、JDBC事务管理, 10.1 JDBC实现借书操作, 10.2 JDBC事务管理, 10.3 Service层的事务管理, 10.3.1 Service分层介绍, 10.3.2 Service分层实现, 10.3.3 Service层的事务管理, 十一、数据库连接池, 11.1 什么是数据库连接池？, 11.2 常用连接池, 11.3 使用Druid连接池, 11.3.1 创建Java应用, 11.3.2 创建连接池属性配置, 11.3.3 创建连接池工具类, 十二、通用JDBC操作封装, 12.1 DML操作封装, 12.2 DQL操作封装, 12.3 基于通用JDBC操作的案例, 12.3.1 创建实体类, 12.3.2 创建DAO类, 十三、Apache DBUtils, 13.1 DBUtils介绍, 13.2 DBUtils的使用准备, 13.3 DBUtils使用, 13.3.1 添加操作, 13.3.2 删除操作, 13.3.3 修改操作, 13.3.4 查询操作一介绍与数据库的连接数据库编程是语言为完成数据库的访问操作提供的一套统一的标准二步骤三入门案例是用代码完成数据访问的规范加载驱动下载驱动包对应数据库匹配版本的驱动包地址搜索选择版本下载数据库版本为驱动包建议使用数据库版本为驱动包建议使用将驱动文件添加到应用在应用中创建文件夹将下载好的文件拷贝粘贴到目录将驱动文件设置为库选择驱动右键注册驱动通过反射机制将驱动文件中提供的驱动类载入到中注册驱动驱动包中的驱动类的路径创建连接创建连接通过数据库驱动管理器获取连接提供的数据库连接的规范接口一个对象就表示一个数据库连接数据库的统一资源定位器定位数据库连接资源参数设置编码使用通信设置客户端和服务端时区转换编写指令编写要执行的指令指令中需要的参数可以通过字符串拼接的形式会导致注入加载指令加载指令获取指令的加载器对象可以理解为指令的加载器对象指令的预编译加载器执行获取结果执行获取执行结果如果指令为则中就是查询结果如果指令为则就表示操作影响的数据行数如果表示操作是成功的如果表示操作对数据表中的数据没有影响处理结果处理结果业务添加操作返回值表示添加成功否则表示添加失败修改操作返回值表示修改对数据有影响如果表示对数据库没有影响删除操作返回值表示删除对数据有影响如果表示对数据库没有影响查询操作从中取出查询结果封装到对象中添加成功添加失败关闭连接关闭连接如果执行操作需要关闭和如果执行操作需要关闭和关闭之前先判空由到大关闭四增删查改操作实例使用完成数据库的访问操作进阶之路老王这本书很好注册驱动驱动包中的驱动类的路径创建连接通过数据库驱动管理器获取连接编写要执行的指令加载指令获取指令的加载器执行获取执行结果处理结果业务添加成功添加失败关闭连接操作使用根据图书编号删除图书信息注册驱动创建连接编写获取加载器执行处理结果删除成功删除失败关闭连接操作根据数据记录的主键修改其他的字段根据图书修改图书名称作者价格库存描述进阶之路亮亮这本书非常好修改成功修改失败操作一条结果结果集处理根据图书查询一本图书信息通过方法执行查询语句并且将查询的结果存放到一个对象中结果集处理结果从中获取查询结果关闭连接结果集也需要关闭操作多条结果查询所有图书信息五的核心类与接口类驱动管理器接口数据库连接接口指令的加载执行器接口结果集类注册驱动创建数据库连接注册驱动在类中的静态初始化块中注册驱动在我们的应用程序中手动注册驱动的代码也可以省略如果我们没有手动注册驱动驱动管理器在获取连接的时候发现没有注册驱动则读取驱动文件中配置的驱动类路径进行注册获取连接数据库服务器的地址数据库连接用户名数据库连接密码接口对象表示应用程序与数据库之间的连接通过接口对象获取执行语句的对象完成数据的事务管理获取对象接口编译执行静态指令接口继承了接口预编译动态指令解决注入问题接口继承了接口可以调用存储过程事务管理开启事务关闭事务自动提交事务回滚提交事务接口用于编译执行指令的执行操作的指令执行操作的指令接口接口对象表示查询操作返回的结果集提供了便利的方法用于获取结果集中的数据判断结果集中是否还有数据未取出判断中是否还有数据获取指向的结果集中某行的数据获取指向的行的列数据字段名获取类型数据获取类型数据获取日期类型数据六注入问题什么是注入问题在操作指令编写过程中如果指令中需要数据我们可以通过字符串拼接的形式将参数拼接到指令中如就是拼接到中的变量使用字符串拼接变量的形式来设置语句中的数据可能会导致因变量值的改变引起指令的原意发生改变这就被称为注入注入问题是需要避免的例如如果的值为指令如果的值为指令如何解决注入问题使用进行预编译解决注入问题在编写指令时如果指令中需要参数一律使用参数占位符如果指令中有在操作步骤中不再使用而是从对象获取对指令进行预编译预编译完成之后通过对象给预编译后的指令的复制参数占位符序号值参数占位符序号值指令中的所有完成赋值之后通过执行执行时不再加载使用预编译案例删除操作请输入你要删除的图书的注册驱动创建连接编写指令中的参数使用表示如果指令有参数占位符则从获取预编译指令预编译在指令中的参数赋值之前对执行的语法结构进行编译指令预编译之后给中的赋值执行处理结果删除成功删除失败关闭连接修改操作进阶之路老王这本书很好注册驱动创建连接编写要执行的指令指令中所需的参数一律使用中有使用预编译给指令中的复制执行获取执行结果处理结果业务添加成功添加失败关闭连接练习修改操作根据数据记录的主键修改其他的字段根据图书修改图书名称作者价格库存描述进阶之路亮亮这本书非常好修改成功修改失败练习根据查询图书信息根据图书查询一本图书信息通过方法执行查询语句并且将查询的结果存放到一个对象中结果集处理结果从中获取查询结果关闭连接结果集也需要关闭备注如果指令中需要参数则使用进行预编译如果指令中没有参数建议使用执行效率要高于七工具类封装代码的复用性在我们的应用程序中如果需要完成相同的操作相同的代码无需重复编写我们只需一次编写多次调用即可数据库编程是由一个固定的步骤注册驱动创建连接编写获取对象执行处理结果关闭连接工具类封装将创建数据库连接所需的字符串定义为常量集中管理注册驱动只需执行一次因此我们放在帮助类的静态初始化块中完成注册驱动失败创建数据库连接对象创建连接失败关闭连接多态的应用使用接口做参数既可以传递接口对象也可以传递接口对象关闭连接关闭数据库连接失败八与的封装数据访问对象数据传输对象实体类用于传输操作参数及的查询结果方法的封装面向对象的特征之一封装我们将能够完成某个操作的代码单独定义成一个方法当需要完成此操作时调用这个方法即可操作封装操作封装操作封装实体类封装问题在封装方法时对于查询操作而言需要将查询到的数据库记录返回给调用者但是一个查询方法只能返回一个值而一条数据库记录有多个值如何将一条数据库记录的多个值返回呢处理在程序中创建一个属性与数据库表匹配的类通过此类的对象封装查询到的数据我们把用于传递增删查改操作的数据的对象称之为数据传输对象实体类带有属性其对象可以存放数据的类实体类创建规则类中属性的个数和类型与对应的数据表保持一致提供所有属性的和方法选择所有属性提供全参构造器选择所有属性提供无参构造器重写方法暂略重写和暂略实现序列化接口实体类实例和方法使用实体类封装查询操作返回的结果根据图书查询一条图书记录通过方法执行查询语句并且将查询的结果存放到一个对象中结果集处理结果从中获取查询结果我们需要将查询到的一条数据库图书记录的个值返回关闭连接结果集也需要关闭实体类封装查询结果查询的每条结果分别存放到一个对象中再将多个对象存放到一个集合中返回这个集合查询所有图书信息实体类传递添加修改操作参数在的添加修改等方法中需要多个数据我们可以通过实体类来进行参数传递添加操作调用工具类获取数据库连接对象关闭连接修改操作类封装封装将对数据库中同一张数据表的操作方法封装到同一个类中这个类就是访问此数据表的数据访问对象使用根据图书编号删除图书信息注册驱动创建连接编写如果指令有参数占位符则从获取预编译指令预编译在指令中的参数赋值之前对执行的语法结构进行编译指令预编译之后给中的赋值执行处理结果关闭连接添加图书如果添加成功返回如果添加失败则返回调用工具类获取数据库连接对象如果表示操作是成功的如果表示操作对数据表中的数据没有影响关闭连接根据图书查询一条图书记录通过方法执行查询语句并且将查询的结果存放到一个对象中结果集处理结果从中获取查询结果我们需要将查询到的一条数据库图书记录的个值返回关闭连接结果集也需要关闭查询所有图书信息类代码优化在应用程序开发中如果方法中抛出异常且自己可以处理则直接通过进行捕获处理操作方法的连接需要放在中进行关闭将数据库连接等需要关闭的数据库对象定义在之前因为所有的操作都需要对象查询方法都需要对象因此在中可以将这些对象定义成类的成员变量调用工具类获取数据库连接对象如果表示操作是成功的如果表示操作对数据表中的数据没有影响通过方法执行查询语句并且将查询的结果存放到一个对象中结果集处理结果从中获取查询结果我们需要将查询到的一条数据库图书记录的个值返回九综合案例完成学生信息的操作数据库编程的流程创建数据库数据表创建新的工程创建的工具类创建类用于封装参数及查询结果创建类用于完成操作创建工具类在工程中创建在包中创建工具类编写工具类添加驱动文件编写代码创建类在工程中创建在创建数据表对应的实体类编写实体类创建类创建类完成操作在项目中创建在包中创建类添加学生信息根据学号查询一个学生记录查询多个学生信息测试类中的方法使用对中创建的方法进行单元测试下载导入依赖到项目中下载如果使用版本单元测试需要以下两个文件将拷贝项目的文件夹选择拷贝到项目中的文件右键创建单元测试类如果我们需要对某个类中的方法进行单元测试我们需要创建这个类的测试类测试类类名被测试类此类是的单元测试类千锋涛哥公众号架构栈在测试类中定义成员变量创建被测试类的对象创建测试方法用来测试类中的方法测试方法名被测试方法名测试方法无参数无返回值准备被测试方法所需的参数男调用被测试方法获取结果断言返回结果成立不成立十事务管理什么是事务事务的四大特性事务的隔离级别事务管理实现借书操作向表添加借书记录修改表中的库存借书借书的学生学号借书的图书编号借书的数量向表添加借书记录造异常算术异常修改表中的库存关闭连接分析借书业务由两个数据库操作完成这两个操作要么同时成功要么同时失败构成一个数据库事务的操作默认是自定提交的因此当第一个操作添加借书记录完成后无论第二个操作修改库存是否成功借书记录都会添加到数据库而且是永久的中该如何做事务管理呢事务管理一个事务中的多个操作需要基于同一个数据库连接创建连接之后设置事务手动提交关闭自动提交当当前事务中的所有操作完成之后手动提交当事务中的任何一个步骤出现异常在代码块中执行事务回滚借书借书的学生学号借书的图书编号借书的数量设置使用当前连接操作数据库自动提交关闭向表添加借书记录造异常算术异常修改表中的库存提交事务一旦事务执行过程中出现异常执行回滚层的事务管理只负责数据库的操作业务由层进行管理分层介绍负责特定的数据库操作进行业务处理业务处理过程如果需要数据库操作则调用完成分层实现创建完成方法添加借书记录借书的学生的学号借书的图书编号借书的数量添加借书记录成功返回失败返回向表添加借书记录在中定义修改库存方法修改库存要修改库存的图书编号修改表中的库存创建完成借书业务借书业务包含两个步骤这两个步骤要么同时成功要么同时失败事务添加借书记录修改图书库存结果处理层的事务管理层事务中多个数据库的操作是相互独立的如何保证所有要么同时成功要么同时失败呢事务管理要满足以下条件多个操作需使用同一个数据库连接第一个操作之前设置事务手动提交所有操作执行完成之后提交事务出现异常则进行事务回滚如何让事务中的多个使用同一个数据库连接在获取连接对象将连接对象传递到中分析类中的对象需要通过传递给进来这种对象传递本来也无可厚非但是当我们通过面向接口开发时面向接口是为了能够灵活的定义实现类容易造成接口的冗余接口污染使用容器实现多个操作使用相同的连接存储的容器可以使用集合使用集合做容器在多线程并发编程中会出现资源竞争问题多个并发的线程使用的是同一个数据库连接对象我们的要求是同一个事务中使用同一个连接而并非多个线程共享连接为了解决并发编程的连接对象共享问题我们可以使用作为数据库连接对象的容器定义数据库连接信息定义容器静态初始化块注册驱动创建数据库连接从容器中获取连接如果容器中没有连接则创建连接并将创建的连接存放到容器关闭连接如果使用存储数据库连接关闭连接时同时要将对象从中移除获取到当前线程使用的数据库连接对象将关闭后的连接对象从中移除十一数据库连接池什么是数据库连接池如果每个操作需要数据库连接都重新创建使用完成之后都销毁我们的会因为频繁的创建销毁连接而占用额外的系统资源数据库连接本质上是可被重用的资源当一个操作完成之后其创建的连接是可以被其他操作使用的基于这个特性我们可以创建一个存放数据库连接的容器连接池连接池是有最大容量的当我们要进行操作时直接从这个容器中获取连接如果容器中没有空闲的连接且连接池中连接的个数没有达到最大值则创建新的数据库连接存入连接池并给这个操作使用使用完成之后无需关闭连接直接归还这个容器中即可如果容器中没有空闲的连接且连接池中连接的个数达到最大值当前操作就会进行等待等待连接池中的某个连接被归还归还之后再使用如果容器中有空闲连接则无需创建新的连接直接从容器中获取这个空闲连接进行使用连接池存放数据库连接对象的容器连接池作用对数据库连接进行管理减少因重复创建销毁连接导致的系统开销常用连接池我们可以编程实现创建一个数组集合来存放数据库连接目前市面上已经有多种实现的数据库连接池了我们无需再手动实现只需引用对应的数据库连接池产品即可在我们自己的应用中使用连接池站在巨人的肩上功能是否支持是是是否监控扩展性弱好弱弱拦截及解析无支持无无代码简单中等复杂简单特点依赖于阿里开源功能全面历史久远代码逻辑复杂且不易维护优化力度大功能简单起源于连接池管理数组基于连接池的性能使用的便捷性连接监控等多方面综合情况是目前企业应用中使用最广泛的在中默认集成性能是诸多竞品中最好的使用连接池创建应用创建工程添加驱动文件创建连接池属性配置在中创建在中创建文件配置连接池的实行数据库连接信息连接池属性连接池的初始化连接数创建数据库连接池时默认初始化的连接的个数连接池的最大连接数最小空闲连接数当数据库连接使用率很低时连接池中的连接会被释放一部分超时等待时间单位创建连接池工具类下载并导入的文件在创建工具类工具类与属性文件在同目录下定义对象表示数据库连接池数据源静态代码块初始化定义对象读取文件中配置的属性使用属性文件初始化对象创建静态方法从连接池对象中获取连接十二通用操作封装在层的操作中对数据的表增删改查操作存在代码的冗余我们可以对其公共部分进行封装实现代码的复用操作封装对于数据库的操作参数不同通过参数复制不同通用的操作方法公共操作执行的指令女操作封装使用泛型设置通用查询方法的返回类型公共操作查询从查询结果中取出一条记录多个值封装到一个实体类对象中就是方法调用者在调用方法时传递进来的用于映射查询结果的方法基于通用操作的案例图书信息进行操作创建图书实体类创建创建实体类无参构造器全参构造器和创建类中的操作都是调用实现的十三介绍是组织提供的一个针对进行简单封装的开源工具类库使用可以极大简化应用程序开发同时不会影响数据库访问的性能是编程中数据库访问的轻巧使用的工具类库提供对数据表通用的操作提供对数据表通用的操作可以把结果封装成对象集合等类型工具类库中的核心类用于执行指令相当于我们自己封装的类用于执行指令用于执行指令接口结果集处理器用于处理查询结果相当于我们自己的封装的接口实现类当查询语句返回一条结果时使用将结果转换成一个对象实现类当查询语句返回多个结果时使用将结果转换成一个集合实现类当查询结果返回一个值时使用将这个值转换成变量类型的使用准备新建工程添加依赖建立数据库连接是依赖连接池数据源的因此我们需要使用连接池配置的属性文件创建包在包中创建文件配置如下数据库连接信息连接池属性连接池的初始化连接数创建数据库连接池时默认初始化的连接的个数连接池的最大连接数最小空闲连接数当数据库连接使用率很低时连接池中的连接会被释放一部分超时等待时间单位创建连接池工具类在包创建工具类获取数据库连接池数据源对象使用完成图书信息的数据库操作创建实体类添加操作编写准备参数调用中的执行删除操作修改操作查询操作查询一条记录对于查询操作我们需要通过对象调用方法来执行所有的方法都需要一个的参数通过此参数指定方法的返回类型如果指令执行之后返回的是一行记录我们通过指定查询结果封装的实体类类型要求查询结果集的字段名必须与指定的实体类的属性名匹配方案创建实体类的时候实体类中属性的名字与数据表中的列名相同方案查询语句字段取别名让字段别名与实体类属性名一致自定义结果集处理自定义对于查询操作我们需要通过对象调用方法来执行所有的方法都需要一个的参数通过此参数指定方法的返回类型如果指令执行之后返回的是一行记录我们通过指定查询结果封装的实体类类型要求查询结果集的字段名必须与指定的实体类的属性名匹配方案自定义结果处理查询多条记录如果指令执行之后返回的是多行记录我们通过指定查询结果封装的实体类的集合类型查询一个值例如在做分页的时候我们需要查询数据的总记录数如果指令执行之后返回的是一个值时我们通过指定返回类型在处理统计操作时是以类型进行操作的因此不能直接转成如果我们确定这个值在范围内我们可以在得到类型之后进行强转建议使用处理',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-11-29 00:26:24',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/atom.xml" title="Johnny的空间站" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://i.mji.rip/2025/11/25/1c708cfe708256c27d45527ab213aa00.jpeg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">代码托管</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/" title="GitHub"><img class="back-menu-item-icon" src="https://i.mji.rip/2025/11/25/9a3038ba0b7d4515df5c663d8a6a2469.png" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gitee.com/" title="Gitee"><img class="back-menu-item-icon" src="https://i.mji.rip/2025/11/25/b6e0c3428fd3783d83d14960fbbb57a0.png" alt="Gitee"/><span class="back-menu-item-text">Gitee</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">工具</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://tool.lu/" title="在线工具"><img class="back-menu-item-icon" src="https://i.mji.rip/2025/11/30/472ebcada7a3e883391c21028c7112eb.png" alt="在线工具"/><span class="back-menu-item-text">在线工具</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://2925.com/" title="2529邮箱"><img class="back-menu-item-icon" src="https://i.mji.rip/2025/11/25/73a5a6b561d3f82301e726a911d9add3.png" alt="2529邮箱"/><span class="back-menu-item-text">2529邮箱</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.ip.cn/" title="IP地址查询"><img class="back-menu-item-icon" src="https://i.mji.rip/2025/11/30/ac05acdf53e09f62c657b7cba766905a.png" alt="IP地址查询"/><span class="back-menu-item-text">IP地址查询</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://otp.landian.vip/zh-cn/" title="Office Tool Plus"><img class="back-menu-item-icon" src="https://i.mji.rip/2025/11/30/8b1aad9e91d6b746141420287f98234d.png" alt="Office Tool Plus"/><span class="back-menu-item-text">Office Tool Plus</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.processon.com/" title="ProcessOn"><img class="back-menu-item-icon" src="https://i.mji.rip/2025/11/30/a9cccc5064d769ef4590035207b6cb01.png" alt="ProcessOn"/><span class="back-menu-item-text">ProcessOn</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://mjj.today/" title="图床"><img class="back-menu-item-icon" src="https://i.mji.rip/2025/11/25/07fd4c34a272fa061f507cf5534d2dad.png" alt="图床"/><span class="back-menu-item-text">图床</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Johnny的空间站</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 文章列表</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 全部分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=7784481513&amp;server=tencent"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 留言板</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://i.mji.rip/2025/11/25/4ace5945b5c9ad95d20b0e358431eec6.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://i.mji.rip/2025/11/25/4ace5945b5c9ad95d20b0e358431eec6.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://i.mji.rip/2025/11/25/2f9f7712d93dfbf45033d2b86243fbb3.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://i.mji.rip/2025/11/25/2f9f7712d93dfbf45033d2b86243fbb3.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">音乐</div><span class="author-content-item-title">灵魂的碰撞💥</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/11/"><span class="card-archive-list-date">十一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/10/"><span class="card-archive-list-date">十月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url">数据库</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%90%8E%E7%AB%AF/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>后端</span></a><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>数据库</span></a><a class="article-meta__tags" href="/tags/Java/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Java</span></a><a class="article-meta__tags" href="/tags/JDBC/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>JDBC</span></a></span></div></div><h1 class="post-title" itemprop="name headline">JDBC</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-10-12T16:00:00.000Z" title="发表于 2024-10-13 00:00:00">2024-10-13</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-11-28T16:26:24.907Z" title="更新于 2025-11-29 00:26:24">2025-11-29</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">13.9k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>63分钟</span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为成都"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>成都</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/5c27/#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/../images/JDBC/cover.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://chenhaonan.dpdns.org/posts/5c27/"><header><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url">数据库</a><a href="/tags/%E5%90%8E%E7%AB%AF/" tabindex="-1" itemprop="url">后端</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" tabindex="-1" itemprop="url">数据库</a><a href="/tags/Java/" tabindex="-1" itemprop="url">Java</a><a href="/tags/JDBC/" tabindex="-1" itemprop="url">JDBC</a><h1 id="CrawlerTitle" itemprop="name headline">JDBC</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Mr.Chen</span><time itemprop="dateCreated datePublished" datetime="2024-10-12T16:00:00.000Z" title="发表于 2024-10-13 00:00:00">2024-10-13</time><time itemprop="dateCreated datePublished" datetime="2025-11-28T16:26:24.907Z" title="更新于 2025-11-29 00:26:24">2025-11-29</time></header><h1 id="一、JDBC介绍"><a href="#一、JDBC介绍" class="headerlink" title="一、JDBC介绍"></a>一、JDBC介绍</h1><blockquote>
<p>JDBC (Java DataBase Contectivity) Java与数据库的连接——数据库编程</p>
<p>JDBC 是Java语言（JDK）为完成数据库的访问操作提供的一套统一的标准。</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211015111756439.png" alt="image-20211015111756439"></p>
<h1 id="二、JDBC步骤"><a href="#二、JDBC步骤" class="headerlink" title="二、JDBC步骤"></a>二、JDBC步骤</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211015121216207.png" alt="image-20211015121216207"></p>
<h1 id="三、JDBC入门案例"><a href="#三、JDBC入门案例" class="headerlink" title="三、JDBC入门案例"></a>三、JDBC入门案例</h1><blockquote>
<p>JDBC 是用Java代码完成数据访问的规范</p>
</blockquote>
<h2 id="3-1-加载驱动"><a href="#3-1-加载驱动" class="headerlink" title="3.1 加载驱动"></a>3.1 加载驱动</h2><h3 id="3-1-1-下载驱动jar包"><a href="#3-1-1-下载驱动jar包" class="headerlink" title="3.1.1 下载驱动jar包"></a>3.1.1 下载驱动jar包</h3><blockquote>
<p>对应数据库匹配版本的驱动jar包</p>
</blockquote>
<ul>
<li><p>地址<a target="_blank" rel="noopener" href="https://mvnrepository.com/">https://mvnrepository.com/</a></p>
</li>
<li><p>搜索<code>mysql</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211015124423535.png" alt="image-20211015124423535"></p>
</li>
<li><p>选择版本下载</p>
<p>MySQL数据库版本为5.x,驱动jar包建议使用<code>5.1.47</code></p>
<p>MySQL数据库版本为8.x,驱动jar包建议使用<code>8.0.x</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211015124643518.png" alt="image-20211015124643518"></p>
</li>
</ul>
<h3 id="3-1-2-将驱动jar文件添加到Java应用"><a href="#3-1-2-将驱动jar文件添加到Java应用" class="headerlink" title="3.1.2 将驱动jar文件添加到Java应用"></a>3.1.2 将驱动jar文件添加到Java应用</h3><ul>
<li>在java应用中创建lib文件夹</li>
<li>将下载好的jar文件拷贝—粘贴到lib目录</li>
<li>将驱动jar文件设置为java库：选择lib&#x2F;驱动jar—右键—Add as Library.. —OK</li>
</ul>
<h3 id="3-1-3-注册驱动"><a href="#3-1-3-注册驱动" class="headerlink" title="3.1.3 注册驱动"></a>3.1.3 注册驱动</h3><blockquote>
<p>通过反射机制，将驱动jar文件中提供的驱动类载入到JVM中</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.注册驱动（驱动jar包中的驱动类（Driver）的路径：com.mysql.cj.jdbc.Driver）</span></span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="3-2-创建连接"><a href="#3-2-创建连接" class="headerlink" title="3.2 创建连接"></a>3.2 创建连接</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.创建连接：通过数据库驱动管理器 DriverManager（java.sql.Driver）获取连接</span></span><br><span class="line"><span class="comment">//  JDBC JDK提供的数据库连接的规范 --- java.sql</span></span><br><span class="line"><span class="comment">//  java.sql.Connection接口  一个对象就表示一个数据库连接</span></span><br><span class="line"><span class="comment">//  url 数据库的统一资源定位器（定位数据库连接资源）</span></span><br><span class="line"><span class="comment">//  url参数</span></span><br><span class="line"><span class="comment">//      characterEncoding 设置编码</span></span><br><span class="line"><span class="comment">//      useSSL=true  使用SSL通信</span></span><br><span class="line"><span class="comment">//      useTimezone=true  设置客户端和服务端时区转换</span></span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3&quot;</span>;</span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;@QFedu123&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="3-3-编写SQL指令"><a href="#3-3-编写SQL指令" class="headerlink" title="3.3 编写SQL指令"></a>3.3 编写SQL指令</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.编写要执行的SQL指令:SQL指令中需要的参数可以通过字符串拼接的形式（会导致SQL注入）</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_id,book_name,book_author,book_price,book_stock,book_desc) values(&#x27;&quot;</span>+id+<span class="string">&quot;&#x27;,&#x27;&quot;</span>+name+<span class="string">&quot;&#x27;,&#x27;&quot;</span>+author+<span class="string">&quot;&#x27;,&quot;</span>+price+<span class="string">&quot;,&quot;</span>+stock+<span class="string">&quot;,&#x27;&quot;</span>+desc+<span class="string">&quot;&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="3-4-加载SQL指令"><a href="#3-4-加载SQL指令" class="headerlink" title="3.4 加载SQL指令"></a>3.4 加载SQL指令</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//4.加载SQL指令:获取SQL指令的加载器</span></span><br><span class="line"><span class="comment">//  java.sql.Statement 对象 可以理解为 SQL指令的“加载器”</span></span><br><span class="line"><span class="comment">//  java.sql.PreparedStatement 对象   SQL指令的“预编译加载器”</span></span><br><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br></pre></td></tr></table></figure>

<h2 id="3-5-执行SQL、获取结果"><a href="#3-5-执行SQL、获取结果" class="headerlink" title="3.5 执行SQL、获取结果"></a>3.5 执行SQL、获取结果</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//5.执行SQL获取执行结果</span></span><br><span class="line"><span class="comment">// a. 如果SQL指令为DQL,则  ResultSet rs = statement.executeQuery(sql);  rs中就是查询结果</span></span><br><span class="line"><span class="comment">// b. 如果SQL指令为DML，则  int i = statement.executeUpdate(sql);   i就表示DML操作影响的数据行数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果i&gt;0，表示DML操作是成功的；如果i=0表示DML操作对数据表中的数据没有影响</span></span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> statement.executeUpdate(sql);  </span><br></pre></td></tr></table></figure>

<h2 id="3-6-处理结果"><a href="#3-6-处理结果" class="headerlink" title="3.6 处理结果"></a>3.6 处理结果</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//6.处理结果（业务）</span></span><br><span class="line"><span class="comment">// 添加操作：返回值i&gt;0表示添加成功，否则表示添加失败</span></span><br><span class="line"><span class="comment">// 修改操作：返回值i&gt;0表示修改对数据有影响，如果i=0 表示对数据库没有影响</span></span><br><span class="line"><span class="comment">// 删除操作：返回值i&gt;0表示删除对数据有影响，如果i=0 表示对数据库没有影响</span></span><br><span class="line"><span class="comment">// 查询操作：从ResultSet rs中取出查询结果，封装到Java对象中</span></span><br><span class="line">System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;添加成功&quot;</span>:<span class="string">&quot;添加失败&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="3-7-关闭连接"><a href="#3-7-关闭连接" class="headerlink" title="3.7 关闭连接"></a>3.7 关闭连接</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//7.关闭连接</span></span><br><span class="line"><span class="comment">// 如果执行DML操作：需要关闭Statement和Connection</span></span><br><span class="line"><span class="comment">// 如果执行DQL操作：需要关闭ResultSet、Statement和Connection</span></span><br><span class="line"><span class="comment">// 关闭之前先判空、由xiao到大关闭</span></span><br><span class="line"><span class="keyword">if</span>(statement != <span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">    statement.close();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(connection !=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">    connection.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="四、JDBC增删查改操作实例"><a href="#四、JDBC增删查改操作实例" class="headerlink" title="四、JDBC增删查改操作实例"></a>四、JDBC增删查改操作实例</h1><blockquote>
<p>使用JDBC完成数据库的CRUD访问</p>
</blockquote>
<h2 id="4-1-insert操作"><a href="#4-1-insert操作" class="headerlink" title="4.1 insert操作"></a>4.1 insert操作</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestInsertBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;Java进阶之路&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> <span class="string">&quot;老王&quot;</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> <span class="number">22.22</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> <span class="string">&quot;这本书很好&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.注册驱动（驱动jar包中的驱动类（Driver）的路径：com.mysql.cj.jdbc.Driver）</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.创建连接：通过数据库驱动管理器 DriverManager（java.sql.Driver）获取连接</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.编写要执行的SQL指令</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(&#x27;&quot;</span>+name+<span class="string">&quot;&#x27;,&#x27;&quot;</span>+author+<span class="string">&quot;&#x27;,&quot;</span>+price+<span class="string">&quot;,&quot;</span>+stock+<span class="string">&quot;,&#x27;&quot;</span>+desc+<span class="string">&quot;&#x27;)&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.加载SQL指令:获取SQL指令的加载器</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.执行SQL获取执行结果</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> statement.executeUpdate(sql);  </span><br><span class="line">        </span><br><span class="line">        <span class="comment">//6.处理结果（业务）</span></span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;添加成功&quot;</span>:<span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//7.关闭连接</span></span><br><span class="line">        <span class="keyword">if</span>(statement != <span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection !=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-2-delete操作"><a href="#4-2-delete操作" class="headerlink" title="4.2 delete操作"></a>4.2 delete操作</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestDeleteBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">bid</span> <span class="operator">=</span> <span class="number">1012</span>;</span><br><span class="line">        <span class="comment">//使用JDBC，根据图书编号删除图书信息</span></span><br><span class="line">        <span class="comment">//1.注册驱动</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="comment">//2.创建连接</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="comment">//3.编写SQL</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=&quot;</span>+bid;</span><br><span class="line">        <span class="comment">//4.获取SQL加载器</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="comment">//5.执行SQL</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line">        <span class="comment">//6.处理结果</span></span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;删除成功&quot;</span>:<span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">        <span class="comment">//7.关闭连接</span></span><br><span class="line">        <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-3-update操作"><a href="#4-3-update操作" class="headerlink" title="4.3 update操作"></a>4.3 update操作</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUpdateBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="comment">// 根据数据记录的主键 修改其他的字段</span></span><br><span class="line">        <span class="comment">// 根据图书ID，修改图书名称、作者、价格、库存、描述</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> <span class="number">1011</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;Java进阶之路&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> <span class="string">&quot;亮亮&quot;</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> <span class="number">36.80</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> <span class="number">8</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> <span class="string">&quot;这本书非常好&quot;</span>;</span><br><span class="line"></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=&#x27;&quot;</span>+name+<span class="string">&quot;&#x27;,book_author=&#x27;&quot;</span>+author+<span class="string">&quot;&#x27;,book_price=&quot;</span>+price+<span class="string">&quot;,book_stock=&quot;</span>+stock</span><br><span class="line">                +<span class="string">&quot;,book_desc=&#x27;&quot;</span>+desc+<span class="string">&quot;&#x27; where book_id=&quot;</span>+id;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;修改成功&quot;</span>:<span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-4-select操作（一条结果）"><a href="#4-4-select操作（一条结果）" class="headerlink" title="4.4 select操作（一条结果）"></a>4.4 select操作（一条结果）</h2><table>
<thead>
<tr>
<th>结果集处理</th>
</tr>
</thead>
<tbody><tr>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211015172123116.png" alt="image-20211015172123116"></td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSelectBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="comment">//根据图书ID，查询一本图书信息</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">bid</span> <span class="operator">=</span> <span class="number">1011</span>;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=&quot;</span>+bid;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="comment">//通过executeQuery方法执行查询语句，并且将查询的结果存放到一个ResultSet对象中（结果集）</span></span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">        <span class="comment">//处理结果：从rs中获取查询结果</span></span><br><span class="line">        <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookId</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            System.out.println(bookId+<span class="string">&quot;\t&quot;</span>+bookName+<span class="string">&quot;\t&quot;</span>+bookAuthor+<span class="string">&quot;\t&quot;</span>+bookPrice+<span class="string">&quot;\t&quot;</span>+bookStock+<span class="string">&quot;\t&quot;</span>+bookDesc);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭连接  结果集也需要关闭</span></span><br><span class="line">        <span class="keyword">if</span>(rs!=<span class="literal">null</span> &amp;&amp; !rs.isClosed())&#123;</span><br><span class="line">            rs.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-5-select操作（多条结果）"><a href="#4-5-select操作（多条结果）" class="headerlink" title="4.5 select操作（多条结果）"></a>4.5 select操作（多条结果）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSelectBooks</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//查询所有图书信息</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books&quot;</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">        <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookId</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            System.out.println(bookId+<span class="string">&quot;\t&quot;</span>+bookName+<span class="string">&quot;\t&quot;</span>+bookAuthor+<span class="string">&quot;\t&quot;</span>+bookPrice+<span class="string">&quot;\t&quot;</span>+bookStock+<span class="string">&quot;\t&quot;</span>+bookDesc);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(rs!=<span class="literal">null</span> &amp;&amp; !rs.isClosed())&#123;</span><br><span class="line">            rs.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="五、JDBC的核心类与接口"><a href="#五、JDBC的核心类与接口" class="headerlink" title="五、JDBC的核心类与接口"></a>五、JDBC的核心类与接口</h1><blockquote>
<p>java.sql.DriverManager类  驱动管理器</p>
<p>java.sql.Connection接口 数据库连接</p>
<p>java.sql.Statement接口 SQL指令的“加载&#x2F;执行器”</p>
<p>java.sql.ResultSet接口   结果集</p>
</blockquote>
<h2 id="5-1-DriverManager类"><a href="#5-1-DriverManager类" class="headerlink" title="5.1 DriverManager类"></a>5.1 DriverManager类</h2><blockquote>
<ul>
<li>注册驱动</li>
<li>创建数据库连接</li>
</ul>
</blockquote>
<ul>
<li><p>注册驱动</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在Driver类中的静态初始化块中，注册驱动：DriverManager.registerDriver(new Driver());</span></span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在我们的应用程序中手动注册驱动的代码也可以省略 【Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);】</span></span><br><span class="line"><span class="comment">// 如果我们没有手动注册驱动，驱动管理器在获取连接的时候发现没有注册驱动则读取 驱动jar/META-INF/servicesjava.sql.Driver文件中配置的驱动类路径进行注册</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取连接</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// url  数据库服务器的地址</span></span><br><span class="line"><span class="comment">// username  数据库连接用户名</span></span><br><span class="line"><span class="comment">// password  数据库连接密码</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="5-2-Connection接口"><a href="#5-2-Connection接口" class="headerlink" title="5.2 Connection接口"></a>5.2 Connection接口</h2><blockquote>
<p>Connection对象表示Java应用程序与数据库之间的连接</p>
<ul>
<li>通过Connection接口对象，获取执行SQL语句的Statement对象</li>
<li>完成数据的事务管理</li>
</ul>
</blockquote>
<h3 id="5-2-1-获取Statement对象"><a href="#5-2-1-获取Statement对象" class="headerlink" title="5.2.1 获取Statement对象"></a>5.2.1 获取Statement对象</h3><ul>
<li><p>Statement接口: 编译执行静态SQL指令</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br></pre></td></tr></table></figure>
</li>
<li><p>PreparedStatement接口：继承了Statement接口，预编译动态SQL指令（解决SQL注入问题）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br></pre></td></tr></table></figure>
</li>
<li><p>CallableStatement接口：继承了PreparedStatement接口，可以调用存储过程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CallableStatement</span> <span class="variable">callableStatement</span> <span class="operator">=</span> connection.prepareCall(sql);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-2-2-事务管理"><a href="#5-2-2-事务管理" class="headerlink" title="5.2.2 事务管理"></a>5.2.2 事务管理</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开启事务（关闭事务自动提交）</span></span><br><span class="line">connection.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//事务回滚</span></span><br><span class="line">connection.rollback();</span><br><span class="line"></span><br><span class="line"><span class="comment">//提交事务</span></span><br><span class="line">connection.commit();</span><br></pre></td></tr></table></figure>

<h2 id="5-3-Statement接口"><a href="#5-3-Statement接口" class="headerlink" title="5.3 Statement接口"></a>5.3 Statement接口</h2><blockquote>
<p>用于编译、执行SQL指令的</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211018144851383.png" alt="image-20211018144851383"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行DML操作的SQL指令</span></span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行DQL操作的SQL指令</span></span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br></pre></td></tr></table></figure>

<h2 id="5-4-ResultSet接口"><a href="#5-4-ResultSet接口" class="headerlink" title="5.4 ResultSet接口"></a>5.4 ResultSet接口</h2><blockquote>
<p>ResultSet接口对象，表示查询操作返回的结果集，提供了便利的方法用于获取结果集中的数据</p>
</blockquote>
<ul>
<li><p>判断结果集中是否还有数据未取出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(select_statement);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断rs中是否还有数据</span></span><br><span class="line">rs.next();</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取rs指向的结果集中某行的数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(String columnLable);  <span class="comment">//获取rs指向的行的  列 数据（字段名）</span></span><br><span class="line"><span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="type">int</span> columnIndex);</span><br><span class="line"></span><br><span class="line">rs.getString(<span class="string">&quot;&quot;</span>); <span class="comment">//获取String类型数据</span></span><br><span class="line">rs.getDouble(<span class="string">&quot;&quot;</span>); <span class="comment">//获取Double类型数据</span></span><br><span class="line">....</span><br><span class="line">rs.getDate(<span class="string">&quot;&quot;</span>); <span class="comment">//获取日期类型数据</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="六、SQL注入问题"><a href="#六、SQL注入问题" class="headerlink" title="六、SQL注入问题"></a>六、SQL注入问题</h1><h2 id="6-1-什么是SQL注入问题？"><a href="#6-1-什么是SQL注入问题？" class="headerlink" title="6.1 什么是SQL注入问题？"></a>6.1 什么是SQL注入问题？</h2><blockquote>
<p>在JDBC操作SQL指令编写过程中，如果SQL指令中需要数据，我们可以通过字符串拼接的形式将参数拼接到SQL指令中，如<code>String sql = &quot;delete from books where book_id=&quot;+s;</code>(s就是拼接到SQL中的变量)</p>
<p>使用字符串拼接变量的形式来设置SQL语句中的数据，可能会导致<code>因变量值的改变引起SQL指令的原意发生改变</code>，这就被称为SQL注入。SQL注入问题是需要避免的。</p>
<p>例如：</p>
<ul>
<li>如果s的值为<code>1</code>，SQL指令 ： delete from books where book_id&#x3D;1</li>
<li>如果s的值为<code>1 or 1=1</code>，SQL指令：delete from books where book_id&#x3D;1 or 1&#x3D;1</li>
</ul>
</blockquote>
<h2 id="6-2-如何解决SQL注入问题？"><a href="#6-2-如何解决SQL注入问题？" class="headerlink" title="6.2 如何解决SQL注入问题？"></a>6.2 如何解决SQL注入问题？</h2><blockquote>
<p>使用PreparedStatement进行SQL预编译解决SQL注入问题：</p>
<ul>
<li><p>在编写SQL指令时，如果SQL指令中需要参数，一律使用<code>?</code>参数占位符</p>
</li>
<li><p>如果SQL指令中有<code>?</code>，在JDBC操作步骤中不再使用Statement，而是从Conection对象获取PreparedStatement对SQL指令进行预编译 <code>PreparedStatement preparedStatement = connection.prepareStatement(sql);</code></p>
</li>
<li><p>预编译完成之后，通过PreparedStatement对象给预编译后的SQL指令的<code>?</code>复制</p>
<ul>
<li>prepareadStatement.setInt(参数占位符序号,值);</li>
<li>prepareadStatement.setString(参数占位符序号,值);</li>
</ul>
</li>
<li><p>SQL指令中的所有<code>?</code>完成赋值之后，通过PreparedStatement执行SQL<strong>执行SQL时不再加载SQL</strong></p>
<ul>
<li>int i &#x3D; prepareadStatement.executeUpdate();</li>
<li>ResultSet rs &#x3D; preparedStatement.executeQuery();</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="6-3-使用PreparedStatement预编译案例"><a href="#6-3-使用PreparedStatement预编译案例" class="headerlink" title="6.3 使用PreparedStatement预编译案例"></a>6.3 使用PreparedStatement预编译案例</h2><ul>
<li>删除操作</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysql.cj.jdbc.Driver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestDeleteBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入你要删除的图书的ID：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">        <span class="type">int</span> <span class="variable">bid</span> <span class="operator">=</span> Integer.parseInt(s);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.注册驱动</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="comment">//2.创建连接</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="comment">//3.编写SQL:SQL指令中的参数使用?表示</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="comment">//4.如果SQL指令有参数占位符?,则从Connection获取PreparedStatement预编译SQL指令</span></span><br><span class="line">        <span class="comment">//  预编译：在SQL指令中的参数赋值之前对SQL执行的语法结构进行编译</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//  SQL指令预编译之后，给SQL中的?赋值</span></span><br><span class="line">        preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">        <span class="comment">//5.执行SQL</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">        <span class="comment">//6.处理结果</span></span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;删除成功&quot;</span>:<span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">        <span class="comment">//7.关闭连接</span></span><br><span class="line">        <span class="keyword">if</span>(preparedStatement!=<span class="literal">null</span> &amp;&amp; !preparedStatement.isClosed())&#123;</span><br><span class="line">            preparedStatement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>修改操作</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestInsertBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;Java进阶之路&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> <span class="string">&quot;老王&quot;</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> <span class="number">22.22</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> <span class="string">&quot;这本书很好&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.注册驱动</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.创建连接</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.编写要执行的SQL指令:SQL指令中所需的参数一律使用?</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.SQL中有? 使用PreparedStatement预编译SQL</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 给SQL指令中的?复制</span></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>,name);</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>,author);</span><br><span class="line">        preparedStatement.setDouble(<span class="number">3</span>,price);</span><br><span class="line">        preparedStatement.setInt(<span class="number">4</span>,stock);</span><br><span class="line">        preparedStatement.setString(<span class="number">5</span>,desc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.执行SQL获取执行结果</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate(); </span><br><span class="line"></span><br><span class="line">        <span class="comment">//6.处理结果（业务）</span></span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;添加成功&quot;</span>:<span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//7.关闭连接</span></span><br><span class="line">        <span class="keyword">if</span>(preparedStatement != <span class="literal">null</span> &amp;&amp; !preparedStatement.isClosed())&#123;</span><br><span class="line">            preparedStatement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection !=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习1：修改操作</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUpdateBook</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="comment">// 根据数据记录的主键 修改其他的字段</span></span><br><span class="line">        <span class="comment">// 根据图书ID，修改图书名称、作者、价格、库存、描述</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> <span class="number">1011</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;Java进阶之路&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> <span class="string">&quot;亮亮&quot;</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> <span class="number">36.80</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> <span class="number">8</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> <span class="string">&quot;这本书非常好&quot;</span>;</span><br><span class="line"></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@QFedu123&quot;</span>);</span><br><span class="line">        <span class="comment">//1.</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">        <span class="comment">//2.</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//3.</span></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>,name);</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>,author);</span><br><span class="line">        preparedStatement.setDouble(<span class="number">3</span>,price);</span><br><span class="line">        preparedStatement.setInt(<span class="number">4</span>,stock);</span><br><span class="line">        preparedStatement.setString(<span class="number">5</span>,desc);</span><br><span class="line">        <span class="comment">//4.</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">        System.out.println(i&gt;<span class="number">0</span>?<span class="string">&quot;修改成功&quot;</span>:<span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">        <span class="comment">//5.</span></span><br><span class="line">        <span class="keyword">if</span>(preparedStatement!=<span class="literal">null</span> &amp;&amp; !preparedStatement.isClosed())&#123;</span><br><span class="line">            preparedStatement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2：根据ID查询图书信息</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">package com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line">import java.sql.<span class="operator">*</span>;</span><br><span class="line"></span><br><span class="line">public class TestSelectBook &#123;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">static</span> void main(String[] args) throws ClassNotFoundException, <span class="keyword">SQLException</span> &#123;</span><br><span class="line">        <span class="operator">/</span><span class="operator">/</span>根据图书ID，查询一本图书信息</span><br><span class="line">        <span class="type">int</span> bid <span class="operator">=</span> <span class="number">1013</span>;</span><br><span class="line">        Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><span class="line">        String url <span class="operator">=</span> &quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;;</span><br><span class="line">        Connection connection <span class="operator">=</span> DriverManager.getConnection(url, &quot;root&quot;, &quot;@QFedu123&quot;);</span><br><span class="line">        String <span class="keyword">sql</span> <span class="operator">=</span> &quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;;</span><br><span class="line">        PreparedStatement preparedStatement <span class="operator">=</span> connection.prepareStatement(<span class="keyword">sql</span>);</span><br><span class="line">        preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">        <span class="operator">/</span><span class="operator">/</span>通过executeQuery方法执行查询语句，并且将查询的结果存放到一个ResultSet对象中（结果集）</span><br><span class="line">        ResultSet rs <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line">        <span class="operator">/</span><span class="operator">/</span>处理结果：从rs中获取查询结果</span><br><span class="line">        if(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> bookId <span class="operator">=</span> rs.getInt(&quot;book_id&quot;);</span><br><span class="line">            String bookName <span class="operator">=</span> rs.getString(&quot;book_name&quot;);</span><br><span class="line">            String bookAuthor <span class="operator">=</span> rs.getString(&quot;book_author&quot;);</span><br><span class="line">            <span class="keyword">double</span> bookPrice <span class="operator">=</span> rs.getDouble(&quot;book_price&quot;);</span><br><span class="line">            <span class="type">int</span> bookStock <span class="operator">=</span> rs.getInt(&quot;book_stock&quot;);</span><br><span class="line">            String bookDesc <span class="operator">=</span> rs.getString(&quot;book_desc&quot;);</span><br><span class="line">            System.out.println(bookId<span class="operator">+</span>&quot;\t&quot;<span class="operator">+</span>bookName<span class="operator">+</span>&quot;\t&quot;<span class="operator">+</span>bookAuthor<span class="operator">+</span>&quot;\t&quot;<span class="operator">+</span>bookPrice<span class="operator">+</span>&quot;\t&quot;<span class="operator">+</span>bookStock<span class="operator">+</span>&quot;\t&quot;<span class="operator">+</span>bookDesc);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="operator">/</span><span class="operator">/</span>关闭连接  结果集也需要关闭</span><br><span class="line">        if(rs<span class="operator">!=</span><span class="keyword">null</span> <span class="operator">&amp;&amp;</span> <span class="operator">!</span>rs.isClosed())&#123;</span><br><span class="line">            rs.close();</span><br><span class="line">        &#125;</span><br><span class="line">        if(preparedStatement<span class="operator">!=</span><span class="keyword">null</span> <span class="operator">&amp;&amp;</span> <span class="operator">!</span>preparedStatement.isClosed())&#123;</span><br><span class="line">            preparedStatement.close();</span><br><span class="line">        &#125;</span><br><span class="line">        if(connection<span class="operator">!=</span><span class="keyword">null</span> <span class="operator">&amp;&amp;</span> <span class="operator">!</span>connection.isClosed())&#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>备注</code></strong> 如果SQL指令中需要参数，则使用PreparedStatement进行SQL预编译，如果SQL指令中没有参数建议使用Statement（Statement执行效率要高于PreparedStatement）。</p>
<h1 id="七、工具类封装"><a href="#七、工具类封装" class="headerlink" title="七、工具类封装"></a>七、工具类封装</h1><h2 id="7-1-代码的复用性"><a href="#7-1-代码的复用性" class="headerlink" title="7.1 代码的复用性"></a>7.1 代码的复用性</h2><p>在我们的应用程序中，如果需要完成相同的操作，相同的代码无需重复编写，我们只需一次编写多次调用即可！</p>
<blockquote>
<p>JDBC数据库编程是由一个固定的步骤：</p>
<ol>
<li>注册驱动</li>
<li>创建连接</li>
<li>编写SQL</li>
<li>获取Statement对象</li>
<li>执行SQL</li>
<li>处理结果</li>
<li>关闭连接</li>
</ol>
</blockquote>
<h2 id="7-2-工具类封装"><a href="#7-2-工具类封装" class="headerlink" title="7.2 工具类封装"></a>7.2 工具类封装</h2><blockquote>
<p>DBManager</p>
<p>DBUtil</p>
<p>JDBCUtil</p>
<p>DBHelper</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DBHelper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*将创建数据库连接所需的字符串定义为常量，集中管理*/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DRIVER</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">URL</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USERNAME</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;@QFedu123&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册驱动只需执行一次，因此我们放在帮助类的静态初始化块中完成</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(DRIVER);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----------注册驱动失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建数据库连接对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DriverManager.getConnection(URL, USERNAME, PASSWORD);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----------创建连接失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭连接</span></span><br><span class="line"><span class="comment">     * 多态的应用：使用Statement接口做参数，既可以传递Statement接口对象，</span></span><br><span class="line"><span class="comment">     * 也可以传递PreparedStatement接口对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Statement statement, Connection connection)</span>&#123;</span><br><span class="line">        close(<span class="literal">null</span>,statement,connection);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭连接</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(ResultSet resultSet,Statement statement, Connection connection)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(resultSet!=<span class="literal">null</span> &amp;&amp; !resultSet.isClosed())&#123;</span><br><span class="line">                resultSet.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(connection!=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;~~~~~关闭数据库连接失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="八、DAO与DTO的封装"><a href="#八、DAO与DTO的封装" class="headerlink" title="八、DAO与DTO的封装"></a>八、DAO与DTO的封装</h1><blockquote>
<p>DAO  Data Access Object 数据访问对象</p>
<p>DTO Data Transfer Object 数据传输对象（实体类）  用于传输DML操作参数及DQL的查询结果</p>
</blockquote>
<h2 id="8-1-CRUD方法的封装"><a href="#8-1-CRUD方法的封装" class="headerlink" title="8.1 CRUD方法的封装"></a>8.1 CRUD方法的封装</h2><blockquote>
<p>面向对象的特征之一——封装</p>
<p>我们将能够完成某个CRUD操作的代码单独定义成一个方法，当需要完成此CRUD操作时调用这个方法即可;</p>
</blockquote>
<ul>
<li>insert操作封装</li>
<li>delete操作封装</li>
<li>update操作封装</li>
</ul>
<h2 id="8-2-DTO实体类封装"><a href="#8-2-DTO实体类封装" class="headerlink" title="8.2 DTO实体类封装"></a>8.2 DTO实体类封装</h2><blockquote>
<p>问题：在封装CRUD方法时，对于查询操作而言，需要将查询到的数据库记录返回给调用者，但是一个查询方法只能返回一个值，而一条数据库记录有多个值，如何将一条数据库记录的多个值返回呢？</p>
</blockquote>
<blockquote>
<p>处理：在Java程序中创建一个属性与数据库表匹配的类，通过此类的对象封装查询到的数据，我们把用于传递JDBC增删查改操作的数据的对象称之为<code>数据传输对象</code>——DTO(实体类：带有属性，其对象可以存放数据的类)</p>
</blockquote>
<p>实体类创建规则：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 1.类中属性的个数和类型，与对应的数据表保持一致</span><br><span class="line">* 2.提供所有属性的get和set方法：Alt+Insert --- Getter And Setter --- 选择所有属性 --- OK</span><br><span class="line">* 3.提供全参构造器：Alt+Insert --- Constructor --- 选择所有属性 --- OK</span><br><span class="line">* 4.提供无参构造器：Alt+Insert --- Constructor --- SelectNone</span><br><span class="line">* 5.重写toString方法：Alt+Insert --- toString --- OK</span><br><span class="line">* 6.[暂略] 重写hashcode和equals</span><br><span class="line">* 7.[暂略]实现序列化Serializable接口</span><br></pre></td></tr></table></figure>

<p>实体类实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookId;</span><br><span class="line">    <span class="keyword">private</span> String bookName;</span><br><span class="line">    <span class="keyword">private</span> String bookAuthor;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> bookPrice;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookStock;</span><br><span class="line">    <span class="keyword">private</span> String bookDesc;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Book&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;bookId=&quot;</span> + bookId +</span><br><span class="line">                <span class="string">&quot;, bookName=&#x27;&quot;</span> + bookName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, bookAuthor=&#x27;&quot;</span> + bookAuthor + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, bookPrice=&quot;</span> + bookPrice +</span><br><span class="line">                <span class="string">&quot;, bookStock=&quot;</span> + bookStock +</span><br><span class="line">                <span class="string">&quot;, bookDesc=&#x27;&quot;</span> + bookDesc + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Book</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Book</span><span class="params">(<span class="type">int</span> bookId, String bookName, String bookAuthor, <span class="type">double</span> bookPrice, <span class="type">int</span> bookStock, String bookDesc)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bookId = bookId;</span><br><span class="line">        <span class="built_in">this</span>.bookName = bookName;</span><br><span class="line">        <span class="built_in">this</span>.bookAuthor = bookAuthor;</span><br><span class="line">        <span class="built_in">this</span>.bookPrice = bookPrice;</span><br><span class="line">        <span class="built_in">this</span>.bookStock = bookStock;</span><br><span class="line">        <span class="built_in">this</span>.bookDesc = bookDesc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//get和set方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用实体类封装查询操作返回的结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 根据图书ID查询一条图书记录</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> Book <span class="title function_">queryBook</span><span class="params">(<span class="type">int</span> bid)</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">    <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">    preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">    <span class="comment">//通过executeQuery方法执行查询语句，并且将查询的结果存放到一个ResultSet对象中（结果集）</span></span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line">    <span class="comment">//处理结果：从rs中获取查询结果</span></span><br><span class="line">    <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">        <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">        <span class="comment">//我们需要将查询到的一条数据库图书记录的6个值返回</span></span><br><span class="line">        book = <span class="keyword">new</span> <span class="title class_">Book</span>(id,name,author,price,stock,desc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//关闭连接  结果集也需要关闭</span></span><br><span class="line">    DBHelper.close(rs,preparedStatement,connection);</span><br><span class="line">    <span class="keyword">return</span> book;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-3-实体类封装查询结果"><a href="#8-3-实体类封装查询结果" class="headerlink" title="8.3 实体类封装查询结果"></a>8.3 实体类封装查询结果</h2><blockquote>
<p>查询的每条结果分别存放到一个DTO对象中，再将多个DTO对象存放到一个List集合中，返回这个List集合</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211019105351846.png" alt="image-20211019105351846"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.les1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dto.Book;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSelectBooks</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Book&gt; list = <span class="keyword">new</span> <span class="title class_">TestSelectBooks</span>().listBooks();</span><br><span class="line">        <span class="keyword">for</span>(Book b:list)&#123;</span><br><span class="line">            System.out.println(b.getBookName()+<span class="string">&quot;\t&quot;</span>+b.getBookAuthor());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listBooks</span><span class="params">()</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        List&lt;Book&gt; bookList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//查询所有图书信息</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books&quot;</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">        <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookId</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>(bookId, bookName, bookAuthor, bookPrice, bookStock, bookDesc);</span><br><span class="line">            bookList.add(book);</span><br><span class="line">        &#125;</span><br><span class="line">        DBHelper.close(rs,statement,connection);</span><br><span class="line">        <span class="keyword">return</span> bookList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-4-实体类传递添加、修改操作参数"><a href="#8-4-实体类传递添加、修改操作参数" class="headerlink" title="8.4 实体类传递添加、修改操作参数"></a>8.4 实体类传递添加、修改操作参数</h2><blockquote>
<p>在JDBC的添加、修改等方法中需要多个数据，我们可以通过实体类来进行参数传递</p>
</blockquote>
<h3 id="8-4-1-添加操作"><a href="#8-4-1-添加操作" class="headerlink" title="8.4.1 添加操作"></a>8.4.1 添加操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insertBook</span><span class="params">(Book book)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">//调用工具类，获取数据库连接对象</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">    preparedStatement.setString(<span class="number">1</span>,book.getBookName());</span><br><span class="line">    preparedStatement.setString(<span class="number">2</span>,book.getBookAuthor());</span><br><span class="line">    preparedStatement.setDouble(<span class="number">3</span>,book.getBookPrice());</span><br><span class="line">    preparedStatement.setInt(<span class="number">4</span>,book.getBookStock());</span><br><span class="line">    preparedStatement.setString(<span class="number">5</span>,book.getBookDesc());</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();  </span><br><span class="line">    flag = i&gt;<span class="number">0</span>;</span><br><span class="line">    <span class="comment">//关闭连接</span></span><br><span class="line">    DBHelper.close(preparedStatement,connection);</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-4-2-修改操作"><a href="#8-4-2-修改操作" class="headerlink" title="8.4.2 修改操作"></a>8.4.2 修改操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateBook</span><span class="params">(Book book)</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">    preparedStatement.setString(<span class="number">1</span>,book.getBookName());</span><br><span class="line">    preparedStatement.setString(<span class="number">2</span>,book.getBookAuthor());</span><br><span class="line">    preparedStatement.setDouble(<span class="number">3</span>,book.getBookPrice());</span><br><span class="line">    preparedStatement.setInt(<span class="number">4</span>,book.getBookStock());</span><br><span class="line">    preparedStatement.setString(<span class="number">5</span>,book.getBookDesc());</span><br><span class="line">    preparedStatement.setInt(<span class="number">6</span>,book.getBookId());</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">    flag = i&gt;<span class="number">0</span>;</span><br><span class="line">    DBHelper.close(preparedStatement,connection);</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-5-DAO类封装"><a href="#8-5-DAO类封装" class="headerlink" title="8.5 DAO类封装"></a>8.5 DAO类封装</h2><blockquote>
<p>DAO封装：将对数据库中同一张数据表的JDBC操作方法封装到同一个Java类中，这个类就是访问此数据表的<code>数据访问对象</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteBook</span><span class="params">(<span class="type">int</span> bid)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//使用JDBC，根据图书编号删除图书信息</span></span><br><span class="line">        <span class="comment">//1.注册驱动 创建连接</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="comment">//3.编写SQL</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="comment">//4.如果SQL指令有参数占位符?,则从Connection获取PreparedStatement预编译SQL指令</span></span><br><span class="line">        <span class="comment">//  预编译：在SQL指令中的参数赋值之前对SQL执行的语法结构进行编译</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//  SQL指令预编译之后，给SQL中的?赋值</span></span><br><span class="line">        preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">        <span class="comment">//5.执行SQL</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">        <span class="comment">//6.处理结果</span></span><br><span class="line">        flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//7.关闭连接</span></span><br><span class="line">        DBHelper.close(preparedStatement,connection);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加图书</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果添加成功返回true，如果添加失败则返回false</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insertBook</span><span class="params">(Book book)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//调用工具类，获取数据库连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>,book.getBookName());</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>,book.getBookAuthor());</span><br><span class="line">        preparedStatement.setDouble(<span class="number">3</span>,book.getBookPrice());</span><br><span class="line">        preparedStatement.setInt(<span class="number">4</span>,book.getBookStock());</span><br><span class="line">        preparedStatement.setString(<span class="number">5</span>,book.getBookDesc());</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();  <span class="comment">// 如果i&gt;0，表示DML操作是成功的；如果i=0表示DML操作对数据表中的数据没有影响</span></span><br><span class="line">        flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//关闭连接</span></span><br><span class="line">        DBHelper.close(preparedStatement,connection);</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据图书ID查询一条图书记录</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">queryBook</span><span class="params">(<span class="type">int</span> bid)</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">        <span class="comment">//通过executeQuery方法执行查询语句，并且将查询的结果存放到一个ResultSet对象中（结果集）</span></span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line">        <span class="comment">//处理结果：从rs中获取查询结果</span></span><br><span class="line">        <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            <span class="comment">//我们需要将查询到的一条数据库图书记录的6个值返回</span></span><br><span class="line">            book = <span class="keyword">new</span> <span class="title class_">Book</span>(id,name,author,price,stock,desc);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭连接  结果集也需要关闭</span></span><br><span class="line">        DBHelper.close(rs,preparedStatement,connection);</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listBooks</span><span class="params">()</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        List&lt;Book&gt; bookList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//查询所有图书信息</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books&quot;</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line">        <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookId</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>(bookId, bookName, bookAuthor, bookPrice, bookStock, bookDesc);</span><br><span class="line">            bookList.add(book);</span><br><span class="line">        &#125;</span><br><span class="line">        DBHelper.close(rs,statement,connection);</span><br><span class="line">        <span class="keyword">return</span> bookList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateBook</span><span class="params">(Book book)</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnection();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>,book.getBookName());</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>,book.getBookAuthor());</span><br><span class="line">        preparedStatement.setDouble(<span class="number">3</span>,book.getBookPrice());</span><br><span class="line">        preparedStatement.setInt(<span class="number">4</span>,book.getBookStock());</span><br><span class="line">        preparedStatement.setString(<span class="number">5</span>,book.getBookDesc());</span><br><span class="line">        preparedStatement.setInt(<span class="number">6</span>,book.getBookId());</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">        flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        DBHelper.close(preparedStatement,connection);</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-6-DAO类代码优化"><a href="#8-6-DAO类代码优化" class="headerlink" title="8.6 DAO类代码优化"></a>8.6 DAO类代码优化</h2><blockquote>
<p>1.在应用程序开发中，如果方法中抛出异常且自己可以处理，则直接通过try&#x2F;catch进行捕获处理；</p>
<p>2.JDBC操作方法的连接需要放在finally中进行关闭；</p>
<p>3.将数据库连接Connection、Statement、ResultSet等需要关闭的数据库对象定义在try之前;</p>
<p>4.因为所有的JDBC操作都需要Conection、Statement对象，查询方法都需要ResultSet对象，因此在DAO中可以将这些对象定义成类的成员变量</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dto.Book;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Connection connection;</span><br><span class="line">    <span class="keyword">private</span> Statement statement;</span><br><span class="line">    <span class="keyword">private</span> PreparedStatement preparedStatement;</span><br><span class="line">    <span class="keyword">private</span> ResultSet rs;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteBook</span><span class="params">(<span class="type">int</span> bid)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            connection = DBHelper.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setInt(<span class="number">1</span>,bid);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insertBook</span><span class="params">(Book book)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//调用工具类，获取数据库连接对象</span></span><br><span class="line">            connection = DBHelper.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,book.getBookName());</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>,book.getBookAuthor());</span><br><span class="line">            preparedStatement.setDouble(<span class="number">3</span>,book.getBookPrice());</span><br><span class="line">            preparedStatement.setInt(<span class="number">4</span>,book.getBookStock());</span><br><span class="line">            preparedStatement.setString(<span class="number">5</span>,book.getBookDesc());</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();  <span class="comment">// 如果i&gt;0，表示DML操作是成功的；如果i=0表示DML操作对数据表中的数据没有影响</span></span><br><span class="line">            flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">queryBook</span><span class="params">(<span class="type">int</span> bid)</span> &#123;</span><br><span class="line">        <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DBHelper.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setInt(<span class="number">1</span>, bid);</span><br><span class="line">            <span class="comment">//通过executeQuery方法执行查询语句，并且将查询的结果存放到一个ResultSet对象中（结果集）</span></span><br><span class="line">            rs = preparedStatement.executeQuery();</span><br><span class="line">            <span class="comment">//处理结果：从rs中获取查询结果</span></span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">author</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">desc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">                <span class="comment">//我们需要将查询到的一条数据库图书记录的6个值返回</span></span><br><span class="line">                book = <span class="keyword">new</span> <span class="title class_">Book</span>(id, name, author, price, stock, desc);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(rs, preparedStatement, connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listBooks</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;Book&gt; bookList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DBHelper.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books&quot;</span>;</span><br><span class="line">            statement = connection.createStatement();</span><br><span class="line">            rs = statement.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">bookId</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">                <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>(bookId, bookName, bookAuthor, bookPrice, bookStock, bookDesc);</span><br><span class="line">                bookList.add(book);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(rs, statement, connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bookList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateBook</span><span class="params">(Book book)</span>  &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DBHelper.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>, book.getBookName());</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>, book.getBookAuthor());</span><br><span class="line">            preparedStatement.setDouble(<span class="number">3</span>, book.getBookPrice());</span><br><span class="line">            preparedStatement.setInt(<span class="number">4</span>, book.getBookStock());</span><br><span class="line">            preparedStatement.setString(<span class="number">5</span>, book.getBookDesc());</span><br><span class="line">            preparedStatement.setInt(<span class="number">6</span>, book.getBookId());</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            flag = i &gt; <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement, connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="九、JDBC综合案例"><a href="#九、JDBC综合案例" class="headerlink" title="九、JDBC综合案例"></a>九、JDBC综合案例</h1><blockquote>
<p>完成学生信息的CRUD操作</p>
</blockquote>
<h2 id="9-1-JDBC数据库编程的流程"><a href="#9-1-JDBC数据库编程的流程" class="headerlink" title="9.1 JDBC数据库编程的流程"></a>9.1 JDBC数据库编程的流程</h2><ul>
<li><p>创建数据库、数据表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> students(</span><br><span class="line">	stu_num <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">primary key</span>,</span><br><span class="line">	stu_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not null</span>,</span><br><span class="line">	stu_gender <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">not null</span>,</span><br><span class="line">	stu_age <span class="type">int</span> <span class="keyword">not null</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建新的Java工程</p>
</li>
<li><p>创建JDBC的工具类：DBHelper</p>
</li>
<li><p>创建DTO类（用于封装参数及查询结果）</p>
</li>
<li><p>创建DAO类（用于完成CRUD操作）</p>
</li>
</ul>
<h2 id="9-2-创建JDBC工具类"><a href="#9-2-创建JDBC工具类" class="headerlink" title="9.2 创建JDBC工具类"></a>9.2 创建JDBC工具类</h2><ul>
<li>在Java工程中创建package :<code>com.qfedu.jdbc.utils</code></li>
<li>在<code>com.qfedu.jdbc.utils</code>包中创建工具类<code>DBHelper</code></li>
<li>编写<code>DBHelper</code>工具类：<ul>
<li>添加驱动jar文件</li>
<li>编写DBHelper代码</li>
</ul>
</li>
</ul>
<h2 id="9-3-创建DTO类"><a href="#9-3-创建DTO类" class="headerlink" title="9.3 创建DTO类"></a>9.3 创建DTO类</h2><ul>
<li><p>在Java工程中创建package：<code>com.qfedu.jdbc.dto</code></p>
</li>
<li><p>在<code>com.qfedu.jdbc.dto</code>创建数据表对应的实体类<code>Student</code></p>
</li>
<li><p>编写实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String stuNum;</span><br><span class="line">    <span class="keyword">private</span> String stuName;</span><br><span class="line">    <span class="keyword">private</span> String stuGender;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> stuAge;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;stuNum=&#x27;&quot;</span> + stuNum + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, stuName=&#x27;&quot;</span> + stuName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, stuGender=&#x27;&quot;</span> + stuGender + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, stuAge=&quot;</span> + stuAge +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String stuNum, String stuName, String stuGender, <span class="type">int</span> stuAge)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.stuNum = stuNum;</span><br><span class="line">        <span class="built_in">this</span>.stuName = stuName;</span><br><span class="line">        <span class="built_in">this</span>.stuGender = stuGender;</span><br><span class="line">        <span class="built_in">this</span>.stuAge = stuAge;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//get  set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="9-4-创建DAO类"><a href="#9-4-创建DAO类" class="headerlink" title="9.4 创建DAO类"></a>9.4 创建DAO类</h2><blockquote>
<p>创建DAO类，完成JDBC操作</p>
</blockquote>
<ul>
<li>在Java项目中创建package:<code>com.qfedu.jdbc.dao</code></li>
<li>在<code>com.qfedu.jdbc.dao</code>包中创建类<code>StudentDAO</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dto.Student;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Connection connection;</span><br><span class="line">    <span class="keyword">private</span> Statement statement;</span><br><span class="line">    <span class="keyword">private</span> PreparedStatement preparedStatement;</span><br><span class="line">    <span class="keyword">private</span> ResultSet resultSet;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1、添加学生信息</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insert</span><span class="params">(Student student)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into students(stu_num,stu_name,stu_gender,stu_age) values(?,?,?,?)&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,student.getStuNum());</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>,student.getStuName());</span><br><span class="line">            preparedStatement.setString(<span class="number">3</span>,student.getStuGender());</span><br><span class="line">            preparedStatement.setInt(<span class="number">4</span>,student.getStuAge());</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//2、根据学号查询一个学生记录</span></span><br><span class="line">    <span class="keyword">public</span> Student <span class="title function_">queryStudent</span><span class="params">(String snum)</span>&#123;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select stu_num,stu_name,stu_gender,stu_age from students where stu_num=?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,snum);</span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line">            <span class="keyword">if</span>(resultSet.next())&#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuNum</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_num&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuGender</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_gender&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">stuAge</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;stu_age&quot;</span>);</span><br><span class="line">                student = <span class="keyword">new</span> <span class="title class_">Student</span>(stuNum,stuName,stuGender,stuAge);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(resultSet,preparedStatement,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> student;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//3、查询多个学生信息</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Student&gt; <span class="title function_">listStudents</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;Student&gt; studentList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select stu_num,stu_name,stu_gender,stu_age from students&quot;</span>;</span><br><span class="line">            statement = connection.createStatement();</span><br><span class="line">            resultSet = statement.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span>(resultSet.next())&#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuNum</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_num&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">stuGender</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;stu_gender&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">stuAge</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;stu_age&quot;</span>);</span><br><span class="line">                <span class="type">Student</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(stuNum,stuName,stuGender,stuAge);</span><br><span class="line">                studentList.add(s);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(resultSet,statement,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> studentList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-5-测试DAO类中的方法"><a href="#9-5-测试DAO类中的方法" class="headerlink" title="9.5 测试DAO类中的方法"></a>9.5 测试DAO类中的方法</h2><blockquote>
<p>使用junit对DAO中创建的JDBC方法进行单元测试</p>
</blockquote>
<h3 id="9-5-1-下载导入junit依赖到项目中"><a href="#9-5-1-下载导入junit依赖到项目中" class="headerlink" title="9.5.1 下载导入junit依赖到项目中"></a>9.5.1 下载导入junit依赖到项目中</h3><ul>
<li><p>下载：<a target="_blank" rel="noopener" href="https://mvnrepository.com/">https://mvnrepository.com/</a>     （如果使用junit 4.10 + 版本单元测试，需要以下两个jar文件）</p>
<ul>
<li>junit-4.12.jar</li>
<li>hamcrest-core-1.3.jar</li>
</ul>
</li>
<li><p>将<code>junit-4.12.jar</code>、<code>hamcrest-core-1.3.jar</code>拷贝项目的<code>lib</code>文件夹</p>
</li>
<li><p>选择拷贝到项目中的jar文件—右键—Add as Library</p>
</li>
</ul>
<h3 id="9-5-2-创建单元测试类"><a href="#9-5-2-创建单元测试类" class="headerlink" title="9.5.2 创建单元测试类"></a>9.5.2 创建单元测试类</h3><blockquote>
<p>如果我们需要对某个类中的方法进行单元测试，我们需要创建这个类的测试类</p>
<p>StudentDAO ———&gt; StudentDAOTest（测试类：类名&#x3D;被测试类+Test）</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dao.StudentDAO;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dto.Student;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Descript</span> 此类是StudentDAO的单元测试类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> 千锋涛哥</span></span><br><span class="line"><span class="comment"> * 公众号： Java架构栈</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentDAOTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.在测试类中定义成员变量：创建被测试类的对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">StudentDAO</span> <span class="variable">studentDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StudentDAO</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2创建测试方法 ： 用来测试StudentDAO类中的insertStudent方法</span></span><br><span class="line">    <span class="comment">//a.测试方法名=test+被测试方法名</span></span><br><span class="line">    <span class="comment">//b.测试方法无参数无返回值</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testInsertStudent</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//准备被测试方法所需的参数</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;1008&quot;</span>,<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;男&quot;</span>,<span class="number">20</span>);</span><br><span class="line">        <span class="comment">//调用被测试方法，获取结果</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> studentDAO.insertStudent(stu);</span><br><span class="line">        <span class="comment">//断言返回结果(成立 | 不成立)</span></span><br><span class="line">        assertTrue(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testQueryStudent</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">snum</span> <span class="operator">=</span> <span class="string">&quot;1008&quot;</span>;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> studentDAO.queryStudent(snum);</span><br><span class="line">        assertEquals(<span class="string">&quot;Tom2&quot;</span>,student.getStuName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testListStudents</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;Student&gt; studentList = studentDAO.listStudents();</span><br><span class="line">        assertEquals(<span class="number">8</span>,studentList.size());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="十、JDBC事务管理"><a href="#十、JDBC事务管理" class="headerlink" title="十、JDBC事务管理"></a>十、JDBC事务管理</h1><blockquote>
<ul>
<li>什么是事务？</li>
<li>事务的四大特性—ACID</li>
<li>事务的隔离级别</li>
<li>MySQL事务管理：<ul>
<li>start transaction</li>
<li>rollback</li>
<li>commit</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="10-1-JDBC实现借书操作"><a href="#10-1-JDBC实现借书操作" class="headerlink" title="10.1 JDBC实现借书操作"></a>10.1 JDBC实现借书操作</h2><blockquote>
<ol>
<li>向<code>records</code>表添加借书记录</li>
<li>修改<code>books</code>表中的库存</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 借书：</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> stuNum 借书的学生学号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bookId 借书的图书编号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> num   借书的数量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">borrowBook2</span><span class="params">(String stuNum,<span class="type">int</span> bookId,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//1.向`records`表添加借书记录</span></span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;insert into records(snum,bid,borrow_num,is_return,borrow_date) values(?,?,?,0,sysdate())&quot;</span>;</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql1);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,stuNum);</span><br><span class="line">            preparedStatement.setInt(<span class="number">2</span>,bookId);</span><br><span class="line">            preparedStatement.setInt(<span class="number">3</span>,num);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">10</span>/<span class="number">0</span>;  <span class="comment">//造异常：算术异常</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//2.修改`books`表中的库存</span></span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection2</span> <span class="operator">=</span> DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;update books set book_stock=book_stock-? where book_id=?&quot;</span>;</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">preparedStatement2</span> <span class="operator">=</span> connection2.prepareStatement(sql2);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">1</span>,num);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">2</span>,bookId);</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> preparedStatement2.executeUpdate();</span><br><span class="line">            flag = i&gt;<span class="number">0</span> &amp;&amp; j&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 关闭连接</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>分析：</p>
<ul>
<li>借书业务由两个数据库操作完成，这两个操作要么同时成功，要么同时失败，构成一个数据库事务；</li>
<li>JDBC的DML操作默认是自定提交的，因此当第一个DML操作（添加借书记录）完成后，无论第二个操作（修改库存）是否成功，借书记录都会添加到数据库，而且是永久的</li>
<li>JDBC中该如何做事务管理呢？</li>
</ul>
<h2 id="10-2-JDBC事务管理"><a href="#10-2-JDBC事务管理" class="headerlink" title="10.2 JDBC事务管理"></a>10.2 JDBC事务管理</h2><blockquote>
<ol>
<li>一个事务中的多个DML操作需要基于同一个数据库连接；</li>
<li>创建连接之后，设置事务手动提交（关闭自动提交）；<code>connection.setAutoCommit(false);</code></li>
<li>当当前事务中的所有DML操作完成之后手动提交；<code>connection.commit();</code></li>
<li>当事务中的任何一个步骤出现异常，在catch代码块中执行事务回滚。<code>connection.rollback();</code></li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 借书：</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> stuNum 借书的学生学号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bookId 借书的图书编号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> num   借书的数量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">borrowBook</span><span class="params">(String stuNum,<span class="type">int</span> bookId,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="comment">//设置使用当前Connection连接操作数据库自动提交关闭</span></span><br><span class="line">            connection.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//1.向`records`表添加借书记录</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;insert into records(snum,bid,borrow_num,is_return,borrow_date) values(?,?,?,0,sysdate())&quot;</span>;</span><br><span class="line">            preparedStatement1 = connection.prepareStatement(sql1);</span><br><span class="line">            preparedStatement1.setString(<span class="number">1</span>,stuNum);</span><br><span class="line">            preparedStatement1.setInt(<span class="number">2</span>,bookId);</span><br><span class="line">            preparedStatement1.setInt(<span class="number">3</span>,num);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement1.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">10</span>/<span class="number">0</span>;  <span class="comment">//造异常：算术异常</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//2.修改`books`表中的库存</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;update books set book_stock=book_stock-? where book_id=?&quot;</span>;</span><br><span class="line">            preparedStatement2 = connection.prepareStatement(sql2);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">1</span>,num);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">2</span>,bookId);</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> preparedStatement2.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 提交事务</span></span><br><span class="line">            connection.commit();</span><br><span class="line">            flag = i&gt;<span class="number">0</span> &amp;&amp; j&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//一旦事务执行过程中出现异常，执行回滚</span></span><br><span class="line">                connection.rollback();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement1,<span class="literal">null</span>);</span><br><span class="line">            DBHelper.close(preparedStatement2,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="10-3-Service层的事务管理"><a href="#10-3-Service层的事务管理" class="headerlink" title="10.3 Service层的事务管理"></a>10.3 Service层的事务管理</h2><blockquote>
<p>DAO只负责数据库的操作，业务由service层进行管理</p>
</blockquote>
<h3 id="10-3-1-Service分层介绍"><a href="#10-3-1-Service分层介绍" class="headerlink" title="10.3.1 Service分层介绍"></a>10.3.1 Service分层介绍</h3><blockquote>
<ul>
<li>DAO负责特定的数据库操作</li>
<li>Servcie进行业务处理，Service业务处理过程如果需要数据库操作，则调用DAO完成</li>
</ul>
</blockquote>
<h3 id="10-3-2-Service分层实现"><a href="#10-3-2-Service分层实现" class="headerlink" title="10.3.2 Service分层实现"></a>10.3.2 Service分层实现</h3><ul>
<li>创建<code>RecordDAO</code>，完成<code>insertRecord</code>方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecordDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  添加借书记录</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> snum 借书的学生的学号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bid 借书的图书编号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> num 借书的数量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 添加借书记录成功返回true，失败返回false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insertRecord</span><span class="params">(String snum,<span class="type">int</span> bid,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//1.向`records`表添加借书记录</span></span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;insert into records(snum,bid,borrow_num,is_return,borrow_date) values(?,?,?,0,sysdate())&quot;</span>;</span><br><span class="line">            preparedStatement1 = connection.prepareStatement(sql1);</span><br><span class="line">            preparedStatement1.setString(<span class="number">1</span>,snum);</span><br><span class="line">            preparedStatement1.setInt(<span class="number">2</span>,bid);</span><br><span class="line">            preparedStatement1.setInt(<span class="number">3</span>,num);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement1.executeUpdate();</span><br><span class="line">            flag = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement1,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在<code>BookDAO</code>中定义<code>updateStock</code>修改库存方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.DBHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改库存</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bid 要修改库存的图书编号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> num  book_stock=book_stock-num</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateStock</span><span class="params">(<span class="type">int</span> bid,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//2.修改`books`表中的库存</span></span><br><span class="line">            connection = DBHelper.getConnectin();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;update books set book_stock=book_stock-? where book_id=?&quot;</span>;</span><br><span class="line">            preparedStatement2 = connection.prepareStatement(sql2);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">1</span>,num);</span><br><span class="line">            preparedStatement2.setInt(<span class="number">2</span>,bid);</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> preparedStatement2.executeUpdate();</span><br><span class="line">            flag = j&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DBHelper.close(preparedStatement2,connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>创建<code>BookService</code>完成借书业务</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dao.BookDAO;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dao.RecordDAO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">RecordDAO</span> <span class="variable">recordDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RecordDAO</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">BookDAO</span> <span class="variable">bookDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BookDAO</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 借书业务，包含两个步骤，这两个步骤要么同时成功，要么同时失败——事务</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">borrowBook</span><span class="params">(String stuNum,<span class="type">int</span> bookId,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="comment">//1.添加借书记录</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b1</span> <span class="operator">=</span> recordDAO.insertRecord(stuNum, bookId, num);</span><br><span class="line">        <span class="comment">//2.修改图书库存</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b2</span> <span class="operator">=</span> bookDAO.updateStock(bookId, num);</span><br><span class="line">        <span class="comment">// 结果处理</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">r</span> <span class="operator">=</span> b1 &amp;&amp; b2;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-3-3-Service层的事务管理"><a href="#10-3-3-Service层的事务管理" class="headerlink" title="10.3.3 Service层的事务管理"></a>10.3.3 Service层的事务管理</h3><blockquote>
<p>Servcie层事务中多个数据库的DML操作是相互独立的，如何保证所有DML要么同时成功，要么同时失败呢？</p>
<p>事务管理要满足以下条件：</p>
<ul>
<li>多个DML操作需使用同一个数据库连接</li>
<li>第一个DML操作之前设置事务手动提交</li>
<li>所有DML操作执行完成之后提交事务</li>
<li>出现异常则进行事务回滚</li>
</ul>
</blockquote>
<p><strong>如何让Service事务中的多个DML使用同一个数据库连接？</strong></p>
<ul>
<li><p><code>在Service获取连接对象，将连接对象传递到DAO中</code></p>
<p>分析：DAO类中的Connection对象需要通过Service传递给进来，这种对象传递本来也无可厚非，但是当我们通过面向接口开发时（面向接口，是为了能够灵活的定义实现类），容易造成接口的冗余（接口污染）</p>
</li>
<li><p><code>使用ThreadLocal容器，实现多个DML操作使用相同的连接</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211020125509949.png" alt="image-20211020125509949"></p>
<blockquote>
<p>存储Connection的容器可以使用List集合</p>
<ul>
<li>使用List集合做容器，在多线程并发编程中会出现资源竞争问题——多个并发的线程使用的是同一个数据库连接对象（我们的要求是同一个事务中使用同一个连接，而并非多个线程共享连接）</li>
<li>为了解决并发编程的连接对象共享问题，我们可以使用ThreadLocal作为数据库连接对象的容器</li>
</ul>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211020130039260.png" alt="image-20211020130039260"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211020141735005.png" alt="image-20211020141735005"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DBHelper</span> &#123;</span><br><span class="line">    <span class="comment">//1.定义数据库连接信息</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DRIVER</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">URL</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USERNAME</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;@QFedu123&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1️⃣定义ThreadLocal容器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;Connection&gt; local = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.静态初始化块注册驱动</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(DRIVER);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.创建数据库连接</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnectin</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 2️⃣从ThreadLocal容器中获取连接</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> local.get();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(connection == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="comment">//3️⃣如果容器中没有连接，则创建连接，并将创建的连接存放到容器</span></span><br><span class="line">                connection = DriverManager.getConnection(URL,USERNAME,PASSWORD);</span><br><span class="line">                local.set(connection);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4. 4️⃣关闭连接</span></span><br><span class="line">    <span class="comment">// 如果使用ThreadLocal存储数据库连接，关闭连接时同时要将Connection对象从ThreadLocal中移除</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 获取到当前线程使用的数据库连接对象</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> local.get();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(connection !=<span class="literal">null</span> &amp;&amp; !connection.isClosed())&#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 将关闭后的连接对象从ThreadLocal中移除</span></span><br><span class="line">            local.remove();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeStatement</span><span class="params">(Statement statement)</span>&#123;</span><br><span class="line">        closeStatement(<span class="literal">null</span>,statement);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeStatement</span><span class="params">(ResultSet resultSet, Statement statement)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(resultSet!=<span class="literal">null</span> &amp;&amp; !resultSet.isClosed())&#123;</span><br><span class="line">                resultSet.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(statement!=<span class="literal">null</span> &amp;&amp; !statement.isClosed())&#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="十一、数据库连接池"><a href="#十一、数据库连接池" class="headerlink" title="十一、数据库连接池"></a>十一、数据库连接池</h1><h2 id="11-1-什么是数据库连接池？"><a href="#11-1-什么是数据库连接池？" class="headerlink" title="11.1 什么是数据库连接池？"></a>11.1 什么是数据库连接池？</h2><blockquote>
<p>如果每个JDBC操作需要数据库连接都重新创建，使用完成之后都销毁，我们的JVM会因为频繁的创建、销毁连接而占用额外的系统资源。</p>
<p>数据库连接本质上是可被重用的资源（当一个JDBC操作完成之后，其创建的连接是可以被其他JDBC操作使用的），基于这个特性：</p>
<ul>
<li>我们可以创建一个<code>存放数据库连接的容器</code>（连接池），连接池是有最大容量的</li>
<li>当我们要进行JDBC操作时，直接从这个容器中获取连接<ul>
<li>如果容器中没有空闲的连接且连接池中连接的个数没有达到最大值，则创建新的数据库连接存入连接池并给这个操作使用，使用完成之后无需关闭连接直接归还这个容器中即可；</li>
<li>如果容器中没有空闲的连接且连接池中连接的个数达到最大值，当前操作就会进行等待，等待连接池中的某个连接被归还，归还之后再使用；</li>
<li>如果容器中有空闲连接，则无需创建新的连接，直接从容器中获取这个空闲连接进行使用；</li>
</ul>
</li>
</ul>
</blockquote>
<p>连接池：存放数据库连接对象的容器</p>
<p>连接池作用：对数据库连接进行管理，减少因重复创建、销毁连接导致的系统开销</p>
<h2 id="11-2-常用连接池"><a href="#11-2-常用连接池" class="headerlink" title="11.2 常用连接池"></a>11.2 常用连接池</h2><blockquote>
<p>我们可以编程实现：创建一个数组、集合来存放数据库连接；</p>
<p>目前市面上已经有多种实现的数据库连接池了，我们无需再手动实现，只需引用对应的数据库连接池产品，即可在我们自己的Java应用中使用连接池（站在巨人的肩上）</p>
</blockquote>
<table>
<thead>
<tr>
<th>功能</th>
<th>dbcp</th>
<th>druid</th>
<th>c3p0</th>
<th>HikariCP</th>
</tr>
</thead>
<tbody><tr>
<td>是否支持PSCache</td>
<td>是</td>
<td>是</td>
<td>是</td>
<td>否</td>
</tr>
<tr>
<td>监控</td>
<td>jmx</td>
<td>jmx&#x2F;log&#x2F;http</td>
<td>jmx,log</td>
<td>jmx</td>
</tr>
<tr>
<td>扩展性</td>
<td>弱</td>
<td>好</td>
<td>弱</td>
<td>弱</td>
</tr>
<tr>
<td>sql拦截及解析</td>
<td>无</td>
<td>支持</td>
<td>无</td>
<td>无</td>
</tr>
<tr>
<td>代码</td>
<td>简单</td>
<td>中等</td>
<td>复杂</td>
<td>简单</td>
</tr>
<tr>
<td>特点</td>
<td>依赖于common-pool</td>
<td>阿里开源，功能全面</td>
<td>历史久远，代码逻辑复杂，且不易维护</td>
<td>优化力度大，功能简单，起源于boneCP</td>
</tr>
<tr>
<td>连接池管理</td>
<td>LinkedBlockingDeque</td>
<td>数组</td>
<td></td>
<td>ThreadLocal<br>CopyOnWriteArrayList</td>
</tr>
</tbody></table>
<ul>
<li>基于连接池的性能、使用的便捷性、连接监控等多方面综合情况，druid是目前企业应用中使用最广泛的</li>
<li>Hikari在SpringBoot中默认集成，性能是诸多竞品中最好的</li>
</ul>
<h2 id="11-3-使用Druid连接池"><a href="#11-3-使用Druid连接池" class="headerlink" title="11.3 使用Druid连接池"></a>11.3 使用Druid连接池</h2><h3 id="11-3-1-创建Java应用"><a href="#11-3-1-创建Java应用" class="headerlink" title="11.3.1 创建Java应用"></a>11.3.1 创建Java应用</h3><ul>
<li>创建Java工程</li>
<li>添加驱动jar文件</li>
</ul>
<h3 id="11-3-2-创建连接池属性配置"><a href="#11-3-2-创建连接池属性配置" class="headerlink" title="11.3.2 创建连接池属性配置"></a>11.3.2 创建连接池属性配置</h3><ul>
<li><p>在src中创建package：<code>com.qfedu.jdbc.utils</code></p>
</li>
<li><p>在<code>com.qfedu.jdbc.utils</code>中创建<code>druid.properties</code>文件</p>
</li>
<li><p>配置druid连接池的实行</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 数据库连接信息</span><br><span class="line">driverClassName=com.mysql.cj.jdbc.Driver</span><br><span class="line">url=jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8</span><br><span class="line">username=root</span><br><span class="line">password=@QFedu123</span><br><span class="line"></span><br><span class="line"># 连接池属性</span><br><span class="line"># 连接池的初始化连接数&lt;创建数据库连接池时默认初始化的连接的个数&gt;</span><br><span class="line">initialSize=10</span><br><span class="line"># 连接池的最大连接数</span><br><span class="line">maxActive=50</span><br><span class="line"># 最小空闲连接数（当数据库连接使用率很低时，连接池中的连接会被释放一部分）</span><br><span class="line">minIdle=5</span><br><span class="line"># 超时等待时间(单位：ms)</span><br><span class="line">maxWait=30000</span><br></pre></td></tr></table></figure>



<h3 id="11-3-3-创建连接池工具类"><a href="#11-3-3-创建连接池工具类" class="headerlink" title="11.3.3 创建连接池工具类"></a>11.3.3 创建连接池工具类</h3><ul>
<li><p>下载并导入druid的jar文件<code>druid-1.2.8.jar</code></p>
</li>
<li><p>在<code>com.qfedu.jdbc.utils</code>创建<code>DruidUtils</code>工具类（工具类与属性文件<code>druid.properties</code>在同目录下）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DruidUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.定义DruidDataSource对象：表示Druid数据库连接池（数据源）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DruidDataSource druidDataSource;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.静态代码块初始化定义DruidDataSource对象</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//读取druid.properties文件中配置的属性</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> DruidUtils.class.getResourceAsStream(<span class="string">&quot;druid.properties&quot;</span>);</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(is);</span><br><span class="line">            <span class="comment">//使用属性文件初始化DruidDataSource对象</span></span><br><span class="line">            druidDataSource = </span><br><span class="line">                (DruidDataSource) DruidDataSourceFactory.createDataSource(properties);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.创建静态方法，从连接池对象中获取连接</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection =  druidDataSource.getConnection();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="十二、通用JDBC操作封装"><a href="#十二、通用JDBC操作封装" class="headerlink" title="十二、通用JDBC操作封装"></a>十二、通用JDBC操作封装</h1><blockquote>
<p>在DAO层的JDBC操作中，对数据的表增、删、改、查操作存在代码的冗余，我们可以对其公共部分进行封装，实现代码的复用。</p>
</blockquote>
<h2 id="12-1-DML操作封装"><a href="#12-1-DML操作封装" class="headerlink" title="12.1 DML操作封装"></a>12.1 DML操作封装</h2><blockquote>
<p>对于数据库的DML操作：</p>
<ul>
<li>参数不同</li>
<li>SQL通过</li>
<li>SQL参数复制不同</li>
</ul>
</blockquote>
<ul>
<li>通用的DML操作方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 公共DML操作</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql 执行的SQL指令</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * sql : delete from students where stu_num=?</span></span><br><span class="line"><span class="comment">     * args: snum</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * sql : insert into students(stu_num,stu_name,stu_gender,stu_age) values(?,?,?,?)</span></span><br><span class="line"><span class="comment">     * args: 1009  Lucy  女   18</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">update</span><span class="params">(String sql, Object... args)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DruidUtils.getConnection();</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length ; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            b = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="12-2-DQL操作封装"><a href="#12-2-DQL操作封装" class="headerlink" title="12.2 DQL操作封装"></a>12.2 DQL操作封装</h2><table>
<thead>
<tr>
<th>使用泛型设置通用查询方法的返回类型</th>
</tr>
</thead>
<tbody><tr>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/JDBC/image-20211020201919666.png" alt="image-20211020201919666"></td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">RowMapper</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getRow</span><span class="params">(ResultSet resultSet)</span> <span class="keyword">throws</span> SQLException;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonDAO</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 公共DML操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">update</span><span class="params">(String sql, Object... args)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DruidUtils.getConnection();</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length ; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            b = i&gt;<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;T&gt; <span class="title function_">select</span><span class="params">(String sql, RowMapper&lt;T&gt; rowMapper,Object...args)</span>&#123;</span><br><span class="line">        List&lt;T&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DruidUtils.getConnection();</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;args.length ; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line">            <span class="keyword">while</span>(resultSet.next())&#123;</span><br><span class="line">                <span class="comment">// 从查询结果中取出一条记录（多个值），封装到一个实体类对象中</span></span><br><span class="line">                <span class="comment">//  getRow就是方法调用者在调用方法时，传递进来的用于映射查询结果的方法</span></span><br><span class="line">               <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span>  rowMapper.getRow(resultSet);</span><br><span class="line">               list.add(t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="12-3-基于通用JDBC操作的案例"><a href="#12-3-基于通用JDBC操作的案例" class="headerlink" title="12.3 基于通用JDBC操作的案例"></a>12.3 基于通用JDBC操作的案例</h2><blockquote>
<p>图书信息进行JDBC操作</p>
<ul>
<li>创建图书实体类Book</li>
<li>创建BookDAO</li>
</ul>
</blockquote>
<h3 id="12-3-1-创建实体类"><a href="#12-3-1-创建实体类" class="headerlink" title="12.3.1 创建实体类"></a>12.3.1 创建实体类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookId;</span><br><span class="line">    <span class="keyword">private</span> String bookName;</span><br><span class="line">    <span class="keyword">private</span> String bookAuthor;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> bookPrice;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookStock;</span><br><span class="line">    <span class="keyword">private</span> String bookDesc;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//无参构造器</span></span><br><span class="line">    <span class="comment">//全参构造器</span></span><br><span class="line">    <span class="comment">//toString</span></span><br><span class="line">    <span class="comment">//get和set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-3-2-创建DAO类"><a href="#12-3-2-创建DAO类" class="headerlink" title="12.3.2 创建DAO类"></a>12.3.2 创建DAO类</h3><blockquote>
<p>DAO中的操作都是调用CommonDAO实现的</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.dto.Book;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.CommonDAO;</span><br><span class="line"><span class="keyword">import</span> com.qfedu.jdbc.utils.RowMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDAO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> CommonDAO&lt;Book&gt; commonDAO = <span class="keyword">new</span> <span class="title class_">CommonDAO</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  <span class="type">boolean</span> <span class="title function_">insertBook</span><span class="params">(Book book)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> commonDAO.update(sql, book.getBookName(), book.getBookAuthor(), book.getBookPrice(), book.getBookStock(), book.getBookDesc());</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteBook</span><span class="params">(<span class="type">int</span> bookId)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> commonDAO.update(sql, bookId);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateBook</span><span class="params">(Book book)</span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> commonDAO.update(sql, book.getBookName(), book.getBookAuthor(), book.getBookPrice(), book.getBookStock(), book.getBookDesc(), book.getBookId());</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">queryBook</span><span class="params">(<span class="type">int</span> bookId)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;</span>;</span><br><span class="line">        RowMapper&lt;Book&gt; bookRowMapper = <span class="keyword">new</span> <span class="title class_">RowMapper</span>&lt;Book&gt;()&#123;</span><br><span class="line">            <span class="keyword">public</span> Book <span class="title function_">getRow</span><span class="params">(ResultSet resultSet)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">bid</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Book</span>(bid,bookName,bookAuthor,bookPrice,bookStock,bookDesc);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        List&lt;Book&gt; list = commonDAO.select(sql, bookRowMapper, bookId);</span><br><span class="line">        <span class="keyword">return</span> list.size()&gt;<span class="number">0</span>?list.get(<span class="number">0</span>):<span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listBooks</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books&quot;</span>;</span><br><span class="line">        List&lt;Book&gt; list = commonDAO.select(sql, resultSet -&gt; &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">bid</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">            <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Book</span>(bid, bookName, bookAuthor, bookPrice, bookStock, bookDesc);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="十三、Apache-DBUtils"><a href="#十三、Apache-DBUtils" class="headerlink" title="十三、Apache DBUtils"></a>十三、Apache DBUtils</h1><h2 id="13-1-DBUtils介绍"><a href="#13-1-DBUtils介绍" class="headerlink" title="13.1 DBUtils介绍"></a>13.1 DBUtils介绍</h2><blockquote>
<p>Commons DBUtils是Apache组织提供的一个针对JDBC进行简单封装的开源工具类库，使用DBUtils可以极大简化JDBC应用程序开发，同时不会影响数据库访问的性能。</p>
</blockquote>
<blockquote>
<p>DBUtils是Java编程中数据库访问的轻巧、使用的工具类库</p>
<ul>
<li>提供对数据表通用的DML操作</li>
<li>提供对数据表通用的DQL操作（可以把结果封装成对象、集合等类型）</li>
</ul>
</blockquote>
<blockquote>
<p>DBUtils工具类库中的核心类：</p>
<ul>
<li><p><strong>QueryRunner</strong>，用于执行SQL指令（相当于我们自己封装的CommonDAO类）</p>
<ul>
<li>update() , 用于执行DML指令</li>
<li>query(), 用于执行DQL指令</li>
</ul>
</li>
<li><p><strong>ResultSetHandler</strong>接口，结果集处理器，用于处理查询结果（相当于我们自己的封装的RowMapper接口）</p>
<ul>
<li>BeanHandler实现类：当查询语句返回一条结果时，使用BeanHandler将结果转换成一个对象</li>
<li>BeanListHandler实现类：当查询语句返回多个结果时，使用BeanListHandler将结果转换成一个集合</li>
<li>ScalarHandler实现类：当查询结果返回一个值时，使用ScalarHandler将这个值转换成Java变量类型</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="13-2-DBUtils的使用准备"><a href="#13-2-DBUtils的使用准备" class="headerlink" title="13.2 DBUtils的使用准备"></a>13.2 DBUtils的使用准备</h2><ol>
<li><p>新建Java工程</p>
</li>
<li><p>添加依赖：</p>
<ul>
<li><code>mysql-connector-java-8.0.26.jar</code></li>
<li><code>druid-1.2.8.jar</code>Apache DBUtils建立数据库连接是依赖连接池数据源的，因此我们需要使用连接池</li>
<li><code>commons-dbutils-1.7.jar</code></li>
</ul>
</li>
<li><p>配置druid的属性文件</p>
<p>创建<code>com.qfedu.jdbc.utils</code>包</p>
<p>在包中创建<code>druid.properties</code>文件，配置如下</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据库连接信息</span></span><br><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/db_test3?characterEncoding=utf8</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">@QFedu123</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 连接池属性</span></span><br><span class="line"><span class="comment"># 连接池的初始化连接数&lt;创建数据库连接池时默认初始化的连接的个数&gt;</span></span><br><span class="line"><span class="attr">initialSize</span>=<span class="string">10</span></span><br><span class="line"><span class="comment"># 连接池的最大连接数</span></span><br><span class="line"><span class="attr">maxActive</span>=<span class="string">50</span></span><br><span class="line"><span class="comment"># 最小空闲连接数（当数据库连接使用率很低时，连接池中的连接会被释放一部分）</span></span><br><span class="line"><span class="attr">minIdle</span>=<span class="string">5</span></span><br><span class="line"><span class="comment"># 超时等待时间(单位：ms)</span></span><br><span class="line"><span class="attr">maxWait</span>=<span class="string">30000</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建Druid连接池工具类</p>
<p>在<code>com.qfedu.jdbc.utils</code>包创建<code>DruidUtils</code>工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qfedu.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DruidUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DruidDataSource druidDataSource;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> DruidUtils.class.getResourceAsStream(<span class="string">&quot;druid.properties&quot;</span>);</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(is);</span><br><span class="line">            druidDataSource = (DruidDataSource) DruidDataSourceFactory.createDataSource(properties);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取数据库连接池数据源对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> DataSource <span class="title function_">getDataSource</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> druidDataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = druidDataSource.getConnection();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="13-3-DBUtils使用"><a href="#13-3-DBUtils使用" class="headerlink" title="13.3 DBUtils使用"></a>13.3 DBUtils使用</h2><blockquote>
<p>完成图书信息的数据库操作</p>
</blockquote>
<ul>
<li>创建实体类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookId;</span><br><span class="line">    <span class="keyword">private</span> String bookName;</span><br><span class="line">    <span class="keyword">private</span> String bookAuthor;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> bookPrice;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> bookStock;</span><br><span class="line">    <span class="keyword">private</span> String bookDesc;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-3-1-添加操作"><a href="#13-3-1-添加操作" class="headerlink" title="13.3.1 添加操作"></a>13.3.1 添加操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertBook</span><span class="params">(Book book)</span>&#123;</span><br><span class="line">    <span class="type">int</span> i= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//1.编写SQL</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(book_name,book_author,book_price,book_stock,book_desc) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="comment">//2.准备参数</span></span><br><span class="line">        Object[] params = &#123;book.getBookName(),book.getBookAuthor(),book.getBookPrice(),book.getBookStock(),book.getBookDesc()&#125;;</span><br><span class="line">        <span class="comment">//3.调用commons-dbutils中的QueryRunner执行SQL</span></span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        i = queryRunner.update(sql, params);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-3-2-删除操作"><a href="#13-3-2-删除操作" class="headerlink" title="13.3.2 删除操作"></a>13.3.2 删除操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteBook</span><span class="params">(<span class="type">int</span> bookId)</span>&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        i = queryRunner.update(sql,bookId);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-3-3-修改操作"><a href="#13-3-3-修改操作" class="headerlink" title="13.3.3 修改操作"></a>13.3.3 修改操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updateBook</span><span class="params">(Book book)</span>&#123;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set book_name=?,book_author=?,book_price=?,book_stock=?,book_desc=? where book_id=?&quot;</span>;</span><br><span class="line">        Object[] params = &#123;book.getBookName(),book.getBookAuthor(),book.getBookPrice(),book.getBookStock(),book.getBookDesc(),book.getBookId()&#125;;</span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        i = queryRunner.update(sql, params);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-3-4-查询操作"><a href="#13-3-4-查询操作" class="headerlink" title="13.3.4 查询操作"></a>13.3.4 查询操作</h3><p><strong>查询一条记录</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Book <span class="title function_">queryBook</span><span class="params">(<span class="type">int</span> bookId)</span>&#123;</span><br><span class="line">    <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id bookId,book_name bookName,book_author bookAuthor,book_price bookPrice,book_stock bookStock,book_desc bookDesc from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        <span class="comment">//1.对于查询操作，我们需要通过QueryRunner对象调用query方法来执行</span></span><br><span class="line">        <span class="comment">//2.所有的query方法都需要一个ResultSetHandler的参数，通过此参数指定query方法的返回类型</span></span><br><span class="line">        <span class="comment">//  如果SQL指令执行之后返回的是一行记录，我们通过BeanHandler指定查询结果封装的实体类类型</span></span><br><span class="line">        <span class="comment">//  要求：查询结果集的字段名必须与指定的实体类的属性名匹配</span></span><br><span class="line">        <span class="comment">//     方案1：创建实体类的时候，实体类中属性的名字与数据表中的列名相同</span></span><br><span class="line">        <span class="comment">//     方案2：查询语句字段取别名，让字段别名与实体类属性名一致</span></span><br><span class="line">        book = queryRunner.query(sql, <span class="keyword">new</span> <span class="title class_">BeanHandler</span>&lt;Book&gt;(Book.class), bookId);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> book;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>自定义结果集处理</strong> 自定义ResultSetHandler</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Book <span class="title function_">queryBook2</span><span class="params">(<span class="type">int</span> bookId)</span>&#123;</span><br><span class="line">    <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select book_id,book_name,book_author,book_price,book_stock,book_desc from books where book_id=?&quot;</span>;</span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        <span class="comment">//1.对于查询操作，我们需要通过QueryRunner对象调用query方法来执行</span></span><br><span class="line">        <span class="comment">//2.所有的query方法都需要一个ResultSetHandler的参数，通过此参数指定query方法的返回类型</span></span><br><span class="line">        <span class="comment">//  如果SQL指令执行之后返回的是一行记录，我们通过BeanHandler指定查询结果封装的实体类类型</span></span><br><span class="line">        <span class="comment">//  要求：查询结果集的字段名必须与指定的实体类的属性名匹配</span></span><br><span class="line">        <span class="comment">//     方案3：自定义ResultSetHandler结果处理</span></span><br><span class="line">        ResultSetHandler&lt;Book&gt; resultSetHandler = <span class="keyword">new</span> <span class="title class_">ResultSetHandler</span>&lt;Book&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Book <span class="title function_">handle</span><span class="params">(ResultSet resultSet)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">                <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">if</span>(resultSet.next()) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_id&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">bookName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_name&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">bookAuthor</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_author&quot;</span>);</span><br><span class="line">                    <span class="type">double</span> <span class="variable">bookPrice</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;book_price&quot;</span>);</span><br><span class="line">                    <span class="type">int</span> <span class="variable">bookStock</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;book_stock&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">bookDesc</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;book_desc&quot;</span>);</span><br><span class="line">                    book = <span class="keyword">new</span> <span class="title class_">Book</span>(id,bookName,bookAuthor,bookPrice,bookStock,bookDesc);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> book;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        book = queryRunner.query(sql, resultSetHandler, bookId);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> book;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>查询多条记录</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">listBooks</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;Book&gt; bookList = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select  book_id bookId,book_name bookName,book_author bookAuthor,book_price bookPrice,book_stock bookStock,book_desc bookDesc  from books&quot;</span>;</span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">        <span class="comment">//如果SQL指令执行之后返回的是多行记录，我们通过BeanListHandler指定查询结果封装的实体类的集合类型</span></span><br><span class="line">        bookList = queryRunner.query(sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;Book&gt;(Book.class));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> bookList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>查询一个值</strong></p>
<blockquote>
<p>例如在做分页的时候，我们需要查询数据的总记录数</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getCount</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select count(1) from books&quot;</span>;</span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DruidUtils.getDataSource());</span><br><span class="line">    <span class="comment">// 如果SQL指令执行之后返回的是一个值时，我们通过ScalarHandler指定返回类型</span></span><br><span class="line">    <span class="comment">// QueryRunner在处理统计操作时，是以long类型进行操作的，因此不能直接转成Integer</span></span><br><span class="line">    <span class="comment">// 如果我们确定这个值在int范围内，我们可以在得到long类型之后进行强转，建议使用long处理</span></span><br><span class="line">    ScalarHandler&lt;Long&gt; scalarHandler = <span class="keyword">new</span> <span class="title class_">ScalarHandler</span>&lt;Long&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        count = queryRunner.query(sql, scalarHandler);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/1c708cfe708256c27d45527ab213aa00.jpeg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/1c708cfe708256c27d45527ab213aa00.jpeg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Mr.Chen</div><div class="post-copyright__author_desc">探索科技,启迪人生</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://chenhaonan.dpdns.org/posts/5c27/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://chenhaonan.dpdns.org/posts/5c27/')">JDBC</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://i.mji.rip/2025/11/25/4ace5945b5c9ad95d20b0e358431eec6.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/4ace5945b5c9ad95d20b0e358431eec6.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://i.mji.rip/2025/11/25/2f9f7712d93dfbf45033d2b86243fbb3.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/2f9f7712d93dfbf45033d2b86243fbb3.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://chenhaonan.dpdns.org/posts/5c27/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=JDBC&amp;url=https://chenhaonan.dpdns.org/posts/5c27/&amp;pic=/../images/JDBC/cover.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://chenhaonan.dpdns.org" target="_blank">Johnny的空间站</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%90%8E%E7%AB%AF/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>后端<span class="tagsPageCount">12</span></a><a class="post-meta__box__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>数据库<span class="tagsPageCount">3</span></a><a class="post-meta__box__tags" href="/tags/Java/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Java<span class="tagsPageCount">3</span></a><a class="post-meta__box__tags" href="/tags/JDBC/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>JDBC<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/../images/SpringBoot%E6%95%B4%E5%90%88Redis/cover.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/b9a6/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/MySQL%E6%95%99%E7%A8%8B/cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MySQL教程</div></div></a></div><div class="next-post pull-right"><a href="/posts/7cd4/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/MyBatis%E6%95%99%E7%A8%8B/cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MyBatis教程</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/posts/35f5/" title="SpringBoot整合Redis"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/SpringBoot%E6%95%B4%E5%90%88Redis/cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-11-24</div><div class="title">SpringBoot整合Redis</div></div></a></div><div><a href="/posts/7cd4/" title="MyBatis教程"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/MyBatis%E6%95%99%E7%A8%8B/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-10-14</div><div class="title">MyBatis教程</div></div></a></div><div><a href="/posts/f21b/" title="CentOS7文件管理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/CentOS7%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-04-20</div><div class="title">CentOS7文件管理</div></div></a></div><div><a href="/posts/30db/" title="CentOS7配置静态IP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/CentOS7%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-04-20</div><div class="title">CentOS7配置静态IP</div></div></a></div><div><a href="/posts/422e/" title="CentOS7模板机搭建"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/CentOS7%E6%A8%A1%E6%9D%BF%E6%9C%BA%E6%90%AD%E5%BB%BA/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-04-19</div><div class="title">CentOS7模板机搭建</div></div></a></div><div><a href="/posts/1f7a/" title="Docker2Compose"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Docker2Compose/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-11-23</div><div class="title">Docker2Compose</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/1c708cfe708256c27d45527ab213aa00.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/97d5391fd871391b19ce4a2da03f8a37.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">分享自己对技术的<b style="color:#fff">热爱</b>、对美好生活的<b style="color:#fff">向往</b>和对知识海洋的<b style="color:#fff">探索历程</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Mr.Chen</h1><div class="author-info__desc">探索科技,启迪人生</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/CodeChenHao" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/328095151" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81JDBC%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">一、JDBC介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81JDBC%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.</span> <span class="toc-text">二、JDBC步骤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81JDBC%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">3.</span> <span class="toc-text">三、JDBC入门案例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E5%8A%A0%E8%BD%BD%E9%A9%B1%E5%8A%A8"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 加载驱动</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-%E4%B8%8B%E8%BD%BD%E9%A9%B1%E5%8A%A8jar%E5%8C%85"><span class="toc-number">3.1.1.</span> <span class="toc-text">3.1.1 下载驱动jar包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-%E5%B0%86%E9%A9%B1%E5%8A%A8jar%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E5%88%B0Java%E5%BA%94%E7%94%A8"><span class="toc-number">3.1.2.</span> <span class="toc-text">3.1.2 将驱动jar文件添加到Java应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-3-%E6%B3%A8%E5%86%8C%E9%A9%B1%E5%8A%A8"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.1.3 注册驱动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E5%88%9B%E5%BB%BA%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 创建连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E7%BC%96%E5%86%99SQL%E6%8C%87%E4%BB%A4"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 编写SQL指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E5%8A%A0%E8%BD%BDSQL%E6%8C%87%E4%BB%A4"><span class="toc-number">3.4.</span> <span class="toc-text">3.4 加载SQL指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-%E6%89%A7%E8%A1%8CSQL%E3%80%81%E8%8E%B7%E5%8F%96%E7%BB%93%E6%9E%9C"><span class="toc-number">3.5.</span> <span class="toc-text">3.5 执行SQL、获取结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6-%E5%A4%84%E7%90%86%E7%BB%93%E6%9E%9C"><span class="toc-number">3.6.</span> <span class="toc-text">3.6 处理结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-7-%E5%85%B3%E9%97%AD%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.7.</span> <span class="toc-text">3.7 关闭连接</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81JDBC%E5%A2%9E%E5%88%A0%E6%9F%A5%E6%94%B9%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B"><span class="toc-number">4.</span> <span class="toc-text">四、JDBC增删查改操作实例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-insert%E6%93%8D%E4%BD%9C"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 insert操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-delete%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 delete操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-update%E6%93%8D%E4%BD%9C"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 update操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-select%E6%93%8D%E4%BD%9C%EF%BC%88%E4%B8%80%E6%9D%A1%E7%BB%93%E6%9E%9C%EF%BC%89"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 select操作（一条结果）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-select%E6%93%8D%E4%BD%9C%EF%BC%88%E5%A4%9A%E6%9D%A1%E7%BB%93%E6%9E%9C%EF%BC%89"><span class="toc-number">4.5.</span> <span class="toc-text">4.5 select操作（多条结果）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81JDBC%E7%9A%84%E6%A0%B8%E5%BF%83%E7%B1%BB%E4%B8%8E%E6%8E%A5%E5%8F%A3"><span class="toc-number">5.</span> <span class="toc-text">五、JDBC的核心类与接口</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-DriverManager%E7%B1%BB"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 DriverManager类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-Connection%E6%8E%A5%E5%8F%A3"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 Connection接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-1-%E8%8E%B7%E5%8F%96Statement%E5%AF%B9%E8%B1%A1"><span class="toc-number">5.2.1.</span> <span class="toc-text">5.2.1 获取Statement对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-2-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">5.2.2.</span> <span class="toc-text">5.2.2 事务管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-Statement%E6%8E%A5%E5%8F%A3"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 Statement接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-ResultSet%E6%8E%A5%E5%8F%A3"><span class="toc-number">5.4.</span> <span class="toc-text">5.4 ResultSet接口</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81SQL%E6%B3%A8%E5%85%A5%E9%97%AE%E9%A2%98"><span class="toc-number">6.</span> <span class="toc-text">六、SQL注入问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E4%BB%80%E4%B9%88%E6%98%AFSQL%E6%B3%A8%E5%85%A5%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 什么是SQL注入问题？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3SQL%E6%B3%A8%E5%85%A5%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 如何解决SQL注入问题？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E4%BD%BF%E7%94%A8PreparedStatement%E9%A2%84%E7%BC%96%E8%AF%91%E6%A1%88%E4%BE%8B"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 使用PreparedStatement预编译案例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%B0%81%E8%A3%85"><span class="toc-number">7.</span> <span class="toc-text">七、工具类封装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E4%BB%A3%E7%A0%81%E7%9A%84%E5%A4%8D%E7%94%A8%E6%80%A7"><span class="toc-number">7.1.</span> <span class="toc-text">7.1 代码的复用性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%B0%81%E8%A3%85"><span class="toc-number">7.2.</span> <span class="toc-text">7.2 工具类封装</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81DAO%E4%B8%8EDTO%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-number">8.</span> <span class="toc-text">八、DAO与DTO的封装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-CRUD%E6%96%B9%E6%B3%95%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-number">8.1.</span> <span class="toc-text">8.1 CRUD方法的封装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-DTO%E5%AE%9E%E4%BD%93%E7%B1%BB%E5%B0%81%E8%A3%85"><span class="toc-number">8.2.</span> <span class="toc-text">8.2 DTO实体类封装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-%E5%AE%9E%E4%BD%93%E7%B1%BB%E5%B0%81%E8%A3%85%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C"><span class="toc-number">8.3.</span> <span class="toc-text">8.3 实体类封装查询结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-4-%E5%AE%9E%E4%BD%93%E7%B1%BB%E4%BC%A0%E9%80%92%E6%B7%BB%E5%8A%A0%E3%80%81%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C%E5%8F%82%E6%95%B0"><span class="toc-number">8.4.</span> <span class="toc-text">8.4 实体类传递添加、修改操作参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-1-%E6%B7%BB%E5%8A%A0%E6%93%8D%E4%BD%9C"><span class="toc-number">8.4.1.</span> <span class="toc-text">8.4.1 添加操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-2-%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C"><span class="toc-number">8.4.2.</span> <span class="toc-text">8.4.2 修改操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-5-DAO%E7%B1%BB%E5%B0%81%E8%A3%85"><span class="toc-number">8.5.</span> <span class="toc-text">8.5 DAO类封装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-6-DAO%E7%B1%BB%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96"><span class="toc-number">8.6.</span> <span class="toc-text">8.6 DAO类代码优化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%9D%E3%80%81JDBC%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B"><span class="toc-number">9.</span> <span class="toc-text">九、JDBC综合案例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-JDBC%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-number">9.1.</span> <span class="toc-text">9.1 JDBC数据库编程的流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-%E5%88%9B%E5%BB%BAJDBC%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-number">9.2.</span> <span class="toc-text">9.2 创建JDBC工具类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-%E5%88%9B%E5%BB%BADTO%E7%B1%BB"><span class="toc-number">9.3.</span> <span class="toc-text">9.3 创建DTO类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4-%E5%88%9B%E5%BB%BADAO%E7%B1%BB"><span class="toc-number">9.4.</span> <span class="toc-text">9.4 创建DAO类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5-%E6%B5%8B%E8%AF%95DAO%E7%B1%BB%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">9.5.</span> <span class="toc-text">9.5 测试DAO类中的方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-1-%E4%B8%8B%E8%BD%BD%E5%AF%BC%E5%85%A5junit%E4%BE%9D%E8%B5%96%E5%88%B0%E9%A1%B9%E7%9B%AE%E4%B8%AD"><span class="toc-number">9.5.1.</span> <span class="toc-text">9.5.1 下载导入junit依赖到项目中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-2-%E5%88%9B%E5%BB%BA%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%B1%BB"><span class="toc-number">9.5.2.</span> <span class="toc-text">9.5.2 创建单元测试类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E3%80%81JDBC%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">10.</span> <span class="toc-text">十、JDBC事务管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-JDBC%E5%AE%9E%E7%8E%B0%E5%80%9F%E4%B9%A6%E6%93%8D%E4%BD%9C"><span class="toc-number">10.1.</span> <span class="toc-text">10.1 JDBC实现借书操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-JDBC%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">10.2.</span> <span class="toc-text">10.2 JDBC事务管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3-Service%E5%B1%82%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">10.3.</span> <span class="toc-text">10.3 Service层的事务管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-1-Service%E5%88%86%E5%B1%82%E4%BB%8B%E7%BB%8D"><span class="toc-number">10.3.1.</span> <span class="toc-text">10.3.1 Service分层介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-2-Service%E5%88%86%E5%B1%82%E5%AE%9E%E7%8E%B0"><span class="toc-number">10.3.2.</span> <span class="toc-text">10.3.2 Service分层实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-3-Service%E5%B1%82%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">10.3.3.</span> <span class="toc-text">10.3.3 Service层的事务管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">11.</span> <span class="toc-text">十一、数据库连接池</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%EF%BC%9F"><span class="toc-number">11.1.</span> <span class="toc-text">11.1 什么是数据库连接池？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2-%E5%B8%B8%E7%94%A8%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">11.2.</span> <span class="toc-text">11.2 常用连接池</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-3-%E4%BD%BF%E7%94%A8Druid%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">11.3.</span> <span class="toc-text">11.3 使用Druid连接池</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-1-%E5%88%9B%E5%BB%BAJava%E5%BA%94%E7%94%A8"><span class="toc-number">11.3.1.</span> <span class="toc-text">11.3.1 创建Java应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-2-%E5%88%9B%E5%BB%BA%E8%BF%9E%E6%8E%A5%E6%B1%A0%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE"><span class="toc-number">11.3.2.</span> <span class="toc-text">11.3.2 创建连接池属性配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-3-%E5%88%9B%E5%BB%BA%E8%BF%9E%E6%8E%A5%E6%B1%A0%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-number">11.3.3.</span> <span class="toc-text">11.3.3 创建连接池工具类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E9%80%9A%E7%94%A8JDBC%E6%93%8D%E4%BD%9C%E5%B0%81%E8%A3%85"><span class="toc-number">12.</span> <span class="toc-text">十二、通用JDBC操作封装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#12-1-DML%E6%93%8D%E4%BD%9C%E5%B0%81%E8%A3%85"><span class="toc-number">12.1.</span> <span class="toc-text">12.1 DML操作封装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-2-DQL%E6%93%8D%E4%BD%9C%E5%B0%81%E8%A3%85"><span class="toc-number">12.2.</span> <span class="toc-text">12.2 DQL操作封装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-3-%E5%9F%BA%E4%BA%8E%E9%80%9A%E7%94%A8JDBC%E6%93%8D%E4%BD%9C%E7%9A%84%E6%A1%88%E4%BE%8B"><span class="toc-number">12.3.</span> <span class="toc-text">12.3 基于通用JDBC操作的案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-1-%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-number">12.3.1.</span> <span class="toc-text">12.3.1 创建实体类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-2-%E5%88%9B%E5%BB%BADAO%E7%B1%BB"><span class="toc-number">12.3.2.</span> <span class="toc-text">12.3.2 创建DAO类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81Apache-DBUtils"><span class="toc-number">13.</span> <span class="toc-text">十三、Apache DBUtils</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#13-1-DBUtils%E4%BB%8B%E7%BB%8D"><span class="toc-number">13.1.</span> <span class="toc-text">13.1 DBUtils介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-2-DBUtils%E7%9A%84%E4%BD%BF%E7%94%A8%E5%87%86%E5%A4%87"><span class="toc-number">13.2.</span> <span class="toc-text">13.2 DBUtils的使用准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-3-DBUtils%E4%BD%BF%E7%94%A8"><span class="toc-number">13.3.</span> <span class="toc-text">13.3 DBUtils使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-1-%E6%B7%BB%E5%8A%A0%E6%93%8D%E4%BD%9C"><span class="toc-number">13.3.1.</span> <span class="toc-text">13.3.1 添加操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-2-%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C"><span class="toc-number">13.3.2.</span> <span class="toc-text">13.3.2 删除操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-3-%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C"><span class="toc-number">13.3.3.</span> <span class="toc-text">13.3.3 修改操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-4-%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="toc-number">13.3.4.</span> <span class="toc-text">13.3.4 查询操作</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/35f5/" title="SpringBoot整合Redis"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/SpringBoot%E6%95%B4%E5%90%88Redis/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot整合Redis"/></a><div class="content"><a class="title" href="/posts/35f5/" title="SpringBoot整合Redis">SpringBoot整合Redis</a><time datetime="2025-11-23T16:00:00.000Z" title="发表于 2025-11-24 00:00:00">2025-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1f7a/" title="Docker2Compose"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Docker2Compose/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker2Compose"/></a><div class="content"><a class="title" href="/posts/1f7a/" title="Docker2Compose">Docker2Compose</a><time datetime="2025-11-22T16:00:00.000Z" title="发表于 2025-11-23 00:00:00">2025-11-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5d95/" title="Docker应用部署"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Docker%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker应用部署"/></a><div class="content"><a class="title" href="/posts/5d95/" title="Docker应用部署">Docker应用部署</a><time datetime="2025-11-10T16:00:00.000Z" title="发表于 2025-11-11 00:00:00">2025-11-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/6139/" title="Docker教程"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Docker%E6%95%99%E7%A8%8B/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker教程"/></a><div class="content"><a class="title" href="/posts/6139/" title="Docker教程">Docker教程</a><time datetime="2025-11-09T16:00:00.000Z" title="发表于 2025-11-10 00:00:00">2025-11-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/20db/" title="Linux常用脚本"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Linux%E5%B8%B8%E7%94%A8%E8%84%9A%E6%9C%AC/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux常用脚本"/></a><div class="content"><a class="title" href="/posts/20db/" title="Linux常用脚本">Linux常用脚本</a><time datetime="2025-10-04T16:00:00.000Z" title="发表于 2025-10-05 00:00:00">2025-10-05</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:1835824864@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/CodeChenHao" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/1c708cfe708256c27d45527ab213aa00.jpeg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/328095151" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://v.douyin.com/EI8nvl-cvx0/" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a><a class="deal_link" href="/copyright" title="CC"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i></a></div><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="Mr.Chen" target="_blank">Mr.Chen</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a><a class="footer-bar-link" target="_blank" rel="noopener" href="https://mjj.today/" title="图床">图床</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">3</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">代码托管</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/" title="GitHub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/9a3038ba0b7d4515df5c663d8a6a2469.png" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gitee.com/" title="Gitee"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/b6e0c3428fd3783d83d14960fbbb57a0.png" alt="Gitee"/><span class="back-menu-item-text">Gitee</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">工具</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://tool.lu/" title="在线工具"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/30/472ebcada7a3e883391c21028c7112eb.png" alt="在线工具"/><span class="back-menu-item-text">在线工具</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://2925.com/" title="2529邮箱"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/73a5a6b561d3f82301e726a911d9add3.png" alt="2529邮箱"/><span class="back-menu-item-text">2529邮箱</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.ip.cn/" title="IP地址查询"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/30/ac05acdf53e09f62c657b7cba766905a.png" alt="IP地址查询"/><span class="back-menu-item-text">IP地址查询</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://otp.landian.vip/zh-cn/" title="Office Tool Plus"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/30/8b1aad9e91d6b746141420287f98234d.png" alt="Office Tool Plus"/><span class="back-menu-item-text">Office Tool Plus</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.processon.com/" title="ProcessOn"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/30/a9cccc5064d769ef4590035207b6cb01.png" alt="ProcessOn"/><span class="back-menu-item-text">ProcessOn</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://mjj.today/" title="图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://i.mji.rip/2025/11/25/07fd4c34a272fa061f507cf5534d2dad.png" alt="图床"/><span class="back-menu-item-text">图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 文章列表</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 全部分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=7784481513&amp;server=tencent"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 留言板</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CentOS7/" style="font-size: 0.88rem;">CentOS7<sup>3</sup></a><a href="/tags/Docker/" style="font-size: 0.88rem;">Docker<sup>3</sup></a><a href="/tags/HTML/" style="font-size: 0.88rem;">HTML<sup>1</sup></a><a href="/tags/JDBC/" style="font-size: 0.88rem;">JDBC<sup>1</sup></a><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>3</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>5</sup></a><a href="/tags/MySQL/" style="font-size: 0.88rem;">MySQL<sup>1</sup></a><a href="/tags/Mybatis/" style="font-size: 0.88rem;">Mybatis<sup>1</sup></a><a href="/tags/RDBMS/" style="font-size: 0.88rem;">RDBMS<sup>1</sup></a><a href="/tags/Redis/" style="font-size: 0.88rem;">Redis<sup>1</sup></a><a href="/tags/Spring/" style="font-size: 0.88rem;">Spring<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 0.88rem;">SpringBoot<sup>1</sup></a><a href="/tags/Vmware/" style="font-size: 0.88rem;">Vmware<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 0.88rem;">前端<sup>1</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size: 0.88rem;">后端<sup>12</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 0.88rem;">工具<sup>3</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 0.88rem;">操作系统<sup>2</sup></a><a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 0.88rem;">教程<sup>7</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 0.88rem;">数据库<sup>3</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" style="font-size: 0.88rem;">虚拟化<sup>2</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA/" style="font-size: 0.88rem;">项目构建<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="7784481513" server="tencent" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"><a class="tag-list" href="/tags/%E5%89%8D%E7%AB%AF" title="前端">前端</a><a class="tag-list" href="/tags/%E5%90%8E%E7%AB%AF" title="后端">后端</a><a class="tag-list" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93" title="数据库">数据库</a></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/#/my/m/music/playlist?id=7784481513&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("11/22/2025 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Mr.Chen 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("11/22/2025 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo-ruddy-six.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-ruddy-six.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo-ruddy-six.vercel.app/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "johnnyemail@2925.com";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>